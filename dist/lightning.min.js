!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.PIXI=t()}}(function(){var t;return function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return o(i?i:t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){"use strict";"use restrict";function n(t){var e=32;return t&=-t,t&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}var o=32;i.INT_BITS=o,i.INT_MAX=2147483647,i.INT_MIN=-1<<o-1,i.sign=function(t){return(t>0)-(t<0)},i.abs=function(t){var e=t>>o-1;return(t^e)-e},i.min=function(t,e){return e^(t^e)&-(t<e)},i.max=function(t,e){return t^(t^e)&-(t<e)},i.isPow2=function(t){return!(t&t-1||!t)},i.log2=function(t){var e,i;return e=(t>65535)<<4,t>>>=e,i=(t>255)<<3,t>>>=i,e|=i,i=(t>15)<<2,t>>>=i,e|=i,i=(t>3)<<1,t>>>=i,e|=i,e|t>>1},i.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},i.popCount=function(t){return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24},i.countTrailingZeros=n,i.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t+1},i.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t-(t>>>1)},i.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,t&=15,27030>>>t&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var i=e,n=e,o=7;for(i>>>=1;i;i>>>=1)n<<=1,n|=1&i,--o;t[e]=n<<o&255}}(r),i.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},i.interleave2=function(t,e){return t&=65535,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e&=65535,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1},i.deinterleave2=function(t,e){return t=t>>>e&1431655765,t=858993459&(t|t>>>1),t=252645135&(t|t>>>2),t=16711935&(t|t>>>4),t=65535&(t|t>>>16),t<<16>>16},i.interleave3=function(t,e,i){return t&=1023,t=4278190335&(t|t<<16),t=251719695&(t|t<<8),t=3272356035&(t|t<<4),t=1227133513&(t|t<<2),e&=1023,e=4278190335&(e|e<<16),e=251719695&(e|e<<8),e=3272356035&(e|e<<4),e=1227133513&(e|e<<2),t|=e<<1,i&=1023,i=4278190335&(i|i<<16),i=251719695&(i|i<<8),i=3272356035&(i|i<<4),i=1227133513&(i|i<<2),t|i<<2},i.deinterleave3=function(t,e){return t=t>>>e&1227133513,t=3272356035&(t|t>>>2),t=251719695&(t|t>>>4),t=4278190335&(t|t>>>8),t=1023&(t|t>>>16),t<<22>>22},i.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},{}],2:[function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n=e&&e.length,r=n?e[0]*i:t.length,a=o(t,0,r,i,!0),l=[];if(!a)return l;var u,h,p,d,f,m,_;if(n&&(a=c(t,e,a,i)),t.length>80*i){u=p=t[0],h=d=t[1];for(var y=i;y<r;y+=i)f=t[y],m=t[y+1],f<u&&(u=f),m<h&&(h=m),f>p&&(p=f),m>d&&(d=m);_=Math.max(p-u,d-h)}return s(a,l,i,u,h,_),l}function o(t,e,i,n,o){var r,s;if(o===P(t,e,i,n)>0)for(r=e;r<i;r+=n)s=B(r,t[r],t[r+1],s);else for(r=i-n;r>=e;r-=n)s=B(r,t[r],t[r+1],s);return s&&w(s,s.next)&&(M(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do if(i=!1,n.steiner||!w(n,n.next)&&0!==b(n.prev,n,n.next))n=n.next;else{if(M(n),n=e=n.prev,n===n.next)return null;i=!0}while(i||n!==e);return e}function s(t,e,i,n,o,c,p){if(t){!p&&c&&m(t,n,o,c);for(var d,f,_=t;t.prev!==t.next;)if(d=t.prev,f=t.next,c?l(t,n,o,c):a(t))e.push(d.i/i),e.push(t.i/i),e.push(f.i/i),M(t),t=f.next,_=f.next;else if(t=f,t===_){p?1===p?(t=u(t,e,i),s(t,e,i,n,o,c,2)):2===p&&h(t,e,i,n,o,c):s(r(t),e,i,n,o,c,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(b(e,i,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(v(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&b(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(t,e,i,n){var o=t.prev,r=t,s=t.next;if(b(o,r,s)>=0)return!1;for(var a=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,l=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,u=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,h=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,c=y(a,l,e,i,n),p=y(u,h,e,i,n),d=t.nextZ;d&&d.z<=p;){if(d!==t.prev&&d!==t.next&&v(o.x,o.y,r.x,r.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&v(o.x,o.y,r.x,r.y,s.x,s.y,d.x,d.y)&&b(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function u(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!w(o,r)&&S(o,n,n.next,r)&&D(o,r)&&D(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),M(n),M(n.next),n=t=r),n=n.next}while(n!==t);return n}function h(t,e,i,n,o,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var h=A(l,u);return l=r(l,l.next),h=r(h,h.next),s(l,e,i,n,o,a),void s(h,e,i,n,o,a)}u=u.next}l=l.next}while(l!==t)}function c(t,e,i,n){var s,a,l,u,h,c=[];for(s=0,a=e.length;s<a;s++)l=e[s]*n,u=s<a-1?e[s+1]*n:t.length,h=o(t,l,u,n,!1),h===h.next&&(h.steiner=!0),c.push(x(h));for(c.sort(p),s=0;s<c.length;s++)d(c[s],i),i=r(i,i.next);return i}function p(t,e){return t.x-e.x}function d(t,e){if(e=f(t,e)){var i=A(e,t);r(i,i.next)}}function f(t,e){var i,n=e,o=t.x,r=t.y,s=-(1/0);do{if(r<=n.y&&r>=n.next.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&a>s){if(s=a,a===o){if(r===n.y)return n;if(r===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===s)return i.prev;var l,u=i,h=i.x,c=i.y,p=1/0;for(n=i.next;n!==u;)o>=n.x&&n.x>=h&&v(r<c?o:s,r,h,c,r<c?s:o,r,n.x,n.y)&&(l=Math.abs(r-n.y)/(o-n.x),(l<p||l===p&&n.x>i.x)&&D(n,t)&&(i=n,p=l)),n=n.next;return i}function m(t,e,i,n){var o=t;do null===o.z&&(o.z=y(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,_(o)}function _(t){var e,i,n,o,r,s,a,l,u=1;do{for(i=t,t=null,r=null,s=0;i;){for(s++,n=i,a=0,e=0;e<u&&(a++,n=n.nextZ,n);e++);for(l=u;a>0||l>0&&n;)0===a?(o=n,n=n.nextZ,l--):0!==l&&n?i.z<=n.z?(o=i,i=i.nextZ,a--):(o=n,n=n.nextZ,l--):(o=i,i=i.nextZ,a--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;i=n}r.nextZ=null,u*=2}while(s>1);return t}function y(t,e,i,n,o){return t=32767*(t-i)/o,e=32767*(e-n)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function x(t){var e=t,i=t;do e.x<i.x&&(i=e),e=e.next;while(e!==t);return i}function v(t,e,i,n,o,r,s,a){return(o-s)*(e-a)-(t-s)*(r-a)>=0&&(t-s)*(n-a)-(i-s)*(e-a)>=0&&(i-s)*(r-a)-(o-s)*(n-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!C(t,e)&&D(t,e)&&D(e,t)&&T(t,e)}function b(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,i,n){return!!(w(t,e)&&w(i,n)||w(t,n)&&w(i,e))||b(t,e,i)>0!=b(t,e,n)>0&&b(i,n,t)>0!=b(i,n,e)>0}function C(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&S(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function D(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function T(t,e){var i=t,n=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do i.y>r!=i.next.y>r&&o<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==t);return n}function A(t,e){var i=new E(t.i,t.x,t.y),n=new E(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function B(t,e,i,n){var o=new E(t,e,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,i,n){for(var o=0,r=e,s=i-n;r<i;r+=n)o+=(t[s]-t[r])*(t[r+1]+t[s+1]),s=r;return o}e.exports=n,n.deviation=function(t,e,i,n){var o=e&&e.length,r=o?e[0]*i:t.length,s=Math.abs(P(t,0,r,i));if(o)for(var a=0,l=e.length;a<l;a++){var u=e[a]*i,h=a<l-1?e[a+1]*i:t.length;s-=Math.abs(P(t,u,h,i))}var c=0;for(a=0;a<n.length;a+=3){var p=n[a]*i,d=n[a+1]*i,f=n[a+2]*i;c+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var s=0;s<e;s++)i.vertices.push(t[o][r][s]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i}},{}],3:[function(t,e,i){"use strict";function n(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function r(){this._events=new n,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(a=!1)),r.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)s.call(t,e)&&i.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},r.prototype.listeners=function(t,e){var i=a?a+t:t,n=this._events[i];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var o=0,r=n.length,s=new Array(r);o<r;o++)s[o]=n[o].fn;return s},r.prototype.emit=function(t,e,i,n,o,r){var s=a?a+t:t;if(!this._events[s])return!1;var l,u,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,n),!0;case 5:return h.fn.call(h.context,e,i,n,o),!0;case 6:return h.fn.call(h.context,e,i,n,o,r),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var p,d=h.length;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),c){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,i);break;case 4:h[u].fn.call(h[u].context,e,i,n);break;default:if(!l)for(p=1,l=new Array(c-1);p<c;p++)l[p-1]=arguments[p];h[u].fn.apply(h[u].context,l)}}return!0},r.prototype.on=function(t,e,i){var n=new o(e,i||this),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],n]:this._events[r].push(n):(this._events[r]=n,this._eventsCount++),this},r.prototype.once=function(t,e,i){var n=new o(e,i||this,!0),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],n]:this._events[r].push(n):(this._events[r]=n,this._eventsCount++),this},r.prototype.removeListener=function(t,e,i,o){var r=a?a+t:t;if(!this._events[r])return this;if(!e)return 0===--this._eventsCount?this._events=new n:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==e||o&&!s.once||i&&s.context!==i||(0===--this._eventsCount?this._events=new n:delete this._events[r]);else{for(var l=0,u=[],h=s.length;l<h;l++)(s[l].fn!==e||o&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[r]=1===u.length?u[0]:u:0===--this._eventsCount?this._events=new n:delete this._events[r]}return this},r.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&(0===--this._eventsCount?this._events=new n:delete this._events[e])):(this._events=new n,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=a,r.EventEmitter=r,"undefined"!=typeof e&&(e.exports=r)},{}],4:[function(e,i,n){!function(e){var n=/iPhone/i,o=/iPod/i,r=/iPad/i,s=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,a=/Android/i,l=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,u=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,h=/IEMobile/i,c=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,d=/BB10/i,f=/Opera Mini/i,m=/(CriOS|Chrome)(?=.*\bMobile\b)/i,_=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,y=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),x=function(t,e){return t.test(e)},v=function(t){var e=t||navigator.userAgent,i=e.split("[FBAN");if("undefined"!=typeof i[1]&&(e=i[0]),i=e.split("Twitter"),"undefined"!=typeof i[1]&&(e=i[0]),this.apple={phone:x(n,e),ipod:x(o,e),tablet:!x(n,e)&&x(r,e),device:x(n,e)||x(o,e)||x(r,e)},this.amazon={phone:x(l,e),tablet:!x(l,e)&&x(u,e),device:x(l,e)||x(u,e)},this.android={phone:x(l,e)||x(s,e),tablet:!x(l,e)&&!x(s,e)&&(x(u,e)||x(a,e)),device:x(l,e)||x(u,e)||x(s,e)||x(a,e)},this.windows={phone:x(h,e),tablet:x(c,e),device:x(h,e)||x(c,e)},this.other={blackberry:x(p,e),blackberry10:x(d,e),opera:x(f,e),firefox:x(_,e),chrome:x(m,e),device:x(p,e)||x(d,e)||x(f,e)||x(_,e)||x(m,e)},this.seven_inch=x(y,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},g=function(){var t=new v;return t.Class=v,t};"undefined"!=typeof i&&i.exports&&"undefined"==typeof window?i.exports=v:"undefined"!=typeof i&&i.exports&&"undefined"!=typeof window?i.exports=g():"function"==typeof t&&t.amd?t("isMobile",[],e.isMobile=g()):e.isMobile=g()}(this)},{}],5:[function(t,e,i){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function o(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==n.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}var r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=o()?Object.assign:function(t,e){for(var i,o,l=n(t),u=1;u<arguments.length;u++){i=Object(arguments[u]);for(var h in i)s.call(i,h)&&(l[h]=i[h]);if(r){o=r(i);for(var c=0;c<o.length;c++)a.call(i,o[c])&&(l[o[c]]=i[o[c]])}}return l}},{}],6:[function(t,e,i){var n=new ArrayBuffer(0),o=function(t,e,i,o){this.gl=t,this.buffer=t.createBuffer(),this.type=e||t.ARRAY_BUFFER,this.drawType=o||t.STATIC_DRAW,this.data=n,i&&this.upload(i),this._updateID=0};o.prototype.upload=function(t,e,i){i||this.bind();var n=this.gl;t=t||this.data,e=e||0,this.data.byteLength>=t.byteLength?n.bufferSubData(this.type,e,t):n.bufferData(this.type,t,this.drawType),this.data=t},o.prototype.bind=function(){var t=this.gl;t.bindBuffer(this.type,this.buffer)},o.createVertexBuffer=function(t,e,i){return new o(t,t.ARRAY_BUFFER,e,i)},o.createIndexBuffer=function(t,e,i){return new o(t,t.ELEMENT_ARRAY_BUFFER,e,i)},o.create=function(t,e,i,n){return new o(t,e,i,n)},o.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)},e.exports=o},{}],7:[function(t,e,i){var n=t("./GLTexture"),o=function(t,e,i){this.gl=t,this.framebuffer=t.createFramebuffer(),this.stencil=null,this.texture=null,this.width=e||100,this.height=i||100};o.prototype.enableTexture=function(t){var e=this.gl;this.texture=t||new n(e),this.texture.bind(),this.bind(),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture.texture,0)},o.prototype.enableStencil=function(){if(!this.stencil){var t=this.gl;this.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencil),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height)}},o.prototype.clear=function(t,e,i,n){this.bind();var o=this.gl;o.clearColor(t,e,i,n),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)},o.prototype.bind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer)},o.prototype.unbind=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)},o.prototype.resize=function(t,e){var i=this.gl;this.width=t,this.height=e,this.texture&&this.texture.uploadData(null,t,e),this.stencil&&(i.bindRenderbuffer(i.RENDERBUFFER,this.stencil),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e))},o.prototype.destroy=function(){var t=this.gl;this.texture&&this.texture.destroy(),t.deleteFramebuffer(this.framebuffer),this.gl=null,this.stencil=null,this.texture=null},o.createRGBA=function(t,e,i,r){var s=n.fromData(t,null,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new o(t,e,i);return a.enableTexture(s),a.unbind(),a},o.createFloat32=function(t,e,i,r){var s=new n.fromData(t,r,e,i);s.enableNearestScaling(),s.enableWrapClamp();var a=new o(t,e,i);return a.enableTexture(s),a.unbind(),a},e.exports=o},{"./GLTexture":9}],8:[function(t,e,i){var n=t("./shader/compileProgram"),o=t("./shader/extractAttributes"),r=t("./shader/extractUniforms"),s=t("./shader/setPrecision"),a=t("./shader/generateUniformAccessObject"),l=function(t,e,i,l,u){this.gl=t,l&&(e=s(e,l),i=s(i,l)),this.program=n(t,e,i,u),this.attributes=o(t,this.program),this.uniformData=r(t,this.program),this.uniforms=a(t,this.uniformData)};l.prototype.bind=function(){this.gl.useProgram(this.program)},l.prototype.destroy=function(){this.attributes=null,this.uniformData=null,this.uniforms=null;var t=this.gl;t.deleteProgram(this.program)},e.exports=l},{"./shader/compileProgram":14,"./shader/extractAttributes":16,"./shader/extractUniforms":17,"./shader/generateUniformAccessObject":18,"./shader/setPrecision":22}],9:[function(t,e,i){var n=function(t,e,i,n,o){this.gl=t,this.texture=t.createTexture(),this.mipmap=!1,this.premultiplyAlpha=!1,this.width=e||-1,this.height=i||-1,this.format=n||t.RGBA,this.type=o||t.UNSIGNED_BYTE};n.prototype.upload=function(t){this.bind();var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha);var i=t.videoWidth||t.width,n=t.videoHeight||t.height;n!==this.height||i!==this.width?e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,t):e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.format,this.type,t),this.width=i,this.height=n};var o=!1;n.prototype.uploadData=function(t,e,i){this.bind();var n=this.gl;if(t instanceof Float32Array){if(!o){var r=n.getExtension("OES_texture_float");if(!r)throw new Error("floating point textures not available");o=!0}this.type=n.FLOAT}else this.type=this.type||n.UNSIGNED_BYTE;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),e!==this.width||i!==this.height?n.texImage2D(n.TEXTURE_2D,0,this.format,e,i,0,this.format,this.type,t||null):n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,i,this.format,this.type,t||null),this.width=e,this.height=i},n.prototype.bind=function(t){var e=this.gl;void 0!==t&&e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)},n.prototype.unbind=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,null)},n.prototype.minFilter=function(t){var e=this.gl;this.bind(),this.mipmap?e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.magFilter=function(t){var e=this.gl;this.bind(),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t?e.LINEAR:e.NEAREST)},n.prototype.enableMipmap=function(){var t=this.gl;this.bind(),this.mipmap=!0,t.generateMipmap(t.TEXTURE_2D)},n.prototype.enableLinearScaling=function(){this.minFilter(!0),this.magFilter(!0)},n.prototype.enableNearestScaling=function(){this.minFilter(!1),this.magFilter(!1)},n.prototype.enableWrapClamp=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)},n.prototype.enableWrapRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)},n.prototype.enableWrapMirrorRepeat=function(){var t=this.gl;this.bind(),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.MIRRORED_REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.MIRRORED_REPEAT)},n.prototype.destroy=function(){var t=this.gl;t.deleteTexture(this.texture)},n.fromSource=function(t,e,i){var o=new n(t);return o.premultiplyAlpha=i||!1,o.upload(e),o},n.fromData=function(t,e,i,o){var r=new n(t);return r.uploadData(e,i,o),r},e.exports=n},{}],10:[function(t,e,i){function n(t,e){if(this.nativeVaoExtension=null,n.FORCE_NATIVE||(this.nativeVaoExtension=t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object")),this.nativeState=e,this.nativeVaoExtension){this.nativeVao=this.nativeVaoExtension.createVertexArrayOES();var i=t.getParameter(t.MAX_VERTEX_ATTRIBS);this.nativeState={tempAttribState:new Array(i),attribState:new Array(i)}}this.gl=t,this.attributes=[],this.indexBuffer=null,this.dirty=!1}var o=t("./setVertexAttribArrays");n.prototype.constructor=n,e.exports=n,n.FORCE_NATIVE=!1,n.prototype.bind=function(){return this.nativeVao?(this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.dirty&&(this.dirty=!1,this.activate())):this.activate(),this},n.prototype.unbind=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(null),this},n.prototype.activate=function(){for(var t=this.gl,e=null,i=0;i<this.attributes.length;i++){var n=this.attributes[i];e!==n.buffer&&(n.buffer.bind(),e=n.buffer),t.vertexAttribPointer(n.attribute.location,n.attribute.size,n.type||t.FLOAT,n.normalized||!1,n.stride||0,n.start||0)}return o(t,this.attributes,this.nativeState),this.indexBuffer&&this.indexBuffer.bind(),this},n.prototype.addAttribute=function(t,e,i,n,o,r){return this.attributes.push({buffer:t,attribute:e,location:e.location,type:i||this.gl.FLOAT,normalized:n||!1,stride:o||0,start:r||0}),this.dirty=!0,this},n.prototype.addIndex=function(t){return this.indexBuffer=t,this.dirty=!0,this},n.prototype.clear=function(){return this.nativeVao&&this.nativeVaoExtension.bindVertexArrayOES(this.nativeVao),this.attributes.length=0,this.indexBuffer=null,this},n.prototype.draw=function(t,e,i){var n=this.gl;return this.indexBuffer?n.drawElements(t,e||this.indexBuffer.data.length,n.UNSIGNED_SHORT,2*(i||0)):n.drawArrays(t,i,e||this.getSize()),this},n.prototype.destroy=function(){this.gl=null,this.indexBuffer=null,this.attributes=null,this.nativeState=null,this.nativeVao&&this.nativeVaoExtension.deleteVertexArrayOES(this.nativeVao),this.nativeVaoExtension=null,this.nativeVao=null},n.prototype.getSize=function(){var t=this.attributes[0];return t.buffer.data.length/(t.stride/4||t.attribute.size)}},{"./setVertexAttribArrays":13}],11:[function(t,e,i){var n=function(t,e){var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("This browser does not support webGL. Try using the canvas renderer");return i};e.exports=n},{}],12:[function(t,e,i){var n={createContext:t("./createContext"),setVertexAttribArrays:t("./setVertexAttribArrays"),GLBuffer:t("./GLBuffer"),GLFramebuffer:t("./GLFramebuffer"),GLShader:t("./GLShader"),GLTexture:t("./GLTexture"),VertexArrayObject:t("./VertexArrayObject"),shader:t("./shader")};"undefined"!=typeof e&&e.exports&&(e.exports=n),"undefined"!=typeof window&&(window.PIXI=window.PIXI||{},window.PIXI.glCore=n)},{"./GLBuffer":6,"./GLFramebuffer":7,"./GLShader":8,"./GLTexture":9,"./VertexArrayObject":10,"./createContext":11,"./setVertexAttribArrays":13,"./shader":19}],13:[function(t,e,i){var n=function(t,e,i){var n;if(i){var o=i.tempAttribState,r=i.attribState;for(n=0;n<o.length;n++)o[n]=!1;for(n=0;n<e.length;n++)o[e[n].attribute.location]=!0;for(n=0;n<r.length;n++)r[n]!==o[n]&&(r[n]=o[n],i.attribState[n]?t.enableVertexAttribArray(n):t.disableVertexAttribArray(n))}else for(n=0;n<e.length;n++){var s=e[n];t.enableVertexAttribArray(s.attribute.location)}};e.exports=n},{}],14:[function(t,e,i){var n=function(t,e,i,n){var r=o(t,t.VERTEX_SHADER,e),s=o(t,t.FRAGMENT_SHADER,i),a=t.createProgram();if(t.attachShader(a,r),t.attachShader(a,s),n)for(var l in n)t.bindAttribLocation(a,n[l],l);return t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(a,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(a)),t.deleteProgram(a),a=null),t.deleteShader(r),t.deleteShader(s),a},o=function(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.log(t.getShaderInfoLog(n)),null)};e.exports=n},{}],15:[function(t,e,i){var n=function(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return o(2*e);case"bvec3":return o(3*e);case"bvec4":return o(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},o=function(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e};e.exports=n},{}],16:[function(t,e,i){var n=t("./mapType"),o=t("./mapSize"),r=function(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),a=0;a<r;a++){var l=t.getActiveAttrib(e,a),u=n(t,l.type);i[l.name]={type:u,size:o(u),location:t.getAttribLocation(e,l.name),pointer:s}}return i},s=function(t,e,i,n){gl.vertexAttribPointer(this.location,this.size,t||gl.FLOAT,e||!1,i||0,n||0)};e.exports=r},{"./mapSize":20,"./mapType":21}],17:[function(t,e,i){var n=t("./mapType"),o=t("./defaultValue"),r=function(t,e){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<r;s++){var a=t.getActiveUniform(e,s),l=a.name.replace(/\[.*?\]/,""),u=n(t,a.type);i[l]={type:u,size:a.size,location:t.getUniformLocation(e,l),value:o(u,a.size)}}return i};e.exports=r},{"./defaultValue":15,"./mapType":21}],18:[function(t,e,i){var n=function(t,e){var i={data:{}};i.gl=t;for(var n=Object.keys(e),a=0;a<n.length;a++){var l=n[a],u=l.split("."),h=u[u.length-1],c=s(u,i),p=e[l];c.data[h]=p,c.gl=t,Object.defineProperty(c,h,{get:o(h),set:r(h,p)})}return i},o=function(t){var e=a.replace("%%",t);return new Function(e)},r=function(t,e){var i,n=l.replace(/%%/g,t);return i=1===e.size?u[e.type]:h[e.type],i&&(n+="\nthis.gl."+i+";"),new Function("value",n)},s=function(t,e){for(var i=e,n=0;n<t.length-1;n++){var o=i[t[n]]||{data:{}};i[t[n]]=o,i=o}return i},a=["return this.data.%%.value;"].join("\n"),l=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),u={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},h={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"};e.exports=n},{}],19:[function(t,e,i){e.exports={compileProgram:t("./compileProgram"),defaultValue:t("./defaultValue"),extractAttributes:t("./extractAttributes"),extractUniforms:t("./extractUniforms"),generateUniformAccessObject:t("./generateUniformAccessObject"),setPrecision:t("./setPrecision"),mapSize:t("./mapSize"),mapType:t("./mapType")}},{"./compileProgram":14,"./defaultValue":15,"./extractAttributes":16,"./extractUniforms":17,"./generateUniformAccessObject":18,"./mapSize":20,"./mapType":21,"./setPrecision":22}],20:[function(t,e,i){var n=function(t){return o[t]},o={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};e.exports=n},{}],21:[function(t,e,i){var n=function(t,e){if(!o){var i=Object.keys(r);o={};for(var n=0;n<i.length;++n){var s=i[n];o[t[s]]=r[s]}}return o[e]},o=null,r={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"};e.exports=n},{}],22:[function(t,e,i){var n=function(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;\n"+t:t};e.exports=n},{}],23:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var o=t[n];"."===o?t.splice(n,1):".."===o?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,r=function(t){return o.exec(t).slice(1)};i.resolve=function(){for(var i="",o=!1,r=arguments.length-1;r>=-1&&!o;r--){var s=r>=0?arguments[r]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(i=s+"/"+i,o="/"===s.charAt(0))}return i=e(n(i.split("/"),function(t){return!!t}),!o).join("/"),(o?"/":"")+i||"."},i.normalize=function(t){var o=i.isAbsolute(t),r="/"===s(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!o).join("/"),t||o||(t="."),t&&r&&(t+="/"),(o?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var o=n(t.split("/")),r=n(e.split("/")),s=Math.min(o.length,r.length),a=s,l=0;l<s;l++)if(o[l]!==r[l]){a=l;break}for(var u=[],l=a;l<o.length;l++)u.push("..");return u=u.concat(r.slice(a)),u.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=r(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=r(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return r(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return e<0&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:24}],24:[function(t,e,i){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,
setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function s(t){if(p===clearTimeout)return clearTimeout(t);if((p===o||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function a(){_&&f&&(_=!1,f.length?m=f.concat(m):y=-1,m.length&&l())}function l(){if(!_){var t=r(a);_=!0;for(var e=m.length;e;){for(f=m,m=[];++y<e;)f&&f[y].run();y=-1,e=m.length}f=null,_=!1,s(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var c,p,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{p="function"==typeof clearTimeout?clearTimeout:o}catch(t){p=o}}();var f,m=[],_=!1,y=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];m.push(new u(t,e)),1!==m.length||_||r(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],25:[function(e,i,n){(function(e){!function(o){function r(t){throw new RangeError(R[t])}function s(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function a(t,e){var i=t.split("@"),n="";i.length>1&&(n=i[0]+"@",t=i[1]),t=t.replace(O,".");var o=t.split("."),r=s(o,e).join(".");return n+r}function l(t){for(var e,i,n=[],o=0,r=t.length;o<r;)e=t.charCodeAt(o++),e>=55296&&e<=56319&&o<r?(i=t.charCodeAt(o++),56320==(64512&i)?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),o--)):n.push(e);return n}function u(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=V(t>>>10&1023|55296),t=56320|1023&t),e+=V(t)}).join("")}function h(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:S}function c(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function p(t,e,i){var n=0;for(t=i?F(t/A):t>>1,t+=F(t/e);t>L*D>>1;n+=S)t=F(t/L);return F(n+(L+1)*t/(t+T))}function d(t){var e,i,n,o,s,a,l,c,d,f,m=[],_=t.length,y=0,x=M,v=B;for(i=t.lastIndexOf(E),i<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&r("not-basic"),m.push(t.charCodeAt(n));for(o=i>0?i+1:0;o<_;){for(s=y,a=1,l=S;o>=_&&r("invalid-input"),c=h(t.charCodeAt(o++)),(c>=S||c>F((w-y)/a))&&r("overflow"),y+=c*a,d=l<=v?C:l>=v+D?D:l-v,!(c<d);l+=S)f=S-d,a>F(w/f)&&r("overflow"),a*=f;e=m.length+1,v=p(y-s,e,0==s),F(y/e)>w-x&&r("overflow"),x+=F(y/e),y%=e,m.splice(y++,0,x)}return u(m)}function f(t){var e,i,n,o,s,a,u,h,d,f,m,_,y,x,v,g=[];for(t=l(t),_=t.length,e=M,i=0,s=B,a=0;a<_;++a)m=t[a],m<128&&g.push(V(m));for(n=o=g.length,o&&g.push(E);n<_;){for(u=w,a=0;a<_;++a)m=t[a],m>=e&&m<u&&(u=m);for(y=n+1,u-e>F((w-i)/y)&&r("overflow"),i+=(u-e)*y,e=u,a=0;a<_;++a)if(m=t[a],m<e&&++i>w&&r("overflow"),m==e){for(h=i,d=S;f=d<=s?C:d>=s+D?D:d-s,!(h<f);d+=S)v=h-f,x=S-f,g.push(V(c(f+v%x,0))),h=F(v/x);g.push(V(c(h,0))),s=p(i,y,n==o),i=0,++n}++i,++e}return g.join("")}function m(t){return a(t,function(t){return P.test(t)?d(t.slice(4).toLowerCase()):t})}function _(t){return a(t,function(t){return I.test(t)?"xn--"+f(t):t})}var y="object"==typeof n&&n&&!n.nodeType&&n,x="object"==typeof i&&i&&!i.nodeType&&i,v="object"==typeof e&&e;v.global!==v&&v.window!==v&&v.self!==v||(o=v);var g,b,w=2147483647,S=36,C=1,D=26,T=38,A=700,B=72,M=128,E="-",P=/^xn--/,I=/[^\x20-\x7E]/,O=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=S-C,F=Math.floor,V=String.fromCharCode;if(g={version:"1.4.1",ucs2:{decode:l,encode:u},decode:d,encode:f,toASCII:_,toUnicode:m},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return g});else if(y&&x)if(i.exports==y)x.exports=g;else for(b in g)g.hasOwnProperty(b)&&(y[b]=g[b]);else o.punycode=g}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,r){e=e||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var u=t.length;l>0&&u>l&&(u=l);for(var h=0;h<u;++h){var c,p,d,f,m=t[h].replace(a,"%20"),_=m.indexOf(i);_>=0?(c=m.substr(0,_),p=m.substr(_+1)):(c=m,p=""),d=decodeURIComponent(c),f=decodeURIComponent(p),n(s,d)?o(s[d])?s[d].push(f):s[d]=[s[d],f]:s[d]=f}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],27:[function(t,e,i){"use strict";function n(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?n(s(t),function(s){var a=encodeURIComponent(o(s))+i;return r(t[s])?n(t[s],function(t){return a+encodeURIComponent(o(t))}).join(e):a+encodeURIComponent(o(t[s]))}).join(e):a?encodeURIComponent(o(a))+i+encodeURIComponent(o(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],28:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":26,"./encode":27}],29:[function(t,e,i){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,i){if(t&&u.isObject(t)&&t instanceof n)return t;var o=new n;return o.parse(t,e,i),o}function r(t){return u.isString(t)&&(t=o(t)),t instanceof n?t.format():n.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}var l=t("punycode"),u=t("./util");i.parse=o,i.resolve=s,i.resolveObject=a,i.format=r,i.Url=n;var h=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,d=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(d),m=["'"].concat(f),_=["%","/","?",";","#"].concat(m),y=["/","?","#"],x=255,v=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=t("querystring");n.prototype.parse=function(t,e,i){if(!u.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),o=n!==-1&&n<t.indexOf("#")?"?":"#",r=t.split(o),s=/\\/g;r[0]=r[0].replace(s,"/"),t=r.join(o);var a=t;if(a=a.trim(),!i&&1===t.split("#").length){var c=p.exec(a);if(c)return this.path=a,this.href=a,this.pathname=c[1],c[2]?(this.search=c[2],e?this.query=C.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var d=h.exec(a);if(d){d=d[0];var f=d.toLowerCase();this.protocol=f,a=a.substr(d.length)}if(i||d||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var D="//"===a.substr(0,2);!D||d&&w[d]||(a=a.substr(2),this.slashes=!0)}if(!w[d]&&(D||d&&!S[d])){for(var T=-1,A=0;A<y.length;A++){var B=a.indexOf(y[A]);B!==-1&&(T===-1||B<T)&&(T=B)}var M,E;E=T===-1?a.lastIndexOf("@"):a.lastIndexOf("@",T),E!==-1&&(M=a.slice(0,E),a=a.slice(E+1),this.auth=decodeURIComponent(M)),T=-1;for(var A=0;A<_.length;A++){var B=a.indexOf(_[A]);B!==-1&&(T===-1||B<T)&&(T=B)}T===-1&&(T=a.length),this.host=a.slice(0,T),a=a.slice(T),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var I=this.hostname.split(/\./),A=0,O=I.length;A<O;A++){var R=I[A];if(R&&!R.match(v)){for(var L="",F=0,V=R.length;F<V;F++)L+=R.charCodeAt(F)>127?"x":R[F];if(!L.match(v)){var k=I.slice(0,A),G=I.slice(A+1),N=R.match(g);N&&(k.push(N[1]),G.unshift(N[2])),G.length&&(a="/"+G.join(".")+a),this.hostname=k.join(".");break}}}this.hostname.length>x?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=l.toASCII(this.hostname));var j=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+j,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!b[f])for(var A=0,O=m.length;A<O;A++){var X=m[A];if(a.indexOf(X)!==-1){var J=encodeURIComponent(X);J===X&&(J=escape(X)),a=a.split(X).join(J)}}var W=a.indexOf("#");W!==-1&&(this.hash=a.substr(W),a=a.slice(0,W));var z=a.indexOf("?");if(z!==-1?(this.search=a.substr(z),this.query=a.substr(z+1),e&&(this.query=C.parse(this.query)),a=a.slice(0,z)):e&&(this.search="",this.query={}),a&&(this.pathname=a),S[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var j=this.pathname||"",H=this.search||"";this.path=j+H}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",o=!1,r="";this.host?o=t+this.host:this.hostname&&(o=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(r=C.stringify(this.query));var s=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||S[e])&&o!==!1?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+i+s+n},n.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(u.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var i=new n,o=Object.keys(this),r=0;r<o.length;r++){var s=o[r];i[s]=this[s]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),l=0;l<a.length;l++){var h=a[l];"protocol"!==h&&(i[h]=t[h])}return S[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!S[t.protocol]){for(var c=Object.keys(t),p=0;p<c.length;p++){var d=c[p];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||w[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",_=i.search||"";i.path=m+_}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var y=i.pathname&&"/"===i.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=x||y||i.host&&t.pathname,g=v,b=i.pathname&&i.pathname.split("/")||[],f=t.pathname&&t.pathname.split("/")||[],C=i.protocol&&!S[i.protocol];if(C&&(i.hostname="",i.port=null,i.host&&(""===b[0]?b[0]=i.host:b.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),v=v&&(""===f[0]||""===b[0])),x)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),i.search=t.search,i.query=t.query;else if(!u.isNullOrUndefined(t.search)){if(C){i.hostname=i.host=b.shift();var D=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");D&&(i.auth=D.shift(),i.host=i.hostname=D.shift())}return i.search=t.search,i.query=t.query,u.isNull(i.pathname)&&u.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!b.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=b.slice(-1)[0],A=(i.host||t.host||b.length>1)&&("."===T||".."===T)||""===T,B=0,M=b.length;M>=0;M--)T=b[M],"."===T?b.splice(M,1):".."===T?(b.splice(M,1),B++):B&&(b.splice(M,1),B--);if(!v&&!g)for(;B--;B)b.unshift("..");!v||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),A&&"/"!==b.join("/").substr(-1)&&b.push("");var E=""===b[0]||b[0]&&"/"===b[0].charAt(0);if(C){i.hostname=i.host=E?"":b.length?b.shift():"";var D=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");D&&(i.auth=D.shift(),i.host=i.hostname=D.shift())}return v=v||i.host&&b.length,v&&!E&&b.unshift(""),b.length?i.pathname=b.join("/"):(i.pathname=null,i.path=null),u.isNull(i.pathname)&&u.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var t=this.host,e=c.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":30,punycode:25,querystring:28}],30:[function(t,e,i){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],31:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=t("mini-signals"),l=o(a),u=t("parse-uri"),h=o(u),c=t("./async"),p=n(c),d=t("./Resource"),f=o(d),m=100,_=/(#[\w-]+)?$/,y=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;r(this,t),this.baseUrl=i,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,i){return e._loadResource(t,i)},this._queue=p.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new l.default,this.onError=new l.default,this.onLoad=new l.default,this.onStart=new l.default,this.onComplete=new l.default}return t.prototype.add=function(t,e,i,n){if(Array.isArray(t)){for(var o=0;o<t.length;++o)this.add(t[o]);return this}if("object"===("undefined"==typeof t?"undefined":s(t))&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new f.default(t,e,i),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var r=i.parentResource,a=[],l=0;l<r.children.length;++l)r.children[l].isComplete||a.push(r.children[l]);var u=r.progressChunk*(a.length+1),h=u/(a.length+2);r.children.push(this.resources[t]),r.progressChunk=h;for(var c=0;c<a.length;++c)a[c].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;return this.loading=!0,this.onStart.dispatch(this),this._queue.resume(),this},t.prototype._prepareUrl=function(t){var e=(0,h.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var n=_.exec(i)[0];i=i.substr(0,i.length-n.length),i+=i.indexOf("?")!==-1?"&"+this.defaultQueryString:"?"+this.defaultQueryString,i+=n}return i},t.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,p.eachSeries(this._beforeMiddleware,function(e,n){e.call(i,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())})},t.prototype._onComplete=function(){this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,t._dequeue(),this._resourcesParsing.push(t),p.eachSeries(this._afterMiddleware,function(i,n){i.call(e,t,n)},function(){t.onAfterMiddleware.dispatch(t),e.progress+=t.progressChunk,e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&(e.progress=m,e._onComplete())})},t}();i.default=y},{"./Resource":32,"./async":33,"mini-signals":37,"parse-uri":38}],32:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(){}function s(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function a(t){return t.toString().replace("object ","")}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("parse-uri"),h=n(u),c=t("mini-signals"),p=n(c),d=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),f=null,m=0,_=200,y=204,x=1223,v=2,g=function(){function t(e,i,n){if(o(this,t),"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=n.crossOrigin===!0?"anonymous":n.crossOrigin,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=r,this._onLoadBinding=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this),this.onStart=new p.default,this.onProgress=new p.default,this.onComplete=new p.default,this.onAfterMiddleware=new p.default}return t.setExtensionLoadType=function(e,i){s(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){s(t._xhrTypeMap,e,i)},t.prototype.complete=function(){if(this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this.complete()}},t.prototype.load=function(e){var i=this;if(!this.isLoading){if(this.isComplete)return void(e&&setTimeout(function(){return e(i)},1));switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),this.crossOrigin!==!1&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:d&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},t.prototype._hasFlag=function(t){return!!(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&"undefined"!=typeof window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&"undefined"!=typeof window.Audio?this.data=new Audio:this.data=document.createElement(t),null===this.data)return void this.abort("Unsupported element: "+t);if(!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=0;e<this.url.length;++e)this.data.appendChild(this._createSource(t,this.url[e]));else this.data.appendChild(this._createSource(t,this.url));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXdrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+e.substr(e.lastIndexOf(".")+1));var n=document.createElement("source");return n.src=e,n.type=i,n},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(a(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnAbort=function(){this.abort(a(this.xhr)+" Request was aborted by the user.")},t.prototype._xdrOnTimeout=function(){this.abort(a(this.xhr)+" Request timed out.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",n="undefined"==typeof e.status?_:e.status;""!==e.responseType&&"text"!==e.responseType&&"undefined"!=typeof e.responseType||(i=e.responseText),n===m&&i.length>0?n=_:n===x&&(n=y);var o=n/100|0;if(o!==v)return void this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(i,"text/xml")}else{var s=document.createElement("div");s.innerHTML=i,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";e=e||window.location,f||(f=document.createElement("a")),f.href=t,t=(0,h.default)(f.href,{strictMode:!0});var i=!t.port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var n=t.indexOf("?");n!==-1&&(t=t.substring(0,n)),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},l(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();i.default=g,g.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},g.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},g.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},g.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},g._loadTypeMap={gif:g.LOAD_TYPE.IMAGE,png:g.LOAD_TYPE.IMAGE,bmp:g.LOAD_TYPE.IMAGE,jpg:g.LOAD_TYPE.IMAGE,jpeg:g.LOAD_TYPE.IMAGE,tif:g.LOAD_TYPE.IMAGE,tiff:g.LOAD_TYPE.IMAGE,webp:g.LOAD_TYPE.IMAGE,tga:g.LOAD_TYPE.IMAGE,svg:g.LOAD_TYPE.IMAGE,"svg+xml":g.LOAD_TYPE.IMAGE,mp3:g.LOAD_TYPE.AUDIO,ogg:g.LOAD_TYPE.AUDIO,wav:g.LOAD_TYPE.AUDIO,mp4:g.LOAD_TYPE.VIDEO,webm:g.LOAD_TYPE.VIDEO},g._xhrTypeMap={xhtml:g.XHR_RESPONSE_TYPE.DOCUMENT,html:g.XHR_RESPONSE_TYPE.DOCUMENT,htm:g.XHR_RESPONSE_TYPE.DOCUMENT,xml:g.XHR_RESPONSE_TYPE.DOCUMENT,tmx:g.XHR_RESPONSE_TYPE.DOCUMENT,svg:g.XHR_RESPONSE_TYPE.DOCUMENT,tsx:g.XHR_RESPONSE_TYPE.DOCUMENT,gif:g.XHR_RESPONSE_TYPE.BLOB,png:g.XHR_RESPONSE_TYPE.BLOB,bmp:g.XHR_RESPONSE_TYPE.BLOB,jpg:g.XHR_RESPONSE_TYPE.BLOB,jpeg:g.XHR_RESPONSE_TYPE.BLOB,tif:g.XHR_RESPONSE_TYPE.BLOB,tiff:g.XHR_RESPONSE_TYPE.BLOB,webp:g.XHR_RESPONSE_TYPE.BLOB,tga:g.XHR_RESPONSE_TYPE.BLOB,json:g.XHR_RESPONSE_TYPE.JSON,text:g.XHR_RESPONSE_TYPE.TEXT,txt:g.XHR_RESPONSE_TYPE.TEXT,ttf:g.XHR_RESPONSE_TYPE.BUFFER,otf:g.XHR_RESPONSE_TYPE.BUFFER},g.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},{"mini-signals":37,"parse-uri":38}],33:[function(t,e,i){"use strict";function n(){}function o(t,e,i){var n=0,o=t.length;!function r(s){return s||n===o?void(i&&i(s)):void e(t[n++],r)}()}function r(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function s(t,e){function i(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(a.started=!0,null==t&&a.idle())return void setTimeout(function(){return a.drain()},1);var o={data:t,callback:"function"==typeof i?i:n};e?a._tasks.unshift(o):a._tasks.push(o),setTimeout(function(){return a.process()},1)}function o(t){return function(){s-=1,t.callback.apply(t,arguments),null!=arguments[0]&&a.error(arguments[0],t.data),s<=a.concurrency-a.buffer&&a.unsaturated(),a.idle()&&a.drain(),a.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=0,a={_tasks:[],concurrency:e,saturated:n,unsaturated:n,buffer:e/4,empty:n,drain:n,error:n,started:!1,paused:!1,push:function(t,e){i(t,!1,e)},kill:function(){s=0,a.drain=n,a.started=!1,a._tasks=[]},unshift:function(t,e){i(t,!0,e)},process:function(){for(;!a.paused&&s<a.concurrency&&a._tasks.length;){var e=a._tasks.shift();0===a._tasks.length&&a.empty(),s+=1,s===a.concurrency&&a.saturated(),t(e.data,r(o(e)))}},length:function(){return a._tasks.length},running:function(){return s},idle:function(){return a._tasks.length+s===0},pause:function(){a.paused!==!0&&(a.paused=!0)},resume:function(){if(a.paused!==!1){a.paused=!1;for(var t=1;t<=a.concurrency;t++)a.process()}}};return a}i.__esModule=!0,i.eachSeries=o,i.queue=s},{}],34:[function(t,e,i){"use strict";function n(t){for(var e="",i=0;i<t.length;){for(var n=[0,0,0],r=[0,0,0,0],s=0;s<n.length;++s)i<t.length?n[s]=255&t.charCodeAt(i++):n[s]=0;r[0]=n[0]>>2,r[1]=(3&n[0])<<4|n[1]>>4,r[2]=(15&n[1])<<2|n[2]>>6,r[3]=63&n[2];var a=i-(t.length-1);switch(a){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64}for(var l=0;l<r.length;++l)e+=o.charAt(r[l])}return e}i.__esModule=!0,i.encodeBinary=n;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},{}],35:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var r=t("./Loader"),s=o(r),a=t("./Resource"),l=o(a),u=t("./async"),h=n(u),c=t("./b64"),p=n(c);s.default.Resource=l.default,s.default.async=h,s.default.base64=p,e.exports=s.default,i.default=s.default},{"./Loader":31,"./Resource":32,"./async":33,"./b64":34}],36:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){return function(t,e){if(!t.data)return void e();if(t.xhr&&t.xhrType===a.default.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var i=function(){var i=h.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=a.default.TYPE.IMAGE,t.data.onload=function(){h.revokeObjectURL(i),t.data.onload=null,e()},{v:void 0}}();if("object"===("undefined"==typeof i?"undefined":r(i)))return i.v}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+u.default.encodeBinary(t.xhr.responseText),
t.type=a.default.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}}i.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i.blobMiddlewareFactory=o;var s=t("../../Resource"),a=n(s),l=t("../../b64"),u=n(l),h=window.URL||window.webkitURL},{"../../Resource":32,"../../b64":34}],37:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e,i,o){void 0===i&&(i=!1),n(this,t),this._fn=e,this._once=i,this._thisArg=o,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}(),a=function(){function t(){n(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,i.default=a,e.exports=i.default},{}],38:[function(t,e,i){"use strict";e.exports=function(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=i.parser[e.strictMode?"strict":"loose"].exec(t),o={},r=14;r--;)o[i.key[r]]=n[r]||"";return o[i.q.name]={},o[i.key[12]].replace(i.q.parser,function(t,e,n){e&&(o[i.q.name][e]=n)}),o}},{}],39:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var s=t("../core"),a=o(s),l=t("ismobilejs"),u=n(l),h=t("./accessibleTarget"),c=n(h);a.utils.mixins.delayMixin(a.DisplayObject.prototype,c.default);var p=9,d=100,f=0,m=0,_=2,y=1,x=-1e3,v=-1e3,g=2,b=function(){function t(e){r(this,t),!u.default.tablet&&!u.default.phone||navigator.isCocoonJS||this.createTouchHook();var i=document.createElement("div");i.style.width=d+"px",i.style.height=d+"px",i.style.position="absolute",i.style.top=f+"px",i.style.left=m+"px",i.style.zIndex=_,this.div=i,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessabillity=!1,window.addEventListener("keydown",this._onKeyDown,!1)}return t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width=y+"px",e.style.height=y+"px",e.style.position="absolute",e.style.top=x+"px",e.style.left=v+"px",e.style.zIndex=g,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessabillity=!0,t.activate(),document.body.removeChild(e)}),document.body.appendChild(e)},t.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},t.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessabillity&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=e.length-1;i>=0;i--)this.updateAccessibleObjects(e[i])}},t.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,n=this.div;n.style.left=t.left+"px",n.style.top=t.top+"px",n.style.width=this.renderer.width+"px",n.style.height=this.renderer.height+"px";for(var o=0;o<this.children.length;o++){var r=this.children[o];if(r.renderId!==this.renderId)r._accessibleActive=!1,a.utils.removeItems(this.children,o,1),this.div.removeChild(r._accessibleDiv),this.pool.push(r._accessibleDiv),r._accessibleDiv=null,o--,0===this.children.length&&this.deactivate();else{n=r._accessibleDiv;var s=r.hitArea,l=r.worldTransform;r.hitArea?(n.style.left=(l.tx+s.x*l.a)*e+"px",n.style.top=(l.ty+s.y*l.d)*i+"px",n.style.width=s.width*l.a*e+"px",n.style.height=s.height*l.d*i+"px"):(s=r.getBounds(),this.capHitArea(s),n.style.left=s.x*e+"px",n.style.top=s.y*i+"px",n.style.width=s.width*e+"px",n.style.height=s.height*i+"px")}}this.renderId++}},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=d+"px",e.style.height=d+"px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=_,e.style.borderStyle="none",e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleTitle||t.accessibleHint||(e.title="displayObject "+this.tabIndex),t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},t.prototype._onFocus=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},t.prototype._onFocusOut=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},t.prototype._onKeyDown=function(t){t.keyCode===p&&this.activate()},t.prototype._onMouseMove=function(){this.deactivate()},t.prototype.destroy=function(){this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t}();i.default=b,a.WebGLRenderer.registerPlugin("accessibility",b),a.CanvasRenderer.registerPlugin("accessibility",b)},{"../core":64,"./accessibleTarget":40,ismobilejs:4}],40:[function(t,e,i){"use strict";i.__esModule=!0,i.default={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1}},{}],41:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./accessibleTarget");Object.defineProperty(i,"accessibleTarget",{enumerable:!0,get:function(){return n(o).default}});var r=t("./AccessibilityManager");Object.defineProperty(i,"AccessibilityManager",{enumerable:!0,get:function(){return n(r).default}})},{"./AccessibilityManager":39,"./accessibleTarget":40}],42:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("./autoDetectRenderer"),a=t("./display/Container"),l=n(a),u=t("./ticker"),h=function(){function t(e,i,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];o(this,t),this.renderer=(0,s.autoDetectRenderer)(e,i,n,r),this.stage=new l.default,this._ticker=null,this.ticker=a?u.shared:new u.Ticker,this.start()}return t.prototype.render=function(){this.renderer.render(this.stage)},t.prototype.stop=function(){this._ticker.stop()},t.prototype.start=function(){this._ticker.start()},t.prototype.destroy=function(t){this.stop(),this.ticker=null,this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null},r(t,[{key:"ticker",set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this)},get:function(){return this._ticker}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}}]),t}();i.default=h},{"./autoDetectRenderer":44,"./display/Container":47,"./ticker":117}],43:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(t instanceof Array){if("precision"!==t[0].substring(0,9)){var i=t.slice(0);return i.unshift("precision "+e+" float;"),i}}else if("precision"!==t.substring(0,9))return"precision "+e+" float;\n"+t;return t}i.__esModule=!0;var l=t("pixi-gl-core"),u=t("./settings"),h=n(u),c=function(t){function e(i,n,s){return o(this,e),r(this,t.call(this,i,a(n,h.default.PRECISION_VERTEX),a(s,h.default.PRECISION_FRAGMENT)))}return s(e,t),e}(l.GLShader);i.default=c},{"./settings":100,"pixi-gl-core":12}],44:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600,i=arguments[2],n=arguments[3];return!n&&a.isWebGLSupported()?new c.default(t,e,i):new u.default(t,e,i)}i.__esModule=!0,i.autoDetectRenderer=r;var s=t("./utils"),a=o(s),l=t("./renderers/canvas/CanvasRenderer"),u=n(l),h=t("./renderers/webgl/WebGLRenderer"),c=n(h)},{"./renderers/canvas/CanvasRenderer":76,"./renderers/webgl/WebGLRenderer":83,"./utils":121}],45:[function(t,e,i){"use strict";i.__esModule=!0;i.VERSION="4.4.1",i.PI_2=2*Math.PI,i.RAD_TO_DEG=180/Math.PI,i.DEG_TO_RAD=Math.PI/180,i.RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},i.BLEND_MODES={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},i.DRAW_MODES={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},i.SCALE_MODES={LINEAR:0,NEAREST:1},i.WRAP_MODES={CLAMP:0,REPEAT:1,MIRRORED_REPEAT:2},i.GC_MODES={AUTO:0,MANUAL:1},i.URL_FILE_EXTENSION=/\.(\w{3,4})(?:$|\?|#)/i,i.DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;(charset=[\w-]+|base64))?,(.*)/i,i.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,i.SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},i.PRECISION={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"},i.TRANSFORM_MODE={STATIC:0,DYNAMIC:1},i.TEXT_GRADIENT={LINEAR_VERTICAL:0,LINEAR_HORIZONTAL:1}},{}],46:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=t("../math"),r=function(){function t(){n(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.rect=null}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0)},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?o.Rectangle.EMPTY:(t=t||new o.Rectangle(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,o=this.maxY,r=t[0],s=t[1];e=r<e?r:e,i=s<i?s:i,n=r>n?r:n,o=s>o?s:o,r=t[2],s=t[3],e=r<e?r:e,i=s<i?s:i,n=r>n?r:n,o=s>o?s:o,r=t[4],s=t[5],e=r<e?r:e,i=s<i?s:i,n=r>n?r:n,o=s>o?s:o,r=t[6],s=t[7],e=r<e?r:e,i=s<i?s:i,n=r>n?r:n,o=s>o?s:o,this.minX=e,this.minY=i,this.maxX=n,this.maxY=o},t.prototype.addFrame=function(t,e,i,n,o){var r=t.worldTransform,s=r.a,a=r.b,l=r.c,u=r.d,h=r.tx,c=r.ty,p=this.minX,d=this.minY,f=this.maxX,m=this.maxY,_=s*e+l*i+h,y=a*e+u*i+c;p=_<p?_:p,d=y<d?y:d,f=_>f?_:f,m=y>m?y:m,_=s*n+l*i+h,y=a*n+u*i+c,p=_<p?_:p,d=y<d?y:d,f=_>f?_:f,m=y>m?y:m,_=s*e+l*o+h,y=a*e+u*o+c,p=_<p?_:p,d=y<d?y:d,f=_>f?_:f,m=y>m?y:m,_=s*n+l*o+h,y=a*n+u*o+c,p=_<p?_:p,d=y<d?y:d,f=_>f?_:f,m=y>m?y:m,this.minX=p,this.minY=d,this.maxX=f,this.maxY=m},t.prototype.addVertices=function(t,e,i,n){for(var o=t.worldTransform,r=o.a,s=o.b,a=o.c,l=o.d,u=o.tx,h=o.ty,c=this.minX,p=this.minY,d=this.maxX,f=this.maxY,m=i;m<n;m+=2){var _=e[m],y=e[m+1],x=r*_+a*y+u,v=l*y+s*_+h;c=x<c?x:c,p=v<p?v:p,d=x>d?x:d,f=v>f?v:f}this.minX=c,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>o?t.maxY:o},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,r=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=o&&n<=r){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=o>l?o:l,this.maxY=r>u?r:u}},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,r=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=o&&n<=r){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=i<s?i:s,this.minY=n<a?n:a,this.maxX=o>l?o:l,this.maxY=r>u?r:u}},t}();i.default=r},{"../math":69}],47:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../utils"),u=t("./DisplayObject"),h=n(u),c=function(t){function e(){o(this,e);var i=r(this,t.call(this));return i.children=[],i}return s(e,t),e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(t);(0,l.removeItems)(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments.length;if(e>1)for(var i=0;i<e;i++)this.removeChild(arguments[i]);else{var n=this.children.indexOf(t);if(n===-1)return null;t.parent=null,t.transform._parentID=-1,(0,l.removeItems)(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,l.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),e},e.prototype.removeChildren=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=t,n="number"==typeof e?e:this.children.length,o=n-i,r=void 0;if(o>0&&o<=n){r=this.children.splice(i,o);for(var s=0;s<r.length;++s)r[s].parent=null,r[s].transform&&(r[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<r.length;++a)r[a].emit("removed",this);return r}if(0===o&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this._filters)this.renderAdvancedWebGL(t);else{this._renderWebGL(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderWebGL(t)}},e.prototype.renderAdvancedWebGL=function(t){t.flush();var e=this._filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filterManager.pushFilter(this,this._enabledFilters)}i&&t.maskManager.pushMask(this,this._mask),this._renderWebGL(t);for(var o=0,r=this.children.length;o<r;o++)this.children[o].renderWebGL(t);t.flush(),i&&t.maskManager.popMask(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filterManager.popFilter()},e.prototype._renderWebGL=function(t){},e.prototype._renderCanvas=function(t){},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},e.prototype.destroy=function(e){t.prototype.destroy.call(this);var i="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(i)for(var o=0;o<n.length;++o)n[o].destroy(e)},a(e,[{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;0!==e?this.scale.x=t/e:this.scale.x=1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;0!==e?this.scale.y=t/e:this.scale.y=1,this._height=t}}]),e}(h.default);i.default=c,c.prototype.containerUpdateTransform=c.prototype.updateTransform},{"../utils":121,"./DisplayObject":48}],48:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("eventemitter3"),u=n(l),h=t("../const"),c=t("../settings"),p=n(c),d=t("./TransformStatic"),f=n(d),m=t("./Transform"),_=n(m),y=t("./Bounds"),x=n(y),v=t("../math"),g=function(t){function e(){o(this,e);var i=r(this,t.call(this)),n=p.default.TRANSFORM_MODE===h.TRANSFORM_MODE.STATIC?f.default:_.default;return i.tempDisplayObjectParent=null,i.transform=new n,i.alpha=1,i.visible=!0,i.renderable=!0,i.parent=null,i.worldAlpha=1,i.filterArea=null,i._filters=null,i._enabledFilters=null,i._bounds=new x.default,i._boundsID=0,i._lastBoundsID=-1,i._boundsRect=null,i._localBoundsRect=null,i._mask=null,i}return s(e,t),e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new v.Rectangle),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new v.Rectangle),t=this._localBoundsRect);var n=this.getBounds(!1,t);return this.parent=i,this.transform=e,n},e.prototype.toGlobal=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.renderWebGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=i?i:1,this.scale.y=n?n:1,this.rotation=o,this.skew.x=r,this.skew.y=s,this.pivot.x=a,this.pivot.y=l,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1},a(e,[{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copy(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copy(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copy(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copy(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},{key:"filters",get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}]),e}(u.default);i.default=g,g.prototype.displayObjectUpdateTransform=g.prototype.updateTransform},{"../const":45,"../math":69,"../settings":100,"./Bounds":46,"./Transform":49,"./TransformStatic":51,eventemitter3:3}],49:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../math"),u=t("./TransformBase"),h=n(u),c=function(t){function e(){o(this,e);var i=r(this,t.call(this));return i.position=new l.Point(0,0),i.scale=new l.Point(1,1),i.skew=new l.ObservablePoint(i.updateSkew,i,0,0),i.pivot=new l.Point(0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i}return s(e,t),e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x)},e.prototype.updateLocalTransform=function(){var t=this.localTransform;t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d)},e.prototype.updateTransform=function(t){var e=this.localTransform;e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d);var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._worldID++},e.prototype.setFromMatrix=function(t){t.decompose(this)},a(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(h.default);i.default=c},{"../math":69,"./TransformBase":50}],50:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=t("../math"),r=function(){function t(){n(this,t),this.worldTransform=new o.Matrix,this.localTransform=new o.Matrix,this._worldID=0,this._parentID=0}return t.prototype.updateLocalTransform=function(){},
t.prototype.updateTransform=function(t){var e=t.worldTransform,i=this.worldTransform,n=this.localTransform;i.a=n.a*e.a+n.b*e.c,i.b=n.a*e.b+n.b*e.d,i.c=n.c*e.a+n.d*e.c,i.d=n.c*e.b+n.d*e.d,i.tx=n.tx*e.a+n.ty*e.c+e.tx,i.ty=n.tx*e.b+n.ty*e.d+e.ty,this._worldID++},t}();i.default=r,r.prototype.updateWorldTransform=r.prototype.updateTransform,r.IDENTITY=new r},{"../math":69}],51:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../math"),u=t("./TransformBase"),h=n(u),c=function(t){function e(){o(this,e);var i=r(this,t.call(this));return i.position=new l.ObservablePoint(i.onChange,i,0,0),i.scale=new l.ObservablePoint(i.onChange,i,1,1),i.pivot=new l.ObservablePoint(i.onChange,i,0,0),i.skew=new l.ObservablePoint(i.updateSkew,i,0,0),i._rotation=0,i._cx=1,i._sx=0,i._cy=0,i._sy=1,i._localID=0,i._currentLocalID=0,i}return s(e,t),e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},e.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},e.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},a(e,[{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.updateSkew()}}]),e}(h.default);i.default=c},{"../math":69,"./TransformBase":50}],52:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../display/Container"),l=n(a),u=t("../textures/RenderTexture"),h=n(u),c=t("../textures/Texture"),p=n(c),d=t("./GraphicsData"),f=n(d),m=t("../sprites/Sprite"),_=n(m),y=t("../math"),x=t("../utils"),v=t("../const"),g=t("../display/Bounds"),b=n(g),w=t("./utils/bezierCurveTo"),S=n(w),C=t("../renderers/canvas/CanvasRenderer"),D=n(C),T=void 0,A=new y.Matrix,B=new y.Point,M=new Float32Array(4),E=new Float32Array(4),P=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o(this,e);var n=r(this,t.call(this));return n.fillAlpha=1,n.lineWidth=0,n.nativeLines=i,n.lineColor=0,n.graphicsData=[],n.tint=16777215,n._prevTint=16777215,n.blendMode=v.BLEND_MODES.NORMAL,n.currentPath=null,n._webGL={},n.isMask=!1,n.boundsPadding=0,n._localBounds=new b.default,n.dirty=0,n.fastRectDirty=-1,n.clearDirty=0,n.boundsDirty=-1,n.cachedSpriteDirty=!1,n._spriteRect=null,n._fastRect=!1,n}return s(e,t),e.prototype.clone=function t(){var t=new e;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=0,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)t.graphicsData.push(this.graphicsData[i].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},e.prototype.lineStyle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.lineWidth=t,this.lineColor=e,this.lineAlpha=i,this.currentPath)if(this.currentPath.shape.points.length){var n=new y.Polygon(this.currentPath.shape.points.slice(-2));n.closed=!1,this.drawShape(n)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},e.prototype.moveTo=function(t,e){var i=new y.Polygon([t,e]);return i.closed=!1,this.drawShape(i),this},e.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty++,this},e.prototype.quadraticCurveTo=function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=20,r=this.currentPath.shape.points,s=0,a=0;0===r.length&&this.moveTo(0,0);for(var l=r[r.length-2],u=r[r.length-1],h=1;h<=o;++h){var c=h/o;s=l+(t-l)*c,a=u+(e-u)*c,r.push(s+(t+(i-t)*c-s)*c,a+(e+(n-e)*c-a)*c)}return this.dirty++,this},e.prototype.bezierCurveTo=function(t,e,i,n,o,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,a=s[s.length-2],l=s[s.length-1];return s.length-=2,(0,S.default)(a,l,t,e,i,n,o,r,s),this.dirty++,this},e.prototype.arcTo=function(t,e,i,n,o){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r=this.currentPath.shape.points,s=r[r.length-2],a=r[r.length-1],l=a-e,u=s-t,h=n-e,c=i-t,p=Math.abs(l*c-u*h);if(p<1e-8||0===o)r[r.length-2]===t&&r[r.length-1]===e||r.push(t,e);else{var d=l*l+u*u,f=h*h+c*c,m=l*h+u*c,_=o*Math.sqrt(d)/p,y=o*Math.sqrt(f)/p,x=_*m/d,v=y*m/f,g=_*c+y*u,b=_*h+y*l,w=u*(y+x),S=l*(y+x),C=c*(_+v),D=h*(_+v),T=Math.atan2(S-b,w-g),A=Math.atan2(D-b,C-g);this.arc(g+t,b+e,o,T,A,u*h>c*l)}return this.dirty++,this},e.prototype.arc=function(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(n===o)return this;!r&&o<=n?o+=2*Math.PI:r&&n<=o&&(n+=2*Math.PI);var s=o-n,a=40*Math.ceil(Math.abs(s)/(2*Math.PI));if(0===s)return this;var l=t+Math.cos(n)*i,u=e+Math.sin(n)*i,h=this.currentPath?this.currentPath.shape.points:null;h?h[h.length-2]===l&&h[h.length-1]===u||h.push(l,u):(this.moveTo(l,u),h=this.currentPath.shape.points);for(var c=s/(2*a),p=2*c,d=Math.cos(c),f=Math.sin(c),m=a-1,_=m%1/m,y=0;y<=m;++y){var x=y+_*y,v=c+n+p*x,g=Math.cos(v),b=-Math.sin(v);h.push((d*g+f*b)*i+t,(d*-b+f*g)*i+e)}return this.dirty++,this},e.prototype.beginFill=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.filling=!0,this.fillColor=t,this.fillAlpha=e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},e.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.prototype.drawRect=function(t,e,i,n){return this.drawShape(new y.Rectangle(t,e,i,n)),this},e.prototype.drawRoundedRect=function(t,e,i,n,o){return this.drawShape(new y.RoundedRectangle(t,e,i,n,o)),this},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new y.Circle(t,e,i)),this},e.prototype.drawEllipse=function(t,e,i,n){return this.drawShape(new y.Ellipse(t,e,i,n)),this},e.prototype.drawPolygon=function(t){var e=t,i=!0;if(e instanceof y.Polygon&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var o=new y.Polygon(e);return o.closed=i,this.drawShape(o),this},e.prototype.clear=function(){return(this.lineWidth||this.filling||this.graphicsData.length>0)&&(this.lineWidth=0,this.filling=!1,this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return 1===this.graphicsData.length&&this.graphicsData[0].shape.type===v.SHAPES.RECT&&!this.graphicsData[0].lineWidth},e.prototype._renderWebGL=function(t){this.dirty!==this.fastRectDirty&&(this.fastRectDirty=this.dirty,this._fastRect=this.isFastRect()),this._fastRect?this._renderSpriteRect(t):(t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this))},e.prototype._renderSpriteRect=function(t){var e=this.graphicsData[0].shape;this._spriteRect||(this._spriteRect=new _.default(new p.default(p.default.WHITE)));var i=this._spriteRect;if(16777215===this.tint)i.tint=this.graphicsData[0].fillColor;else{var n=M,o=E;(0,x.hex2rgb)(this.graphicsData[0].fillColor,n),(0,x.hex2rgb)(this.tint,o),n[0]*=o[0],n[1]*=o[1],n[2]*=o[2],i.tint=(0,x.rgb2hex)(n)}i.alpha=this.graphicsData[0].fillAlpha,i.worldAlpha=this.worldAlpha*i.alpha,i.blendMode=this.blendMode,i.texture._frame.width=e.width,i.texture._frame.height=e.height,i.transform.worldTransform=this.transform.worldTransform,i.anchor.set(-e.x/e.width,-e.y/e.height),i._onAnchorUpdate(),i._renderWebGL(t)},e.prototype._renderCanvas=function(t){this.isMask!==!0&&t.plugins.graphics.render(this)},e.prototype._calculateBounds=function(){this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.updateLocalBounds(),this.cachedSpriteDirty=!0);var t=this._localBounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,B);for(var e=this.graphicsData,i=0;i<e.length;++i){var n=e[i];if(n.fill&&n.shape&&n.shape.contains(B.x,B.y))return!0}return!1},e.prototype.updateLocalBounds=function(){var t=1/0,e=-(1/0),i=1/0,n=-(1/0);if(this.graphicsData.length)for(var o=0,r=0,s=0,a=0,l=0,u=0;u<this.graphicsData.length;u++){var h=this.graphicsData[u],c=h.type,p=h.lineWidth;if(o=h.shape,c===v.SHAPES.RECT||c===v.SHAPES.RREC)r=o.x-p/2,s=o.y-p/2,a=o.width+p,l=o.height+p,t=r<t?r:t,e=r+a>e?r+a:e,i=s<i?s:i,n=s+l>n?s+l:n;else if(c===v.SHAPES.CIRC)r=o.x,s=o.y,a=o.radius+p/2,l=o.radius+p/2,t=r-a<t?r-a:t,e=r+a>e?r+a:e,i=s-l<i?s-l:i,n=s+l>n?s+l:n;else if(c===v.SHAPES.ELIP)r=o.x,s=o.y,a=o.width+p/2,l=o.height+p/2,t=r-a<t?r-a:t,e=r+a>e?r+a:e,i=s-l<i?s-l:i,n=s+l>n?s+l:n;else for(var d=o.points,f=0,m=0,_=0,y=0,x=0,g=0,b=0,w=0,S=0;S+2<d.length;S+=2)r=d[S],s=d[S+1],f=d[S+2],m=d[S+3],_=Math.abs(f-r),y=Math.abs(m-s),l=p,a=Math.sqrt(_*_+y*y),a<1e-9||(x=(l/a*y+_)/2,g=(l/a*_+y)/2,b=(f+r)/2,w=(m+s)/2,t=b-x<t?b-x:t,e=b+x>e?b+x:e,i=w-g<i?w-g:i,n=w+g>n?w+g:n)}else t=0,e=0,i=0,n=0;var C=this.boundsPadding;this._localBounds.minX=t-C,this._localBounds.maxX=e+2*C,this._localBounds.minY=i-C,this._localBounds.maxY=n+2*C},e.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new f.default(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,this.nativeLines,t);return this.graphicsData.push(e),e.type===v.SHAPES.POLY&&(e.shape.closed=e.shape.closed||this.filling,this.currentPath=e),this.dirty++,e},e.prototype.generateCanvasTexture=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=this.getLocalBounds(),n=h.default.create(i.width,i.height,t,e);T||(T=new D.default),this.transform.updateLocalTransform(),this.transform.localTransform.copy(A),A.invert(),A.tx-=i.x,A.ty-=i.y,T.render(this,n,!0,A);var o=p.default.fromCanvas(n.baseTexture._canvasRenderTarget.canvas,t);return o.baseTexture.resolution=e,o.baseTexture.update(),o},e.prototype.closePath=function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this},e.prototype.addHole=function(){var t=this.graphicsData.pop();return this.currentPath=this.graphicsData[this.graphicsData.length-1],this.currentPath.addHole(t.shape),this.currentPath=null,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(var n in this._webgl)for(var o=0;o<this._webgl[n].data.length;++o)this._webgl[n].data[o].destroy();this._spriteRect&&this._spriteRect.destroy(),this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null},e}(l.default);i.default=P,P._SPRITE_TEXTURE=null},{"../const":45,"../display/Bounds":46,"../display/Container":47,"../math":69,"../renderers/canvas/CanvasRenderer":76,"../sprites/Sprite":101,"../textures/RenderTexture":111,"../textures/Texture":113,"../utils":121,"./GraphicsData":53,"./utils/bezierCurveTo":55}],53:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(e,i,o,r,s,a,l,u){n(this,t),this.lineWidth=e,this.nativeLines=l,this.lineColor=i,this.lineAlpha=o,this._lineTint=i,this.fillColor=r,this.fillAlpha=s,this._fillTint=r,this.fill=a,this.holes=[],this.shape=u,this.type=u.type}return t.prototype.clone=function(){return new t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.nativeLines,this.shape)},t.prototype.addHole=function(t){this.holes.push(t)},t.prototype.destroy=function(){this.shape=null,this.holes=null},t}();i.default=o},{}],54:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../renderers/canvas/CanvasRenderer"),s=n(r),a=t("../../const"),l=function(){function t(e){o(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldAlpha,o=t.transform.worldTransform,r=e.resolution;this._prevTint!==this.tint&&(this.dirty=!0),i.setTransform(o.a*r,o.b*r,o.c*r,o.d*r,o.tx*r,o.ty*r),t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1),e.setBlendMode(t.blendMode);for(var s=0;s<t.graphicsData.length;s++){var l=t.graphicsData[s],u=l.shape,h=l._fillTint,c=l._lineTint;if(i.lineWidth=l.lineWidth,l.type===a.SHAPES.POLY){i.beginPath(),this.renderPolygon(u.points,u.closed,i);for(var p=0;p<l.holes.length;p++)this.renderPolygon(l.holes[p].points,!0,i);l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.stroke())}else if(l.type===a.SHAPES.RECT)(l.fillColor||0===l.fillColor)&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fillRect(u.x,u.y,u.width,u.height)),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.strokeRect(u.x,u.y,u.width,u.height));else if(l.type===a.SHAPES.CIRC)i.beginPath(),i.arc(u.x,u.y,u.radius,0,2*Math.PI),i.closePath(),l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.stroke());else if(l.type===a.SHAPES.ELIP){var d=2*u.width,f=2*u.height,m=u.x-d/2,_=u.y-f/2;i.beginPath();var y=.5522848,x=d/2*y,v=f/2*y,g=m+d,b=_+f,w=m+d/2,S=_+f/2;i.moveTo(m,S),i.bezierCurveTo(m,S-v,w-x,_,w,_),i.bezierCurveTo(w+x,_,g,S-v,g,S),i.bezierCurveTo(g,S+v,w+x,b,w,b),i.bezierCurveTo(w-x,b,m,S+v,m,S),i.closePath(),l.fill&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.stroke())}else if(l.type===a.SHAPES.RREC){var C=u.x,D=u.y,T=u.width,A=u.height,B=u.radius,M=Math.min(T,A)/2|0;B=B>M?M:B,i.beginPath(),i.moveTo(C,D+B),i.lineTo(C,D+A-B),i.quadraticCurveTo(C,D+A,C+B,D+A),i.lineTo(C+T-B,D+A),i.quadraticCurveTo(C+T,D+A,C+T,D+A-B),i.lineTo(C+T,D+B),i.quadraticCurveTo(C+T,D,C+T-B,D),i.lineTo(C+B,D),i.quadraticCurveTo(C,D,C,D+B),i.closePath(),(l.fillColor||0===l.fillColor)&&(i.globalAlpha=l.fillAlpha*n,i.fillStyle="#"+("00000"+(0|h).toString(16)).substr(-6),i.fill()),l.lineWidth&&(i.globalAlpha=l.lineAlpha*n,i.strokeStyle="#"+("00000"+(0|c).toString(16)).substr(-6),i.stroke())}}},t.prototype.updateGraphicsTint=function(t){t._prevTint=t.tint;for(var e=(t.tint>>16&255)/255,i=(t.tint>>8&255)/255,n=(255&t.tint)/255,o=0;o<t.graphicsData.length;++o){var r=t.graphicsData[o],s=0|r.fillColor,a=0|r.lineColor;r._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*i*255<<8)+(255&s)/255*n*255,r._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*i*255<<8)+(255&a)/255*n*255}},t.prototype.renderPolygon=function(t,e,i){i.moveTo(t[0],t[1]);for(var n=1;n<t.length/2;++n)i.lineTo(t[2*n],t[2*n+1]);e&&i.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=l,s.default.registerPlugin("graphics",l)},{"../../const":45,"../../renderers/canvas/CanvasRenderer":76}],55:[function(t,e,i){"use strict";function n(t,e,i,n,o,r,s,a){var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],u=20,h=0,c=0,p=0,d=0,f=0;l.push(t,e);for(var m=1,_=0;m<=u;++m)_=m/u,h=1-_,c=h*h,p=c*h,d=_*_,f=d*_,l.push(p*t+3*c*_*i+3*h*d*o+f*s,p*e+3*c*_*n+3*h*d*r+f*a);return l}i.__esModule=!0,i.default=n},{}],56:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../utils"),l=t("../../const"),u=t("../../renderers/webgl/utils/ObjectRenderer"),h=n(u),c=t("../../renderers/webgl/WebGLRenderer"),p=n(c),d=t("./WebGLGraphicsData"),f=n(d),m=t("./shaders/PrimitiveShader"),_=n(m),y=t("./utils/buildPoly"),x=n(y),v=t("./utils/buildRectangle"),g=n(v),b=t("./utils/buildRoundedRectangle"),w=n(b),S=t("./utils/buildCircle"),C=n(S),D=function(t){function e(i){o(this,e);var n=r(this,t.call(this,i));return n.graphicsDataPool=[],n.primitiveShader=null,n.gl=i.gl,n.CONTEXT_UID=0,n}return s(e,t),e.prototype.onContextChange=function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.primitiveShader=new _.default(this.gl)},e.prototype.destroy=function(){h.default.prototype.destroy.call(this);for(var t=0;t<this.graphicsDataPool.length;++t)this.graphicsDataPool[t].destroy();this.graphicsDataPool=null},e.prototype.render=function(t){var e=this.renderer,i=e.gl,n=void 0,o=t._webGL[this.CONTEXT_UID];o&&t.dirty===o.dirty||(this.updateGraphics(t),o=t._webGL[this.CONTEXT_UID]);var r=this.primitiveShader;e.bindShader(r),e.state.setBlendMode(t.blendMode);for(var s=0,l=o.data.length;s<l;s++){n=o.data[s];var u=n.shader;e.bindShader(u),u.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),u.uniforms.tint=(0,a.hex2rgb)(t.tint),u.uniforms.alpha=t.worldAlpha,e.bindVao(n.vao),t.nativeLines?i.drawArrays(i.LINES,0,n.points.length/6):n.vao.draw(i.TRIANGLE_STRIP,n.indices.length)}},e.prototype.updateGraphics=function(t){var e=this.renderer.gl,i=t._webGL[this.CONTEXT_UID];if(i||(i=t._webGL[this.CONTEXT_UID]={lastIndex:0,data:[],gl:e,clearDirty:-1,dirty:-1}),i.dirty=t.dirty,t.clearDirty!==i.clearDirty){i.clearDirty=t.clearDirty;for(var n=0;n<i.data.length;n++)this.graphicsDataPool.push(i.data[n]);i.data.length=0,i.lastIndex=0}for(var o=void 0,r=i.lastIndex;r<t.graphicsData.length;r++){var s=t.graphicsData[r];o=this.getWebGLData(i,0),s.type===l.SHAPES.POLY&&(0,x.default)(s,o),s.type===l.SHAPES.RECT?(0,g.default)(s,o):s.type===l.SHAPES.CIRC||s.type===l.SHAPES.ELIP?(0,C.default)(s,o):s.type===l.SHAPES.RREC&&(0,w.default)(s,o),i.lastIndex++}this.renderer.bindVao(null);for(var a=0;a<i.data.length;a++)o=i.data[a],o.dirty&&o.upload()},e.prototype.getWebGLData=function(t,e){var i=t.data[t.data.length-1];return(!i||i.points.length>32e4)&&(i=this.graphicsDataPool.pop()||new f.default(this.renderer.gl,this.primitiveShader,this.renderer.state.attribsState),i.reset(e),t.data.push(i)),i.dirty=!0,i},e}(h.default);i.default=D,p.default.registerPlugin("graphics",D)},{"../../const":45,"../../renderers/webgl/WebGLRenderer":83,"../../renderers/webgl/utils/ObjectRenderer":93,"../../utils":121,"./WebGLGraphicsData":57,"./shaders/PrimitiveShader":58,"./utils/buildCircle":59,"./utils/buildPoly":61,"./utils/buildRectangle":62,"./utils/buildRoundedRectangle":63}],57:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("pixi-gl-core"),s=n(r),a=function(){function t(e,i,n){o(this,t),this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=s.default.GLBuffer.createVertexBuffer(e),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(e),this.dirty=!0,this.glPoints=null,this.glIndices=null,this.shader=i,this.vao=new s.default.VertexArrayObject(e,n).addIndex(this.indexBuffer).addAttribute(this.buffer,i.attributes.aVertexPosition,e.FLOAT,!1,24,0).addAttribute(this.buffer,i.attributes.aColor,e.FLOAT,!1,24,8)}return t.prototype.reset=function(){this.points.length=0,this.indices.length=0},t.prototype.upload=function(){this.glPoints=new Float32Array(this.points),this.buffer.upload(this.glPoints),this.glIndices=new Uint16Array(this.indices),this.indexBuffer.upload(this.glIndices),this.dirty=!1},t.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.vao.destroy(),this.buffer.destroy(),this.indexBuffer.destroy(),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null},t}();i.default=a},{"pixi-gl-core":12}],58:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../../Shader"),l=n(a),u=function(t){function e(i){return o(this,e),r(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n")))}return s(e,t),e}(l.default);i.default=u},{"../../../Shader":43}],59:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i=t.shape,n=i.x,o=i.y,r=void 0,u=void 0;if(t.type===a.SHAPES.CIRC?(r=i.radius,u=i.radius):(r=i.width,u=i.height),0!==r&&0!==u){var h=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(i.width+i.height)),c=2*Math.PI/h;if(t.fill){var p=(0,l.hex2rgb)(t.fillColor),d=t.fillAlpha,f=p[0]*d,m=p[1]*d,_=p[2]*d,y=e.points,x=e.indices,v=y.length/6;x.push(v);for(var g=0;g<h+1;g++)y.push(n,o,f,m,_,d),y.push(n+Math.sin(c*g)*r,o+Math.cos(c*g)*u,f,m,_,d),x.push(v++,v++);x.push(v-1)}if(t.lineWidth){var b=t.points;t.points=[];for(var w=0;w<h+1;w++)t.points.push(n+Math.sin(c*w)*r,o+Math.cos(c*w)*u);(0,s.default)(t,e),t.points=b}}}i.__esModule=!0,i.default=o;var r=t("./buildLine"),s=n(r),a=t("../../../const"),l=t("../../../utils")},{"../../../const":45,"../../../utils":121,"./buildLine":60}],60:[function(t,e,i){"use strict";function n(t,e){var i=t.points;if(0!==i.length){var n=new r.Point(i[0],i[1]),o=new r.Point(i[i.length-2],i[i.length-1]);if(n.x===o.x&&n.y===o.y){i=i.slice(),i.pop(),i.pop(),o=new r.Point(i[i.length-2],i[i.length-1]);var a=o.x+.5*(n.x-o.x),l=o.y+.5*(n.y-o.y);i.unshift(a,l),i.push(a,l)}var u=e.points,h=e.indices,c=i.length/2,p=i.length,d=u.length/6,f=t.lineWidth/2,m=(0,s.hex2rgb)(t.lineColor),_=t.lineAlpha,y=m[0]*_,x=m[1]*_,v=m[2]*_,g=i[0],b=i[1],w=i[2],S=i[3],C=0,D=0,T=-(b-S),A=g-w,B=0,M=0,E=0,P=0,I=Math.sqrt(T*T+A*A);T/=I,A/=I,T*=f,A*=f,u.push(g-T,b-A,y,x,v,_),u.push(g+T,b+A,y,x,v,_);for(var O=1;O<c-1;++O){g=i[2*(O-1)],b=i[2*(O-1)+1],w=i[2*O],S=i[2*O+1],C=i[2*(O+1)],D=i[2*(O+1)+1],T=-(b-S),A=g-w,I=Math.sqrt(T*T+A*A),T/=I,A/=I,T*=f,A*=f,B=-(S-D),M=w-C,I=Math.sqrt(B*B+M*M),B/=I,M/=I,B*=f,M*=f;var R=-A+b-(-A+S),L=-T+w-(-T+g),F=(-T+g)*(-A+S)-(-T+w)*(-A+b),V=-M+D-(-M+S),k=-B+w-(-B+C),G=(-B+C)*(-M+S)-(-B+w)*(-M+D),N=R*k-V*L;if(Math.abs(N)<.1)N+=10.1,u.push(w-T,S-A,y,x,v,_),u.push(w+T,S+A,y,x,v,_);else{var j=(L*G-k*F)/N,U=(V*F-R*G)/N,X=(j-w)*(j-w)+(U-S)*(U-S);X>196*f*f?(E=T-B,P=A-M,I=Math.sqrt(E*E+P*P),E/=I,P/=I,E*=f,P*=f,u.push(w-E,S-P),u.push(y,x,v,_),u.push(w+E,S+P),u.push(y,x,v,_),u.push(w-E,S-P),u.push(y,x,v,_),p++):(u.push(j,U),u.push(y,x,v,_),u.push(w-(j-w),S-(U-S)),u.push(y,x,v,_))}}g=i[2*(c-2)],b=i[2*(c-2)+1],w=i[2*(c-1)],S=i[2*(c-1)+1],T=-(b-S),A=g-w,I=Math.sqrt(T*T+A*A),T/=I,A/=I,T*=f,A*=f,u.push(w-T,S-A),u.push(y,x,v,_),u.push(w+T,S+A),u.push(y,x,v,_),h.push(d);for(var J=0;J<p;++J)h.push(d++);h.push(d-1)}}function o(t,e){var i=0,n=t.points;if(0!==n.length){var o=e.points,r=n.length/2,a=(0,s.hex2rgb)(t.lineColor),l=t.lineAlpha,u=a[0]*l,h=a[1]*l,c=a[2]*l;for(i=1;i<r;i++){var p=n[2*(i-1)],d=n[2*(i-1)+1],f=n[2*i],m=n[2*i+1];o.push(p,d),o.push(u,h,c,l),o.push(f,m),o.push(u,h,c,l)}}}i.__esModule=!0,i.default=function(t,e){t.nativeLines?o(t,e):n(t,e)};var r=t("../../../math"),s=t("../../../utils")},{"../../../math":69,"../../../utils":121}],61:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){t.points=t.shape.points.slice();var i=t.points;if(t.fill&&i.length>=6){for(var n=[],o=t.holes,r=0;r<o.length;r++){var l=o[r];n.push(i.length/2),i=i.concat(l.points)}var h=e.points,c=e.indices,p=i.length/2,d=(0,a.hex2rgb)(t.fillColor),f=t.fillAlpha,m=d[0]*f,_=d[1]*f,y=d[2]*f,x=(0,u.default)(i,n,2);if(!x)return;for(var v=h.length/6,g=0;g<x.length;g+=3)c.push(x[g]+v),c.push(x[g]+v),c.push(x[g+1]+v),c.push(x[g+2]+v),c.push(x[g+2]+v);for(var b=0;b<p;b++)h.push(i[2*b],i[2*b+1],m,_,y,f)}t.lineWidth>0&&(0,s.default)(t,e)}i.__esModule=!0,i.default=o;var r=t("./buildLine"),s=n(r),a=t("../../../utils"),l=t("earcut"),u=n(l)},{"../../../utils":121,"./buildLine":60,earcut:2}],62:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i=t.shape,n=i.x,o=i.y,r=i.width,l=i.height;if(t.fill){var u=(0,a.hex2rgb)(t.fillColor),h=t.fillAlpha,c=u[0]*h,p=u[1]*h,d=u[2]*h,f=e.points,m=e.indices,_=f.length/6;f.push(n,o),f.push(c,p,d,h),f.push(n+r,o),f.push(c,p,d,h),f.push(n,o+l),f.push(c,p,d,h),f.push(n+r,o+l),f.push(c,p,d,h),m.push(_,_,_+1,_+2,_+3,_+3)}if(t.lineWidth){var y=t.points;t.points=[n,o,n+r,o,n+r,o+l,n,o+l,n,o],(0,s.default)(t,e),t.points=y}}i.__esModule=!0,i.default=o;var r=t("./buildLine"),s=n(r),a=t("../../../utils")},{"../../../utils":121,"./buildLine":60}],63:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i=t.shape,n=i.x,o=i.y,r=i.width,a=i.height,u=i.radius,p=[];if(p.push(n,o+u),s(n,o+a-u,n,o+a,n+u,o+a,p),s(n+r-u,o+a,n+r,o+a,n+r,o+a-u,p),s(n+r,o+u,n+r,o,n+r-u,o,p),s(n+u,o,n,o,n,o+u+1e-10,p),t.fill){for(var d=(0,c.hex2rgb)(t.fillColor),f=t.fillAlpha,m=d[0]*f,_=d[1]*f,y=d[2]*f,x=e.points,v=e.indices,g=x.length/6,b=(0,l.default)(p,null,2),w=0,S=b.length;w<S;w+=3)v.push(b[w]+g),v.push(b[w]+g),v.push(b[w+1]+g),v.push(b[w+2]+g),v.push(b[w+2]+g);for(var C=0,D=p.length;C<D;C++)x.push(p[C],p[++C],m,_,y,f)}if(t.lineWidth){var T=t.points;t.points=p,(0,h.default)(t,e),t.points=T}}function r(t,e,i){var n=e-t;return t+n*i}function s(t,e,i,n,o,s){for(var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],l=20,u=a,h=0,c=0,p=0,d=0,f=0,m=0,_=0,y=0;_<=l;++_)y=_/l,h=r(t,i,y),c=r(e,n,y),p=r(i,o,y),d=r(n,s,y),f=r(h,p,y),m=r(c,d,y),u.push(f,m);return u}i.__esModule=!0,i.default=o;var a=t("earcut"),l=n(a),u=t("./buildLine"),h=n(u),c=t("../../../utils")},{"../../../utils":121,"./buildLine":60,earcut:2}],64:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,i.autoDetectRenderer=i.Application=i.Filter=i.SpriteMaskFilter=i.Quad=i.RenderTarget=i.ObjectRenderer=i.WebGLManager=i.Shader=i.CanvasRenderTarget=i.TextureUvs=i.VideoBaseTexture=i.BaseRenderTexture=i.RenderTexture=i.BaseTexture=i.Texture=i.Spritesheet=i.CanvasGraphicsRenderer=i.GraphicsRenderer=i.GraphicsData=i.Graphics=i.TextStyle=i.Text=i.SpriteRenderer=i.CanvasTinter=i.CanvasSpriteRenderer=i.Sprite=i.TransformBase=i.TransformStatic=i.Transform=i.Container=i.DisplayObject=i.Bounds=i.glCore=i.WebGLRenderer=i.CanvasRenderer=i.ticker=i.utils=i.settings=void 0;var r=t("./const");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var s=t("./math");Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return s[t]}})});var a=t("pixi-gl-core");Object.defineProperty(i,"glCore",{enumerable:!0,get:function(){return o(a).default}});var l=t("./display/Bounds");Object.defineProperty(i,"Bounds",{enumerable:!0,get:function(){return o(l).default}});var u=t("./display/DisplayObject");Object.defineProperty(i,"DisplayObject",{enumerable:!0,get:function(){return o(u).default}});var h=t("./display/Container");Object.defineProperty(i,"Container",{enumerable:!0,get:function(){return o(h).default}});var c=t("./display/Transform");Object.defineProperty(i,"Transform",{enumerable:!0,get:function(){return o(c).default}});var p=t("./display/TransformStatic");Object.defineProperty(i,"TransformStatic",{enumerable:!0,get:function(){return o(p).default}});var d=t("./display/TransformBase");Object.defineProperty(i,"TransformBase",{
enumerable:!0,get:function(){return o(d).default}});var f=t("./sprites/Sprite");Object.defineProperty(i,"Sprite",{enumerable:!0,get:function(){return o(f).default}});var m=t("./sprites/canvas/CanvasSpriteRenderer");Object.defineProperty(i,"CanvasSpriteRenderer",{enumerable:!0,get:function(){return o(m).default}});var _=t("./sprites/canvas/CanvasTinter");Object.defineProperty(i,"CanvasTinter",{enumerable:!0,get:function(){return o(_).default}});var y=t("./sprites/webgl/SpriteRenderer");Object.defineProperty(i,"SpriteRenderer",{enumerable:!0,get:function(){return o(y).default}});var x=t("./text/Text");Object.defineProperty(i,"Text",{enumerable:!0,get:function(){return o(x).default}});var v=t("./text/TextStyle");Object.defineProperty(i,"TextStyle",{enumerable:!0,get:function(){return o(v).default}});var g=t("./graphics/Graphics");Object.defineProperty(i,"Graphics",{enumerable:!0,get:function(){return o(g).default}});var b=t("./graphics/GraphicsData");Object.defineProperty(i,"GraphicsData",{enumerable:!0,get:function(){return o(b).default}});var w=t("./graphics/webgl/GraphicsRenderer");Object.defineProperty(i,"GraphicsRenderer",{enumerable:!0,get:function(){return o(w).default}});var S=t("./graphics/canvas/CanvasGraphicsRenderer");Object.defineProperty(i,"CanvasGraphicsRenderer",{enumerable:!0,get:function(){return o(S).default}});var C=t("./textures/Spritesheet");Object.defineProperty(i,"Spritesheet",{enumerable:!0,get:function(){return o(C).default}});var D=t("./textures/Texture");Object.defineProperty(i,"Texture",{enumerable:!0,get:function(){return o(D).default}});var T=t("./textures/BaseTexture");Object.defineProperty(i,"BaseTexture",{enumerable:!0,get:function(){return o(T).default}});var A=t("./textures/RenderTexture");Object.defineProperty(i,"RenderTexture",{enumerable:!0,get:function(){return o(A).default}});var B=t("./textures/BaseRenderTexture");Object.defineProperty(i,"BaseRenderTexture",{enumerable:!0,get:function(){return o(B).default}});var M=t("./textures/VideoBaseTexture");Object.defineProperty(i,"VideoBaseTexture",{enumerable:!0,get:function(){return o(M).default}});var E=t("./textures/TextureUvs");Object.defineProperty(i,"TextureUvs",{enumerable:!0,get:function(){return o(E).default}});var P=t("./renderers/canvas/utils/CanvasRenderTarget");Object.defineProperty(i,"CanvasRenderTarget",{enumerable:!0,get:function(){return o(P).default}});var I=t("./Shader");Object.defineProperty(i,"Shader",{enumerable:!0,get:function(){return o(I).default}});var O=t("./renderers/webgl/managers/WebGLManager");Object.defineProperty(i,"WebGLManager",{enumerable:!0,get:function(){return o(O).default}});var R=t("./renderers/webgl/utils/ObjectRenderer");Object.defineProperty(i,"ObjectRenderer",{enumerable:!0,get:function(){return o(R).default}});var L=t("./renderers/webgl/utils/RenderTarget");Object.defineProperty(i,"RenderTarget",{enumerable:!0,get:function(){return o(L).default}});var F=t("./renderers/webgl/utils/Quad");Object.defineProperty(i,"Quad",{enumerable:!0,get:function(){return o(F).default}});var V=t("./renderers/webgl/filters/spriteMask/SpriteMaskFilter");Object.defineProperty(i,"SpriteMaskFilter",{enumerable:!0,get:function(){return o(V).default}});var k=t("./renderers/webgl/filters/Filter");Object.defineProperty(i,"Filter",{enumerable:!0,get:function(){return o(k).default}});var G=t("./Application");Object.defineProperty(i,"Application",{enumerable:!0,get:function(){return o(G).default}});var N=t("./autoDetectRenderer");Object.defineProperty(i,"autoDetectRenderer",{enumerable:!0,get:function(){return N.autoDetectRenderer}});var j=t("./utils"),U=n(j),X=t("./ticker"),J=n(X),W=t("./settings"),z=o(W),H=t("./renderers/canvas/CanvasRenderer"),q=o(H),Y=t("./renderers/webgl/WebGLRenderer"),K=o(Y);i.settings=z.default,i.utils=U,i.ticker=J,i.CanvasRenderer=q.default,i.WebGLRenderer=K.default},{"./Application":42,"./Shader":43,"./autoDetectRenderer":44,"./const":45,"./display/Bounds":46,"./display/Container":47,"./display/DisplayObject":48,"./display/Transform":49,"./display/TransformBase":50,"./display/TransformStatic":51,"./graphics/Graphics":52,"./graphics/GraphicsData":53,"./graphics/canvas/CanvasGraphicsRenderer":54,"./graphics/webgl/GraphicsRenderer":56,"./math":69,"./renderers/canvas/CanvasRenderer":76,"./renderers/canvas/utils/CanvasRenderTarget":78,"./renderers/webgl/WebGLRenderer":83,"./renderers/webgl/filters/Filter":85,"./renderers/webgl/filters/spriteMask/SpriteMaskFilter":88,"./renderers/webgl/managers/WebGLManager":92,"./renderers/webgl/utils/ObjectRenderer":93,"./renderers/webgl/utils/Quad":94,"./renderers/webgl/utils/RenderTarget":95,"./settings":100,"./sprites/Sprite":101,"./sprites/canvas/CanvasSpriteRenderer":102,"./sprites/canvas/CanvasTinter":103,"./sprites/webgl/SpriteRenderer":105,"./text/Text":107,"./text/TextStyle":108,"./textures/BaseRenderTexture":109,"./textures/BaseTexture":110,"./textures/RenderTexture":111,"./textures/Spritesheet":112,"./textures/Texture":113,"./textures/TextureUvs":114,"./textures/VideoBaseTexture":115,"./ticker":117,"./utils":121,"pixi-gl-core":12}],65:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){return t<0?-1:t>0?1:0}function r(){for(var t=0;t<16;t++){var e=[];d.push(e);for(var i=0;i<16;i++)for(var n=o(l[t]*l[i]+h[t]*u[i]),r=o(u[t]*l[i]+c[t]*u[i]),s=o(l[t]*h[i]+h[t]*c[i]),f=o(u[t]*h[i]+c[t]*c[i]),m=0;m<16;m++)if(l[m]===n&&u[m]===r&&h[m]===s&&c[m]===f){e.push(m);break}}for(var _=0;_<16;_++){var y=new a.default;y.set(l[_],u[_],h[_],c[_],0,0),p.push(y)}}i.__esModule=!0;var s=t("./Matrix"),a=n(s),l=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],u=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],h=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],c=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],p=[],d=[];r();var f={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return l[t]},uY:function(t){return u[t]},vX:function(t){return h[t]},vY:function(t){return c[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return d[t][e]},sub:function(t,e){return d[t][f.inv(e)]},rotate180:function(t){return 4^t},isSwapWidthHeight:function(t){return 2===(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?f.S:f.N:2*Math.abs(e)<=Math.abs(t)?t>0?f.E:f.W:e>0?t>0?f.SE:f.SW:t>0?f.NE:f.NW},matrixAppendRotationInv:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=p[f.inv(e)];o.tx=i,o.ty=n,t.append(o)}};i.default=f},{"./Matrix":66}],66:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("./Point"),a=n(s),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;o(this,t),this.a=e,this.b=i,this.c=n,this.d=r,this.tx=s,this.ty=a,this.array=null}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,n,o,r){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=o,this.ty=r,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new a.default;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new a.default;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return e.x=this.d*i*n+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*o+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,o=this.c,r=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=o*e-this.d*i,this.d=o*i+this.d*e,this.tx=r*e-this.ty*i,this.ty=r*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,o=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*o,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*o,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this},t.prototype.setTransform=function(t,e,i,n,o,r,s,a,l){var u=Math.sin(s),h=Math.cos(s),c=Math.cos(l),p=Math.sin(l),d=-Math.sin(a),f=Math.cos(a),m=h*o,_=u*o,y=-u*r,x=h*r;return this.a=c*m+p*y,this.b=c*_+p*x,this.c=d*m+f*y,this.d=d*_+f*x,this.tx=t+(i*m+n*y),this.ty=e+(i*_+n*x),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,n=this.c,o=this.d,r=-Math.atan2(-n,o),s=Math.atan2(i,e),a=Math.abs(r+s);return a<1e-5?(t.rotation=s,e<0&&o>=0&&(t.rotation+=t.rotation<=0?Math.PI:-Math.PI),t.skew.x=t.skew.y=0):(t.skew.x=r,t.skew.y=s),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+o*o),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,o=this.tx,r=t*n-e*i;return this.a=n/r,this.b=-e/r,this.c=-i/r,this.d=t/r,this.tx=(i*this.ty-n*o)/r,this.ty=-(t*this.ty-e*o)/r,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r(t,null,[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}();i.default=l},{"./Point":68}],67:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,t),this._x=o,this._y=r,this.cb=e,this.scope=i}return t.prototype.set=function(t,e){var i=t||0,n=e||(0!==e?i:0);this._x===i&&this._y===n||(this._x=i,this._y=n,this.cb.call(this.scope))},t.prototype.copy=function(t){this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope))},o(t,[{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}();i.default=r},{}],68:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.x=e,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copy=function(t){this.set(t.x,t.y)},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},t}();i.default=o},{}],69:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./Point");Object.defineProperty(i,"Point",{enumerable:!0,get:function(){return n(o).default}});var r=t("./ObservablePoint");Object.defineProperty(i,"ObservablePoint",{enumerable:!0,get:function(){return n(r).default}});var s=t("./Matrix");Object.defineProperty(i,"Matrix",{enumerable:!0,get:function(){return n(s).default}});var a=t("./GroupD8");Object.defineProperty(i,"GroupD8",{enumerable:!0,get:function(){return n(a).default}});var l=t("./shapes/Circle");Object.defineProperty(i,"Circle",{enumerable:!0,get:function(){return n(l).default}});var u=t("./shapes/Ellipse");Object.defineProperty(i,"Ellipse",{enumerable:!0,get:function(){return n(u).default}});var h=t("./shapes/Polygon");Object.defineProperty(i,"Polygon",{enumerable:!0,get:function(){return n(h).default}});var c=t("./shapes/Rectangle");Object.defineProperty(i,"Rectangle",{enumerable:!0,get:function(){return n(c).default}});var p=t("./shapes/RoundedRectangle");Object.defineProperty(i,"RoundedRectangle",{enumerable:!0,get:function(){return n(p).default}})},{"./GroupD8":65,"./Matrix":66,"./ObservablePoint":67,"./Point":68,"./shapes/Circle":70,"./shapes/Ellipse":71,"./shapes/Polygon":72,"./shapes/Rectangle":73,"./shapes/RoundedRectangle":74}],70:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("./Rectangle"),s=n(r),a=t("../../const"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o(this,t),this.x=e,this.y=i,this.radius=n,this.type=a.SHAPES.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,n=this.x-t,o=this.y-e;return n*=n,o*=o,n+o<=i},t.prototype.getBounds=function(){return new s.default(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();i.default=l},{"../../const":45,"./Rectangle":73}],71:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("./Rectangle"),s=n(r),a=t("../../const"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;o(this,t),this.x=e,this.y=i,this.width=n,this.height=r,this.type=a.SHAPES.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,i+n<=1},t.prototype.getBounds=function(){return new s.default(this.x-this.width,this.y-this.height,this.width,this.height)},t}();i.default=l},{"../../const":45,"./Rectangle":73}],72:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../Point"),s=n(r),a=t("../../const"),l=function(){function t(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];if(o(this,t),Array.isArray(i[0])&&(i=i[0]),i[0]instanceof s.default){for(var r=[],l=0,u=i.length;l<u;l++)r.push(i[l].x,i[l].y);i=r}this.closed=!0,this.points=i,this.type=a.SHAPES.POLY}return t.prototype.clone=function(){return new t(this.points.slice())},t.prototype.close=function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1])},t.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,o=0,r=n-1;o<n;r=o++){var s=this.points[2*o],a=this.points[2*o+1],l=this.points[2*r],u=this.points[2*r+1],h=a>e!=u>e&&t<(l-s)*((e-a)/(u-a))+s;h&&(i=!i)}return i},t}();i.default=l},{"../../const":45,"../Point":68}],73:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../../const"),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,t),this.x=e,this.y=i,this.width=o,this.height=s,this.type=r.SHAPES.RECT}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},t.prototype.fit=function(t){this.x<t.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=t.x),this.y<t.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=t.y),this.x+this.width>t.x+t.width&&(this.width=t.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>t.y+t.height&&(this.height=t.height-this.y,this.height<0&&(this.height=0))},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=n,this.height=o-n},o(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}();i.default=s},{"../../const":45}],74:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=t("../../const"),r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;n(this,t),this.x=e,this.y=i,this.width=r,this.height=s,this.radius=a,this.type=o.SHAPES.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),n=e-(this.y+this.radius),o=this.radius*this.radius;if(i*i+n*n<=o)return!0;if(i=t-(this.x+this.width-this.radius),i*i+n*n<=o)return!0;if(n=e-(this.y+this.height-this.radius),i*i+n*n<=o)return!0;if(i=t-(this.x+this.radius),i*i+n*n<=o)return!0}return!1},t}();i.default=r},{"../../const":45}],75:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../utils"),u=t("../math"),h=t("../const"),c=t("../settings"),p=n(c),d=t("../display/Container"),f=n(d),m=t("../textures/RenderTexture"),_=n(m),y=t("eventemitter3"),x=n(y),v=new u.Matrix,g=function(t){function e(i,n,s,a){o(this,e);var c=r(this,t.call(this));if((0,l.sayHello)(i),a)for(var d in p.default.RENDER_OPTIONS)"undefined"==typeof a[d]&&(a[d]=p.default.RENDER_OPTIONS[d]);else a=p.default.RENDER_OPTIONS;return c.type=h.RENDERER_TYPE.UNKNOWN,c.screen=new u.Rectangle(0,0,n||800,s||600),c.view=a.view||document.createElement("canvas"),c.resolution=a.resolution||p.default.RESOLUTION,c.transparent=a.transparent,c.autoResize=a.autoResize||!1,c.blendModes=null,c.preserveDrawingBuffer=a.preserveDrawingBuffer,c.clearBeforeRender=a.clearBeforeRender,c.roundPixels=a.roundPixels,c._backgroundColor=0,c._backgroundColorRgba=[0,0,0,0],c._backgroundColorString="#000000",c.backgroundColor=a.backgroundColor||c._backgroundColor,c._tempDisplayObjectParent=new f.default,c._lastObjectRendered=c._tempDisplayObjectParent,c}return s(e,t),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoResize&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,i){var n=t.getLocalBounds(),o=_.default.create(0|n.width,0|n.height,e,i);return v.tx=-n.x,v.ty=-n.y,this.render(t,o,!1,v,!0),o},e.prototype.destroy=function(t){t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=h.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this.backgroundColor=0,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},a(e,[{key:"width",get:function(){return this.view.width}},{key:"height",get:function(){return this.view.height}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=(0,l.hex2string)(t),(0,l.hex2rgb)(t,this._backgroundColorRgba)}}]),e}(x.default);i.default=g},{"../const":45,"../display/Container":47,"../math":69,"../settings":100,"../textures/RenderTexture":111,"../utils":121,eventemitter3:3}],76:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../SystemRenderer"),l=n(a),u=t("./utils/CanvasMaskManager"),h=n(u),c=t("./utils/CanvasRenderTarget"),p=n(c),d=t("./utils/mapCanvasBlendModesToPixi"),f=n(d),m=t("../../utils"),_=t("../../const"),y=t("../../settings"),x=n(y),v=function(t){function e(i,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e);var a=r(this,t.call(this,"Canvas",i,n,s));return a.type=_.RENDERER_TYPE.CANVAS,a.rootContext=a.view.getContext("2d",{alpha:a.transparent}),a.refresh=!0,a.maskManager=new h.default(a),a.smoothProperty="imageSmoothingEnabled",a.rootContext.imageSmoothingEnabled||(a.rootContext.webkitImageSmoothingEnabled?a.smoothProperty="webkitImageSmoothingEnabled":a.rootContext.mozImageSmoothingEnabled?a.smoothProperty="mozImageSmoothingEnabled":a.rootContext.oImageSmoothingEnabled?a.smoothProperty="oImageSmoothingEnabled":a.rootContext.msImageSmoothingEnabled&&(a.smoothProperty="msImageSmoothingEnabled")),a.initPlugins(),a.blendModes=(0,f.default)(),a._activeBlendMode=null,a.context=null,a.renderingToScreen=!1,a.resize(i,n),a}return s(e,t),e.prototype.render=function(t,e,i,n,o){if(this.view){this.renderingToScreen=!e,this.emit("prerender");var r=this.resolution;e?(e=e.baseTexture||e,e._canvasRenderTarget||(e._canvasRenderTarget=new p.default(e.width,e.height,e.resolution),e.source=e._canvasRenderTarget.canvas,e.valid=!0),this.context=e._canvasRenderTarget.context,this.resolution=e._canvasRenderTarget.resolution):this.context=this.rootContext;var s=this.context;if(e||(this._lastObjectRendered=t),!o){var a=t.parent,l=this._tempDisplayObjectParent.transform.worldTransform;n?(n.copy(l),this._tempDisplayObjectParent.transform._worldID=-1):l.identity(),t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=a}s.setTransform(1,0,0,1,0,0),s.globalAlpha=1,s.globalCompositeOperation=this.blendModes[_.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(s.fillStyle="black",s.clear()),(void 0!==i?i:this.clearBeforeRender)&&this.renderingToScreen&&(this.transparent?s.clearRect(0,0,this.width,this.height):(s.fillStyle=this._backgroundColorString,s.fillRect(0,0,this.width,this.height)));var u=this.context;this.context=s,t.renderCanvas(this),this.context=u,this.resolution=r,this.emit("postrender")}},e.prototype.clear=function(t){var e=this.context;t=t||this._backgroundColorString,!this.transparent&&t?(e.fillStyle=t,e.fillRect(0,0,this.width,this.height)):e.clearRect(0,0,this.width,this.height)},e.prototype.setBlendMode=function(t){this._activeBlendMode!==t&&(this._activeBlendMode=t,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){this.destroyPlugins(),t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.smoothProperty&&(this.rootContext[this.smoothProperty]=x.default.SCALE_MODE===_.SCALE_MODES.LINEAR)},e}(l.default);i.default=v,m.pluginTarget.mixin(v)},{"../../const":45,"../../settings":100,"../../utils":121,"../SystemRenderer":75,"./utils/CanvasMaskManager":77,"./utils/CanvasRenderTarget":78,"./utils/mapCanvasBlendModesToPixi":80}],77:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=t("../../../const"),r=function(){function t(e){n(this,t),this.renderer=e}return t.prototype.pushMask=function(t){var e=this.renderer;e.context.save();var i=t.alpha,n=t.transform.worldTransform,o=e.resolution;e.context.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t._texture||(this.renderGraphicsShape(t),e.context.clip()),t.worldAlpha=i},t.prototype.renderGraphicsShape=function(t){var e=this.renderer.context,i=t.graphicsData.length;if(0!==i){e.beginPath();for(var n=0;n<i;n++){var r=t.graphicsData[n],s=r.shape;if(r.type===o.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var l=1;l<a.length/2;l++)e.lineTo(a[2*l],a[2*l+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(r.type===o.SHAPES.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(r.type===o.SHAPES.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(r.type===o.SHAPES.ELIP){var u=2*s.width,h=2*s.height,c=s.x-u/2,p=s.y-h/2,d=.5522848,f=u/2*d,m=h/2*d,_=c+u,y=p+h,x=c+u/2,v=p+h/2;e.moveTo(c,v),e.bezierCurveTo(c,v-m,x-f,p,x,p),e.bezierCurveTo(x+f,p,_,v-m,_,v),e.bezierCurveTo(_,v+m,x+f,y,x,y),e.bezierCurveTo(x-f,y,c,v+m,c,v),e.closePath()}else if(r.type===o.SHAPES.RREC){var g=s.x,b=s.y,w=s.width,S=s.height,C=s.radius,D=Math.min(w,S)/2|0;C=C>D?D:C,e.moveTo(g,b+C),e.lineTo(g,b+S-C),e.quadraticCurveTo(g,b+S,g+C,b+S),e.lineTo(g+w-C,b+S),e.quadraticCurveTo(g+w,b+S,g+w,b+S-C),e.lineTo(g+w,b+C),e.quadraticCurveTo(g+w,b,g+w-C,b),e.lineTo(g+C,b),e.quadraticCurveTo(g,b,g,b+C),e.closePath()}}}},t.prototype.popMask=function(t){t.context.restore()},t.prototype.destroy=function(){},t}();i.default=r},{"../../../const":45}],78:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("../../../settings"),a=n(s),l=function(){function t(e,i,n){o(this,t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||a.default.RESOLUTION,this.resize(e,i)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},r(t,[{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}]),t}();i.default=l},{"../../../settings":100}],79:[function(t,e,i){"use strict";function n(t){var e=document.createElement("canvas");e.width=6,e.height=1;var i=e.getContext("2d");return i.fillStyle=t,i.fillRect(0,0,6,1),e}function o(){if("undefined"==typeof document)return!1;var t=n("#ff00ff"),e=n("#ffff00"),i=document.createElement("canvas");i.width=6,i.height=1;var o=i.getContext("2d");o.globalCompositeOperation="multiply",o.drawImage(t,0,0),o.drawImage(e,2,0);var r=o.getImageData(2,0,1,1);if(!r)return!1;var s=r.data;return 255===s[0]&&0===s[1]&&0===s[2]}i.__esModule=!0,i.default=o},{}],80:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,a.default)()?(t[r.BLEND_MODES.NORMAL]="source-over",t[r.BLEND_MODES.ADD]="lighter",t[r.BLEND_MODES.MULTIPLY]="multiply",t[r.BLEND_MODES.SCREEN]="screen",t[r.BLEND_MODES.OVERLAY]="overlay",t[r.BLEND_MODES.DARKEN]="darken",t[r.BLEND_MODES.LIGHTEN]="lighten",t[r.BLEND_MODES.COLOR_DODGE]="color-dodge",t[r.BLEND_MODES.COLOR_BURN]="color-burn",t[r.BLEND_MODES.HARD_LIGHT]="hard-light",t[r.BLEND_MODES.SOFT_LIGHT]="soft-light",t[r.BLEND_MODES.DIFFERENCE]="difference",t[r.BLEND_MODES.EXCLUSION]="exclusion",t[r.BLEND_MODES.HUE]="hue",t[r.BLEND_MODES.SATURATION]="saturate",t[r.BLEND_MODES.COLOR]="color",t[r.BLEND_MODES.LUMINOSITY]="luminosity"):(t[r.BLEND_MODES.NORMAL]="source-over",t[r.BLEND_MODES.ADD]="lighter",t[r.BLEND_MODES.MULTIPLY]="source-over",t[r.BLEND_MODES.SCREEN]="source-over",t[r.BLEND_MODES.OVERLAY]="source-over",t[r.BLEND_MODES.DARKEN]="source-over",t[r.BLEND_MODES.LIGHTEN]="source-over",t[r.BLEND_MODES.COLOR_DODGE]="source-over",t[r.BLEND_MODES.COLOR_BURN]="source-over",t[r.BLEND_MODES.HARD_LIGHT]="source-over",t[r.BLEND_MODES.SOFT_LIGHT]="source-over",t[r.BLEND_MODES.DIFFERENCE]="source-over",t[r.BLEND_MODES.EXCLUSION]="source-over",t[r.BLEND_MODES.HUE]="source-over",t[r.BLEND_MODES.SATURATION]="source-over",
t[r.BLEND_MODES.COLOR]="source-over",t[r.BLEND_MODES.LUMINOSITY]="source-over"),t}i.__esModule=!0,i.default=o;var r=t("../../../const"),s=t("./canUseNewCanvasBlendModes"),a=n(s)},{"../../../const":45,"./canUseNewCanvasBlendModes":79}],81:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../const"),s=t("../../settings"),a=n(s),l=function(){function t(e){o(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=a.default.GC_MAX_IDLE,this.checkCountMax=a.default.GC_MAX_CHECK_COUNT,this.mode=a.default.GC_MODE}return t.prototype.update=function(){this.count++,this.mode!==r.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},t.prototype.run=function(){for(var t=this.renderer.textureManager,e=t._managedTextures,i=!1,n=0;n<e.length;n++){var o=e[n];!o._glRenderTargets&&this.count-o.touched>this.maxIdle&&(t.destroyTexture(o,!0),e[n]=null,i=!0)}if(i){for(var r=0,s=0;s<e.length;s++)null!==e[s]&&(e[r++]=e[s]);e.length=r}},t.prototype.unload=function(t){var e=this.renderer.textureManager;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture,!0);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t}();i.default=l},{"../../const":45,"../../settings":100}],82:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("pixi-gl-core"),s=t("../../const"),a=t("./utils/RenderTarget"),l=n(a),u=t("../../utils"),h=function(){function t(e){o(this,t),this.renderer=e,this.gl=e.gl,this._managedTextures=[]}return t.prototype.bindTexture=function(){},t.prototype.getTexture=function(){},t.prototype.updateTexture=function(t,e){var i=this.gl,n=!!t._glRenderTargets;if(!t.hasLoaded)return null;var o=this.renderer.boundTextures;if(void 0===e){e=0;for(var a=0;a<o.length;++a)if(o[a]===t){e=a;break}}o[e]=t,i.activeTexture(i.TEXTURE0+e);var u=t._glTextures[this.renderer.CONTEXT_UID];if(u)n?t._glRenderTargets[this.renderer.CONTEXT_UID].resize(t.width,t.height):u.upload(t.source);else{if(n){var h=new l.default(this.gl,t.width,t.height,t.scaleMode,t.resolution);h.resize(t.width,t.height),t._glRenderTargets[this.renderer.CONTEXT_UID]=h,u=h.texture}else u=new r.GLTexture(this.gl,null,null,null,null),u.bind(e),u.premultiplyAlpha=!0,u.upload(t.source);t._glTextures[this.renderer.CONTEXT_UID]=u,t.on("update",this.updateTexture,this),t.on("dispose",this.destroyTexture,this),this._managedTextures.push(t),t.isPowerOfTwo?(t.mipmap&&u.enableMipmap(),t.wrapMode===s.WRAP_MODES.CLAMP?u.enableWrapClamp():t.wrapMode===s.WRAP_MODES.REPEAT?u.enableWrapRepeat():u.enableWrapMirrorRepeat()):u.enableWrapClamp(),t.scaleMode===s.SCALE_MODES.NEAREST?u.enableNearestScaling():u.enableLinearScaling()}return u},t.prototype.destroyTexture=function(t,e){if(t=t.baseTexture||t,t.hasLoaded&&t._glTextures[this.renderer.CONTEXT_UID]&&(this.renderer.unbindTexture(t),t._glTextures[this.renderer.CONTEXT_UID].destroy(),t.off("update",this.updateTexture,this),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.renderer.CONTEXT_UID],!e)){var i=this._managedTextures.indexOf(t);i!==-1&&(0,u.removeItems)(this._managedTextures,i,1)}},t.prototype.removeAll=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];e._glTextures[this.renderer.CONTEXT_UID]&&delete e._glTextures[this.renderer.CONTEXT_UID]}},t.prototype.destroy=function(){for(var t=0;t<this._managedTextures.length;++t){var e=this._managedTextures[t];this.destroyTexture(e,!0),e.off("update",this.updateTexture,this),e.off("dispose",this.destroyTexture,this)}this._managedTextures=null},t}();i.default=h},{"../../const":45,"../../utils":121,"./utils/RenderTarget":95,"pixi-gl-core":12}],83:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../SystemRenderer"),l=n(a),u=t("./managers/MaskManager"),h=n(u),c=t("./managers/StencilManager"),p=n(c),d=t("./managers/FilterManager"),f=n(d),m=t("./utils/RenderTarget"),_=n(m),y=t("./utils/ObjectRenderer"),x=n(y),v=t("./TextureManager"),g=n(v),b=t("../../textures/BaseTexture"),w=n(b),S=t("./TextureGarbageCollector"),C=n(S),D=t("./WebGLState"),T=n(D),A=t("./utils/mapWebGLDrawModesToPixi"),B=n(A),M=t("./utils/validateContext"),E=n(M),P=t("../../utils"),I=t("pixi-gl-core"),O=n(I),R=t("../../const"),L=0,F=function(t){function e(i,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e);var a=r(this,t.call(this,"WebGL",i,n,s));return a.legacy=!!s.legacy,a.legacy&&(O.default.VertexArrayObject.FORCE_NATIVE=!0),a.type=R.RENDERER_TYPE.WEBGL,a.handleContextLost=a.handleContextLost.bind(a),a.handleContextRestored=a.handleContextRestored.bind(a),a.view.addEventListener("webglcontextlost",a.handleContextLost,!1),a.view.addEventListener("webglcontextrestored",a.handleContextRestored,!1),a._contextOptions={alpha:a.transparent,antialias:s.antialias,premultipliedAlpha:a.transparent&&"notMultiplied"!==a.transparent,stencil:!0,preserveDrawingBuffer:s.preserveDrawingBuffer},a._backgroundColorRgba[3]=a.transparent?0:1,a.maskManager=new h.default(a),a.stencilManager=new p.default(a),a.emptyRenderer=new x.default(a),a.currentRenderer=a.emptyRenderer,a.initPlugins(),s.context&&(0,E.default)(s.context),a.gl=s.context||O.default.createContext(a.view,a._contextOptions),a.CONTEXT_UID=L++,a.state=new T.default(a.gl),a.renderingToScreen=!0,a.boundTextures=null,a._activeShader=null,a._activeVao=null,a._activeRenderTarget=null,a._initContext(),a.filterManager=new f.default(a),a.drawModes=(0,B.default)(a.gl),a._nextTextureLocation=0,a.setBlendMode(0),a}return s(e,t),e.prototype._initContext=function(){var t=this.gl;t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures=new Array(e),this.emptyTextures=new Array(e),this.textureManager=new g.default(this),this.textureGC=new C.default(this),this.state.resetToDefault(),this.rootRenderTarget=new _.default(t,this.width,this.height,null,this.resolution,!0),this.rootRenderTarget.clearColor=this._backgroundColorRgba,this.bindRenderTarget(this.rootRenderTarget);var i=new O.default.GLTexture.fromData(t,null,1,1),n={_glTextures:{}};n._glTextures[this.CONTEXT_UID]={};for(var o=0;o<e;o++){var r=new w.default;r._glTextures[this.CONTEXT_UID]=i,this.boundTextures[o]=n,this.emptyTextures[o]=r,this.bindTexture(null,o)}this.emit("context",t),this.resize(this.screen.width,this.screen.height)},e.prototype.render=function(t,e,i,n,o){if(this.renderingToScreen=!e,this.emit("prerender"),this.gl&&!this.gl.isContextLost()){if(this._nextTextureLocation=0,e||(this._lastObjectRendered=t),!o){var r=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=r}this.bindRenderTexture(e,n),this.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this._activeRenderTarget.clear(),t.renderWebGL(this),this.currentRenderer.flush(),this.textureGC.update(),this.emit("postrender")}},e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.resize=function(t,e){l.default.prototype.resize.call(this,t,e),this.rootRenderTarget.resize(t,e),this._activeRenderTarget===this.rootRenderTarget&&(this.rootRenderTarget.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=this.rootRenderTarget.projectionMatrix.toArray(!0)))},e.prototype.setBlendMode=function(t){this.state.setBlendMode(t)},e.prototype.clear=function(t){this._activeRenderTarget.clear(t)},e.prototype.setTransform=function(t){this._activeRenderTarget.transform=t},e.prototype.clearRenderTexture=function(t,e){var i=t.baseTexture,n=i._glRenderTargets[this.CONTEXT_UID];return n&&n.clear(e),this},e.prototype.bindRenderTexture=function(t,e){var i=void 0;if(t){var n=t.baseTexture;n._glRenderTargets[this.CONTEXT_UID]||this.textureManager.updateTexture(n,0),this.unbindTexture(n),i=n._glRenderTargets[this.CONTEXT_UID],i.setFrame(t.frame)}else i=this.rootRenderTarget;return i.transform=e,this.bindRenderTarget(i),this},e.prototype.bindRenderTarget=function(t){return t!==this._activeRenderTarget&&(this._activeRenderTarget=t,t.activate(),this._activeShader&&(this._activeShader.uniforms.projectionMatrix=t.projectionMatrix.toArray(!0)),this.stencilManager.setMaskStack(t.stencilMaskStack)),this},e.prototype.bindShader=function(t,e){return this._activeShader!==t&&(this._activeShader=t,t.bind(),e!==!1&&(t.uniforms.projectionMatrix=this._activeRenderTarget.projectionMatrix.toArray(!0))),this},e.prototype.bindTexture=function(t,e,i){if(t=t||this.emptyTextures[e],t=t.baseTexture||t,t.touched=this.textureGC.count,i)e=e||0;else{for(var n=0;n<this.boundTextures.length;n++)if(this.boundTextures[n]===t)return n;void 0===e&&(this._nextTextureLocation++,this._nextTextureLocation%=this.boundTextures.length,e=this.boundTextures.length-this._nextTextureLocation-1)}var o=this.gl,r=t._glTextures[this.CONTEXT_UID];return r?(this.boundTextures[e]=t,o.activeTexture(o.TEXTURE0+e),o.bindTexture(o.TEXTURE_2D,r.texture)):this.textureManager.updateTexture(t,e),e},e.prototype.unbindTexture=function(t){var e=this.gl;t=t.baseTexture||t;for(var i=0;i<this.boundTextures.length;i++)this.boundTextures[i]===t&&(this.boundTextures[i]=this.emptyTextures[i],e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[i]._glTextures[this.CONTEXT_UID].texture));return this},e.prototype.createVao=function(){return new O.default.VertexArrayObject(this.gl,this.state.attribState)},e.prototype.bindVao=function(t){return this._activeVao===t?this:(t?t.bind():this._activeVao&&this._activeVao.unbind(),this._activeVao=t,this)},e.prototype.reset=function(){return this.setObjectRenderer(this.emptyRenderer),this._activeShader=null,this._activeRenderTarget=this.rootRenderTarget,this.rootRenderTarget.activate(),this.state.resetToDefault(),this},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this._initContext(),this.textureManager.removeAll()},e.prototype.destroy=function(e){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),this.textureManager.destroy(),t.prototype.destroy.call(this,e),this.uid=0,this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.maskManager=null,this.filterManager=null,this.textureManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.gl.useProgram(null),this.gl.getExtension("WEBGL_lose_context")&&this.gl.getExtension("WEBGL_lose_context").loseContext(),this.gl=null},e}(l.default);i.default=F,P.pluginTarget.mixin(F)},{"../../const":45,"../../textures/BaseTexture":110,"../../utils":121,"../SystemRenderer":75,"./TextureGarbageCollector":81,"./TextureManager":82,"./WebGLState":84,"./managers/FilterManager":89,"./managers/MaskManager":90,"./managers/StencilManager":91,"./utils/ObjectRenderer":93,"./utils/RenderTarget":95,"./utils/mapWebGLDrawModesToPixi":98,"./utils/validateContext":99,"pixi-gl-core":12}],84:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("./utils/mapWebGLBlendModesToPixi"),s=n(r),a=0,l=1,u=2,h=3,c=4,p=function(){function t(e){o(this,t),this.activeState=new Uint8Array(16),this.defaultState=new Uint8Array(16),this.defaultState[0]=1,this.stackIndex=0,this.stack=[],this.gl=e,this.maxAttribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.attribState={tempAttribState:new Array(this.maxAttribs),attribState:new Array(this.maxAttribs)},this.blendModes=(0,s.default)(e),this.nativeVaoExtension=e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object")}return t.prototype.push=function(){var t=this.stack[this.stackIndex];t||(t=this.stack[this.stackIndex]=new Uint8Array(16)),++this.stackIndex;for(var e=0;e<this.activeState.length;e++)t[e]=this.activeState[e]},t.prototype.pop=function(){var t=this.stack[--this.stackIndex];this.setState(t)},t.prototype.setState=function(t){this.setBlend(t[a]),this.setDepthTest(t[l]),this.setFrontFace(t[u]),this.setCullFace(t[h]),this.setBlendMode(t[c])},t.prototype.setBlend=function(t){t=t?1:0,this.activeState[a]!==t&&(this.activeState[a]=t,this.gl[t?"enable":"disable"](this.gl.BLEND))},t.prototype.setBlendMode=function(t){t!==this.activeState[c]&&(this.activeState[c]=t,this.gl.blendFunc(this.blendModes[t][0],this.blendModes[t][1]))},t.prototype.setDepthTest=function(t){t=t?1:0,this.activeState[l]!==t&&(this.activeState[l]=t,this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST))},t.prototype.setCullFace=function(t){t=t?1:0,this.activeState[h]!==t&&(this.activeState[h]=t,this.gl[t?"enable":"disable"](this.gl.CULL_FACE))},t.prototype.setFrontFace=function(t){t=t?1:0,this.activeState[u]!==t&&(this.activeState[u]=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))},t.prototype.resetAttributes=function(){for(var t=0;t<this.attribState.tempAttribState.length;t++)this.attribState.tempAttribState[t]=0;for(var e=0;e<this.attribState.attribState.length;e++)this.attribState.attribState[e]=0;for(var i=1;i<this.maxAttribs;i++)this.gl.disableVertexAttribArray(i)},t.prototype.resetToDefault=function(){this.nativeVaoExtension&&this.nativeVaoExtension.bindVertexArrayOES(null),this.resetAttributes();for(var t=0;t<this.activeState.length;++t)this.activeState[t]=32;this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.setState(this.defaultState)},t}();i.default=p},{"./utils/mapWebGLBlendModesToPixi":97}],85:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("./extractUniformsFromSrc"),a=n(s),l=t("../../../utils"),u=t("../../../const"),h=t("../../../settings"),c=n(h),p={},d=function(){function t(e,i,n){o(this,t),this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this.blendMode=u.BLEND_MODES.NORMAL,this.uniformData=n||(0,a.default)(this.vertexSrc,this.fragmentSrc,"projectionMatrix|uSampler"),this.uniforms={};for(var r in this.uniformData)this.uniforms[r]=this.uniformData[r].value;this.glShaders={},p[this.vertexSrc+this.fragmentSrc]||(p[this.vertexSrc+this.fragmentSrc]=(0,l.uid)()),this.glShaderKey=p[this.vertexSrc+this.fragmentSrc],this.padding=4,this.resolution=c.default.RESOLUTION,this.enabled=!0}return t.prototype.apply=function(t,e,i,n,o){t.applyFilter(this,e,i,n)},r(t,null,[{key:"defaultVertexSrc",get:function(){return["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 projectionMatrix;","uniform mat3 filterMatrix;","varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;","   vTextureCoord = aTextureCoord ;","}"].join("\n")}},{key:"defaultFragmentSrc",get:function(){return["varying vec2 vTextureCoord;","varying vec2 vFilterCoord;","uniform sampler2D uSampler;","uniform sampler2D filterSampler;","void main(void){","   vec4 masky = texture2D(filterSampler, vFilterCoord);","   vec4 sample = texture2D(uSampler, vTextureCoord);","   vec4 color;","   if(mod(vFilterCoord.x, 1.0) > 0.5)","   {","     color = vec4(1.0, 0.0, 0.0, 1.0);","   }","   else","   {","     color = vec4(0.0, 1.0, 0.0, 1.0);","   }","   gl_FragColor = mix(sample, masky, 0.5);","   gl_FragColor *= sample.a;","}"].join("\n")}}]),t}();i.default=d},{"../../../const":45,"../../../settings":100,"../../../utils":121,"./extractUniformsFromSrc":86}],86:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,i){var n=r(t,i),o=r(e,i);return Object.assign(n,o)}function r(t){for(var e=new RegExp("^(projectionMatrix|uSampler|filterArea|filterClamp)$"),i={},n=void 0,o=t.replace(/\s+/g," ").split(/\s*;\s*/),r=0;r<o.length;r++){var s=o[r].trim();if(s.indexOf("uniform")>-1){var a=s.split(" "),u=a[1],h=a[2],c=1;h.indexOf("[")>-1&&(n=h.split(/\[|]/),h=n[0],c*=Number(n[1])),h.match(e)||(i[h]={value:l(u,c),name:h,type:u})}}return i}i.__esModule=!0,i.default=o;var s=t("pixi-gl-core"),a=n(s),l=a.default.shader.defaultValue},{"pixi-gl-core":12}],87:[function(t,e,i){"use strict";function n(t,e,i){var n=t.identity();return n.translate(e.x/i.width,e.y/i.height),n.scale(i.width,i.height),n}function o(t,e,i){var n=t.identity();n.translate(e.x/i.width,e.y/i.height);var o=i.width/e.width,r=i.height/e.height;return n.scale(o,r),n}function r(t,e,i,n){var o=n.worldTransform.copy(s.Matrix.TEMP_MATRIX),r=n._texture.baseTexture,a=t.identity(),l=i.height/i.width;a.translate(e.x/i.width,e.y/i.height),a.scale(1,l);var u=i.width/r.width,h=i.height/r.height;return o.tx/=r.width*u,o.ty/=r.width*u,o.invert(),a.prepend(o),a.scale(1,1/l),a.scale(u,h),a.translate(n.anchor.x,n.anchor.y),a}i.__esModule=!0,i.calculateScreenSpaceMatrix=n,i.calculateNormalizedScreenSpaceMatrix=o,i.calculateSpriteMatrix=r;var s=t("../../../math")},{"../../../math":69}],88:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../Filter"),l=n(a),u=t("../../../../math"),h=(t("path"),function(t){function e(i){o(this,e);var n=new u.Matrix,s=r(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n\n    original *= (masky.r * masky.a * alpha * clip);\n\n    gl_FragColor = original;\n}\n"));return i.renderable=!1,s.maskSprite=i,s.maskMatrix=n,s}return s(e,t),e.prototype.apply=function(t,e,i){var n=this.maskSprite;this.uniforms.mask=n._texture,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n),this.uniforms.alpha=n.worldAlpha,t.applyFilter(this,e,i)},e}(l.default));i.default=h},{"../../../../math":69,"../Filter":85,path:23}],89:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var l=t("./WebGLManager"),u=o(l),h=t("../utils/RenderTarget"),c=o(h),p=t("../utils/Quad"),d=o(p),f=t("../../../math"),m=t("../../../Shader"),_=o(m),y=t("../filters/filterTransforms"),x=n(y),v=t("bit-twiddle"),g=o(v),b=function t(){a(this,t),this.renderTarget=null,this.sourceFrame=new f.Rectangle,this.destinationFrame=new f.Rectangle,this.filters=[],this.target=null,this.resolution=1},w=function(t){function e(i){a(this,e);var n=r(this,t.call(this,i));return n.gl=n.renderer.gl,n.quad=new d.default(n.gl,i.state.attribState),n.shaderCache={},n.pool={},n.filterData=null,n}return s(e,t),e.prototype.pushFilter=function(t,e){var i=this.renderer,n=this.filterData;if(!n){n=this.renderer._activeRenderTarget.filterStack;var o=new b;o.sourceFrame=o.destinationFrame=this.renderer._activeRenderTarget.size,o.renderTarget=i._activeRenderTarget,this.renderer._activeRenderTarget.filterData=n={index:0,stack:[o]},this.filterData=n}var r=n.stack[++n.index];r||(r=n.stack[n.index]=new b);var s=e[0].resolution,a=0|e[0].padding,l=t.filterArea||t.getBounds(!0),u=r.sourceFrame,h=r.destinationFrame;u.x=(l.x*s|0)/s,u.y=(l.y*s|0)/s,u.width=(l.width*s|0)/s,u.height=(l.height*s|0)/s,n.stack[0].renderTarget.transform||u.fit(n.stack[0].destinationFrame),u.pad(a),h.width=u.width,h.height=u.height;var c=this.getPotRenderTarget(i.gl,u.width,u.height,s);r.target=t,r.filters=e,r.resolution=s,r.renderTarget=c,c.setFrame(h,u),i.bindRenderTarget(c),c.clear()},e.prototype.popFilter=function(){var t=this.filterData,e=t.stack[t.index-1],i=t.stack[t.index];this.quad.map(i.renderTarget.size,i.sourceFrame).upload();var n=i.filters;if(1===n.length)n[0].apply(this,i.renderTarget,e.renderTarget,!1,i),this.freePotRenderTarget(i.renderTarget);else{var o=i.renderTarget,r=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,i.resolution);r.setFrame(i.destinationFrame,i.sourceFrame),r.clear();var s=0;for(s=0;s<n.length-1;++s){n[s].apply(this,o,r,!0,i);var a=o;o=r,r=a}n[s].apply(this,o,e.renderTarget,!1,i),this.freePotRenderTarget(o),this.freePotRenderTarget(r)}t.index--,0===t.index&&(this.filterData=null)},e.prototype.applyFilter=function(t,e,i,n){var o=this.renderer,r=o.gl,s=t.glShaders[o.CONTEXT_UID];s||(t.glShaderKey?(s=this.shaderCache[t.glShaderKey],s||(s=new _.default(this.gl,t.vertexSrc,t.fragmentSrc),t.glShaders[o.CONTEXT_UID]=this.shaderCache[t.glShaderKey]=s)):s=t.glShaders[o.CONTEXT_UID]=new _.default(this.gl,t.vertexSrc,t.fragmentSrc),o.bindVao(null),this.quad.initVao(s)),o.bindVao(this.quad.vao),o.bindRenderTarget(i),n&&(r.disable(r.SCISSOR_TEST),o.clear(),r.enable(r.SCISSOR_TEST)),i===o.maskManager.scissorRenderTarget&&o.maskManager.pushScissorMask(null,o.maskManager.scissorData),o.bindShader(s);var a=this.renderer.emptyTextures[0];this.renderer.boundTextures[0]=a,this.syncUniforms(s,t),o.state.setBlendMode(t.blendMode),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,e.texture.texture),this.quad.vao.draw(this.renderer.gl.TRIANGLES,6,0),r.bindTexture(r.TEXTURE_2D,a._glTextures[this.renderer.CONTEXT_UID].texture)},e.prototype.syncUniforms=function(t,e){var i=e.uniformData,n=e.uniforms,o=1,r=void 0;if(t.uniforms.filterArea){r=this.filterData.stack[this.filterData.index];var s=t.uniforms.filterArea;s[0]=r.renderTarget.size.width,s[1]=r.renderTarget.size.height,s[2]=r.sourceFrame.x,s[3]=r.sourceFrame.y,t.uniforms.filterArea=s}if(t.uniforms.filterClamp){r=r||this.filterData.stack[this.filterData.index];var a=t.uniforms.filterClamp;a[0]=0,a[1]=0,a[2]=(r.sourceFrame.width-1)/r.renderTarget.size.width,a[3]=(r.sourceFrame.height-1)/r.renderTarget.size.height,t.uniforms.filterClamp=a}for(var l in i)if("sampler2D"===i[l].type&&0!==n[l]){if(n[l].baseTexture)t.uniforms[l]=this.renderer.bindTexture(n[l].baseTexture,o);else{t.uniforms[l]=o;var u=this.renderer.gl;this.renderer.boundTextures[o]=this.renderer.emptyTextures[o],u.activeTexture(u.TEXTURE0+o),n[l].texture.bind()}o++}else if("mat3"===i[l].type)void 0!==n[l].a?t.uniforms[l]=n[l].toArray(!0):t.uniforms[l]=n[l];else if("vec2"===i[l].type)if(void 0!==n[l].x){var h=t.uniforms[l]||new Float32Array(2);h[0]=n[l].x,h[1]=n[l].y,t.uniforms[l]=h}else t.uniforms[l]=n[l];else"float"===i[l].type?t.uniforms.data[l].value!==i[l]&&(t.uniforms[l]=n[l]):t.uniforms[l]=n[l]},e.prototype.getRenderTarget=function(t,e){var i=this.filterData.stack[this.filterData.index],n=this.getPotRenderTarget(this.renderer.gl,i.sourceFrame.width,i.sourceFrame.height,e||i.resolution);return n.setFrame(i.destinationFrame,i.sourceFrame),n},e.prototype.returnRenderTarget=function(t){this.freePotRenderTarget(t)},e.prototype.calculateScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return x.calculateScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size)},e.prototype.calculateNormalizedScreenSpaceMatrix=function(t){var e=this.filterData.stack[this.filterData.index];return x.calculateNormalizedScreenSpaceMatrix(t,e.sourceFrame,e.renderTarget.size,e.destinationFrame)},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.filterData.stack[this.filterData.index];return x.calculateSpriteMatrix(t,i.sourceFrame,i.renderTarget.size,e)},e.prototype.destroy=function(){this.shaderCache={},this.emptyPool()},e.prototype.getPotRenderTarget=function(t,e,i,n){e=g.default.nextPow2(e*n),i=g.default.nextPow2(i*n);var o=(65535&e)<<16|65535&i;this.pool[o]||(this.pool[o]=[]);var r=this.pool[o].pop();if(!r){var s=this.renderer.boundTextures[0];t.activeTexture(t.TEXTURE0),r=new c.default(t,e,i,null,1),t.bindTexture(t.TEXTURE_2D,s._glTextures[this.renderer.CONTEXT_UID].texture)}return r.resolution=n,r.defaultFrame.width=r.size.width=e/n,r.defaultFrame.height=r.size.height=i/n,r},e.prototype.emptyPool=function(){for(var t in this.pool){var e=this.pool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.pool={}},e.prototype.freePotRenderTarget=function(t){var e=t.size.width*t.resolution,i=t.size.height*t.resolution,n=(65535&e)<<16|65535&i;this.pool[n].push(t)},e}(u.default);i.default=w},{"../../../Shader":43,"../../../math":69,"../filters/filterTransforms":87,"../utils/Quad":94,"../utils/RenderTarget":95,"./WebGLManager":92,"bit-twiddle":1}],90:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("./WebGLManager"),l=n(a),u=t("../filters/spriteMask/SpriteMaskFilter"),h=n(u),c=function(t){function e(i){o(this,e);var n=r(this,t.call(this,i));return n.scissor=!1,n.scissorData=null,n.scissorRenderTarget=null,n.enableScissor=!0,n.alphaMaskPool=[],n.alphaMaskIndex=0,n}return s(e,t),e.prototype.pushMask=function(t,e){if(e.texture)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencilManager.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,n=Math.atan2(i.b,i.a);n=Math.round(n*(180/Math.PI)),n%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencilManager.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new h.default(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e,t.filterArea=e.getBounds(!0),this.renderer.filterManager.pushFilter(t,i),this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filterManager.popFilter(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.currentRenderer.stop(),this.renderer.stencilManager.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,n=e.getBounds();n.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var o=this.renderer.resolution;this.renderer.gl.scissor(n.x*o,(i.root?i.size.height-n.y-n.height:n.y)*o,n.width*o,n.height*o),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(l.default);i.default=c},{"../filters/spriteMask/SpriteMaskFilter":88,"./WebGLManager":92}],91:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("./WebGLManager"),l=n(a),u=function(t){function e(i){o(this,e);var n=r(this,t.call(this,i));return n.stencilMaskStack=null,n}return s(e,t),e.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},e.prototype.pushStencil=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.renderer._activeRenderTarget.attachStencilBuffer();var e=this.renderer.gl,i=this.stencilMaskStack;0===i.length&&(e.enable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.stencilFunc(e.ALWAYS,1,1)),i.push(t),e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.INCR),this.renderer.plugins.graphics.render(t),e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.NOTEQUAL,0,i.length),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},e.prototype.popStencil=function(){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);
var t=this.renderer.gl,e=this.stencilMaskStack,i=e.pop();0===e.length?t.disable(t.STENCIL_TEST):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),this.renderer.plugins.graphics.render(i),t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.NOTEQUAL,0,e.length),t.stencilOp(t.KEEP,t.KEEP,t.KEEP))},e.prototype.destroy=function(){l.default.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},e}(l.default);i.default=u},{"./WebGLManager":92}],92:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(e){n(this,t),this.renderer=e,this.renderer.on("context",this.onContextChange,this)}return t.prototype.onContextChange=function(){},t.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null},t}();i.default=o},{}],93:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../managers/WebGLManager"),l=n(a),u=function(t){function e(){return o(this,e),r(this,t.apply(this,arguments))}return s(e,t),e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(l.default);i.default=u},{"../managers/WebGLManager":92}],94:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("pixi-gl-core"),s=n(r),a=t("../../../utils/createIndicesForQuads"),l=n(a),u=function(){function t(e,i){o(this,t),this.gl=e,this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.interleaved=new Float32Array(16);for(var n=0;n<4;n++)this.interleaved[4*n]=this.vertices[2*n],this.interleaved[4*n+1]=this.vertices[2*n+1],this.interleaved[4*n+2]=this.uvs[2*n],this.interleaved[4*n+3]=this.uvs[2*n+1];this.indices=(0,l.default)(1),this.vertexBuffer=s.default.GLBuffer.createVertexBuffer(e,this.interleaved,e.STATIC_DRAW),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(e,this.indices,e.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(e,i)}return t.prototype.initVao=function(t){this.vao.clear().addIndex(this.indexBuffer).addAttribute(this.vertexBuffer,t.attributes.aVertexPosition,this.gl.FLOAT,!1,16,0).addAttribute(this.vertexBuffer,t.attributes.aTextureCoord,this.gl.FLOAT,!1,16,8)},t.prototype.map=function(t,e){var i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this},t.prototype.upload=function(){for(var t=0;t<4;t++)this.interleaved[4*t]=this.vertices[2*t],this.interleaved[4*t+1]=this.vertices[2*t+1],this.interleaved[4*t+2]=this.uvs[2*t],this.interleaved[4*t+3]=this.uvs[2*t+1];return this.vertexBuffer.upload(this.interleaved),this},t.prototype.destroy=function(){var t=this.gl;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)},t}();i.default=u},{"../../../utils/createIndicesForQuads":119,"pixi-gl-core":12}],95:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../../math"),s=t("../../../const"),a=t("../../../settings"),l=n(a),u=t("pixi-gl-core"),h=function(){function t(e,i,n,a,h,c){o(this,t),this.gl=e,this.frameBuffer=null,this.texture=null,this.clearColor=[0,0,0,0],this.size=new r.Rectangle(0,0,1,1),this.resolution=h||l.default.RESOLUTION,this.projectionMatrix=new r.Matrix,this.transform=null,this.frame=null,this.defaultFrame=new r.Rectangle,this.destinationFrame=null,this.sourceFrame=null,this.stencilBuffer=null,this.stencilMaskStack=[],this.filterData=null,this.scaleMode=void 0!==a?a:l.default.SCALE_MODE,this.root=c,this.root?(this.frameBuffer=new u.GLFramebuffer(e,100,100),this.frameBuffer.framebuffer=null):(this.frameBuffer=u.GLFramebuffer.createRGBA(e,100,100),this.scaleMode===s.SCALE_MODES.NEAREST?this.frameBuffer.texture.enableNearestScaling():this.frameBuffer.texture.enableLinearScaling(),this.texture=this.frameBuffer.texture),this.setFrame(),this.resize(i,n)}return t.prototype.clear=function(t){var e=t||this.clearColor;this.frameBuffer.clear(e[0],e[1],e[2],e[3])},t.prototype.attachStencilBuffer=function(){this.root||this.frameBuffer.enableStencil()},t.prototype.setFrame=function(t,e){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t},t.prototype.activate=function(){var t=this.gl;this.frameBuffer.bind(),this.calculateProjection(this.destinationFrame,this.sourceFrame),this.transform&&this.projectionMatrix.append(this.transform),this.destinationFrame!==this.sourceFrame?(t.enable(t.SCISSOR_TEST),t.scissor(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)):t.disable(t.SCISSOR_TEST),t.viewport(0|this.destinationFrame.x,0|this.destinationFrame.y,this.destinationFrame.width*this.resolution|0,this.destinationFrame.height*this.resolution|0)},t.prototype.calculateProjection=function(t,e){var i=this.projectionMatrix;e=e||t,i.identity(),this.root?(i.a=1/t.width*2,i.d=-1/t.height*2,i.tx=-1-e.x*i.a,i.ty=1-e.y*i.d):(i.a=1/t.width*2,i.d=1/t.height*2,i.tx=-1-e.x*i.a,i.ty=-1-e.y*i.d)},t.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e,this.defaultFrame.width=t,this.defaultFrame.height=e,this.frameBuffer.resize(t*this.resolution,e*this.resolution);var i=this.frame||this.size;this.calculateProjection(i)}},t.prototype.destroy=function(){this.frameBuffer.destroy(),this.frameBuffer=null,this.texture=null},t}();i.default=h},{"../../../const":45,"../../../math":69,"../../../settings":100,"pixi-gl-core":12}],96:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i=!e;if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");if(i){var n=document.createElement("canvas");n.width=1,n.height=1,e=a.default.createContext(n)}for(var o=e.createShader(e.FRAGMENT_SHADER);;){var s=l.replace(/%forloop%/gi,r(t));if(e.shaderSource(o,s),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS))break;t=t/2|0}return i&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),t}function r(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}i.__esModule=!0,i.default=o;var s=t("pixi-gl-core"),a=n(s),l=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n")},{"pixi-gl-core":12}],97:[function(t,e,i){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[o.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.ADD]=[t.ONE,t.DST_ALPHA],e[o.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR],e[o.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[o.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e}i.__esModule=!0,i.default=n;var o=t("../../../const")},{"../../../const":45}],98:[function(t,e,i){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e[o.DRAW_MODES.POINTS]=t.POINTS,e[o.DRAW_MODES.LINES]=t.LINES,e[o.DRAW_MODES.LINE_LOOP]=t.LINE_LOOP,e[o.DRAW_MODES.LINE_STRIP]=t.LINE_STRIP,e[o.DRAW_MODES.TRIANGLES]=t.TRIANGLES,e[o.DRAW_MODES.TRIANGLE_STRIP]=t.TRIANGLE_STRIP,e[o.DRAW_MODES.TRIANGLE_FAN]=t.TRIANGLE_FAN,e}i.__esModule=!0,i.default=n;var o=t("../../../const")},{"../../../const":45}],99:[function(t,e,i){"use strict";function n(t){var e=t.getContextAttributes();e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")}i.__esModule=!0,i.default=n},{}],100:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./utils/maxRecommendedTextures"),r=n(o),s=t("./utils/canUploadSameBuffer"),a=n(s);i.default={TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:(0,r.default)(32),SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@([0-9\.]+)x/,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:"mediump",CAN_UPLOAD_SAME_BUFFER:(0,a.default)()}},{"./utils/canUploadSameBuffer":118,"./utils/maxRecommendedTextures":122}],101:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../math"),u=t("../utils"),h=t("../const"),c=t("../textures/Texture"),p=n(c),d=t("../display/Container"),f=n(d),m=new l.Point,_=function(t){function e(i){o(this,e);var n=r(this,t.call(this));return n._anchor=new l.ObservablePoint(n._onAnchorUpdate,n),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=h.BLEND_MODES.NORMAL,n.shader=null,n.cachedTint=16777215,n.texture=i||p.default.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.pluginName="sprite",n}return s(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._width&&(this.scale.x=(0,u.sign)(this.scale.x)*this._width/this.texture.orig.width),this._height&&(this.scale.y=(0,u.sign)(this.scale.y)*this._height/this.texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID||this._textureID!==this._texture._updateID){this._transformID=this.transform._worldID,this._textureID=this._texture._updateID;var t=this._texture,e=this.transform.worldTransform,i=e.a,n=e.b,o=e.c,r=e.d,s=e.tx,a=e.ty,l=this.vertexData,u=t.trim,h=t.orig,c=this._anchor,p=0,d=0,f=0,m=0;u?(d=u.x-c._x*h.width,p=d+u.width,m=u.y-c._y*h.height,f=m+u.height):(d=-c._x*h.width,p=d+h.width,m=-c._y*h.height,f=m+h.height),l[0]=i*d+o*m+s,l[1]=r*m+n*d+a,l[2]=i*p+o*m+s,l[3]=r*m+n*p+a,l[4]=i*p+o*f+s,l[5]=r*f+n*p+a,l[6]=i*d+o*f+s,l[7]=r*f+n*d+a}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,n=this._anchor,o=this.transform.worldTransform,r=o.a,s=o.b,a=o.c,l=o.d,u=o.tx,h=o.ty,c=-n._x*i.width,p=c+i.width,d=-n._y*i.height,f=d+i.height;e[0]=r*c+a*d+u,e[1]=l*d+s*c+h,e[2]=r*p+a*d+u,e[3]=l*d+s*p+h,e[4]=r*p+a*f+u,e[5]=l*f+s*p+h,e[6]=r*c+a*f+u,e[7]=l*f+s*c+h},e.prototype._renderWebGL=function(t){this.calculateVertices(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._x),e||(this._localBoundsRect||(this._localBoundsRect=new l.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,m);var e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x,o=0;return m.x>n&&m.x<n+e&&(o=-i*this.anchor.y,m.y>o&&m.y<o+i)},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._anchor=null;var i="boolean"==typeof e?e:e&&e.texture;if(i){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null,this.shader=null},e.from=function(t){return new e(p.default.from(t))},e.fromFrame=function(t){var i=u.TextureCache[t];if(!i)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return new e(i)},e.fromImage=function(t,i,n){return new e(p.default.fromImage(t,i,n))},a(e,[{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,u.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,u.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copy(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}]),e}(f.default);i.default=_},{"../const":45,"../display/Container":47,"../math":69,"../textures/Texture":113,"../utils":121}],102:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../renderers/canvas/CanvasRenderer"),s=n(r),a=t("../../const"),l=t("../../math"),u=t("./CanvasTinter"),h=n(u),c=new l.Matrix,p=function(){function t(e){o(this,t),this.renderer=e}return t.prototype.render=function(t){var e=t._texture,i=this.renderer,n=e._frame.width,o=e._frame.height,r=t.transform.worldTransform,s=0,u=0;if(!(e.orig.width<=0||e.orig.height<=0)&&e.baseTexture.source&&(i.setBlendMode(t.blendMode),e.valid)){i.context.globalAlpha=t.worldAlpha;var p=e.baseTexture.scaleMode===a.SCALE_MODES.LINEAR;i.smoothProperty&&i.context[i.smoothProperty]!==p&&(i.context[i.smoothProperty]=p),e.trim?(s=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,u=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(s=(.5-t.anchor.x)*e.orig.width,u=(.5-t.anchor.y)*e.orig.height),e.rotate&&(r.copy(c),r=c,l.GroupD8.matrixAppendRotationInv(r,e.rotate,s,u),s=0,u=0),s-=n/2,u-=o/2,i.roundPixels?(i.context.setTransform(r.a,r.b,r.c,r.d,r.tx*i.resolution|0,r.ty*i.resolution|0),s|=0,u|=0):i.context.setTransform(r.a,r.b,r.c,r.d,r.tx*i.resolution,r.ty*i.resolution);var d=e.baseTexture.resolution;16777215!==t.tint?(t.cachedTint!==t.tint&&(t.cachedTint=t.tint,t.tintedTexture=h.default.getTintedTexture(t,t.tint)),i.context.drawImage(t.tintedTexture,0,0,n*d,o*d,s*i.resolution,u*i.resolution,n*i.resolution,o*i.resolution)):i.context.drawImage(e.baseTexture.source,e._frame.x*d,e._frame.y*d,n*d,o*d,s*i.resolution,u*i.resolution,n*i.resolution,o*i.resolution)}},t.prototype.destroy=function(){this.renderer=null},t}();i.default=p,s.default.registerPlugin("sprite",p)},{"../../const":45,"../../math":69,"../../renderers/canvas/CanvasRenderer":76,"./CanvasTinter":103}],103:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("../../utils"),r=t("../../renderers/canvas/utils/canUseNewCanvasBlendModes"),s=n(r),a={getTintedTexture:function(t,e){var i=t.texture;e=a.roundColor(e);var n="#"+("00000"+(0|e).toString(16)).substr(-6);if(i.tintCache=i.tintCache||{},i.tintCache[n])return i.tintCache[n];var o=a.canvas||document.createElement("canvas");if(a.tintMethod(i,e,o),a.convertTintToImage){var r=new Image;r.src=o.toDataURL(),i.tintCache[n]=r}else i.tintCache[n]=o,a.canvas=null;return o},tintWithMultiply:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),r=t.baseTexture.resolution;o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="multiply",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},tintWithOverlay:function(t,e,i){var n=i.getContext("2d"),o=t._frame.clone(),r=t.baseTexture.resolution;o.x*=r,o.y*=r,o.width*=r,o.height*=r,i.width=Math.ceil(o.width),i.height=Math.ceil(o.height),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),n.fillRect(0,0,o.width,o.height),n.globalCompositeOperation="destination-atop",n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height)},tintWithPerPixel:function(t,e,i){var n=i.getContext("2d"),r=t._frame.clone(),s=t.baseTexture.resolution;r.x*=s,r.y*=s,r.width*=s,r.height*=s,i.width=Math.ceil(r.width),i.height=Math.ceil(r.height),n.globalCompositeOperation="copy",n.drawImage(t.baseTexture.source,r.x,r.y,r.width,r.height,0,0,r.width,r.height);for(var a=(0,o.hex2rgb)(e),l=a[0],u=a[1],h=a[2],c=n.getImageData(0,0,r.width,r.height),p=c.data,d=0;d<p.length;d+=4)p[d+0]*=l,p[d+1]*=u,p[d+2]*=h;n.putImageData(c,0,0)},roundColor:function(t){var e=a.cacheStepsPerColorChannel,i=(0,o.hex2rgb)(t);return i[0]=Math.min(255,i[0]/e*e),i[1]=Math.min(255,i[1]/e*e),i[2]=Math.min(255,i[2]/e*e),(0,o.rgb2hex)(i)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:(0,s.default)(),tintMethod:0};a.tintMethod=a.canUseMultiply?a.tintWithMultiply:a.tintWithPerPixel,i.default=a},{"../../renderers/canvas/utils/canUseNewCanvasBlendModes":79,"../../utils":121}],104:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(e){n(this,t),this.vertices=new ArrayBuffer(e),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)}return t.prototype.destroy=function(){this.vertices=null,this.positions=null,this.uvs=null,this.colors=null},t}();i.default=o},{}],105:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../renderers/webgl/utils/ObjectRenderer"),l=n(a),u=t("../../renderers/webgl/WebGLRenderer"),h=n(u),c=t("../../utils/createIndicesForQuads"),p=n(c),d=t("./generateMultiTextureShader"),f=n(d),m=t("../../renderers/webgl/utils/checkMaxIfStatmentsInShader"),_=n(m),y=t("./BatchBuffer"),x=n(y),v=t("../../settings"),g=n(v),b=t("pixi-gl-core"),w=n(b),S=t("bit-twiddle"),C=n(S),D=0,T=0,A=function(t){function e(i){o(this,e);var n=r(this,t.call(this,i));n.vertSize=5,n.vertByteSize=4*n.vertSize,n.size=g.default.SPRITE_BATCH_SIZE,n.buffers=[];for(var s=1;s<=C.default.nextPow2(n.size);s*=2)n.buffers.push(new x.default(4*s*n.vertByteSize));n.indices=(0,p.default)(n.size),n.shader=null,n.currentIndex=0,n.groups=[];for(var a=0;a<n.size;a++)n.groups[a]={textures:[],textureCount:0,ids:[],size:0,start:0,blend:0};return n.sprites=[],n.vertexBuffers=[],n.vaos=[],n.vaoMax=2,n.vertexCount=0,n.renderer.on("prerender",n.onPrerender,n),n}return s(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.renderer.legacy?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),g.default.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=(0,_.default)(this.MAX_TEXTURES,t));var e=this.shader=(0,f.default)(t,this.MAX_TEXTURES);this.indexBuffer=w.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.renderer.bindVao(null);for(var i=0;i<this.vaoMax;i++)this.vertexBuffers[i]=w.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),this.vaos[i]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[i],e.attributes.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[i],e.attributes.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[i],e.attributes.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12),e.attributes.aTextureId&&this.vaos[i].addAttribute(this.vertexBuffers[i],e.attributes.aTextureId,t.FLOAT,!1,this.vertByteSize,16);this.vao=this.vaos[0],this.currentBlendMode=99999,this.boundTextures=new Array(this.MAX_TEXTURES)},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){this.currentIndex>=this.size&&this.flush(),t._texture._uvs&&(this.sprites[this.currentIndex++]=t)},e.prototype.flush=function(){if(0!==this.currentIndex){var t=this.renderer.gl,e=this.MAX_TEXTURES,i=C.default.nextPow2(this.currentIndex),n=C.default.log2(i),o=this.buffers[n],r=this.sprites,s=this.groups,a=o.float32View,l=o.uint32View,u=this.boundTextures,h=this.renderer.boundTextures,c=this.renderer.textureGC.count,p=0,d=void 0,f=void 0,m=1,_=0,y=s[0],x=void 0,v=void 0,b=r[0].blendMode;y.textureCount=0,y.start=0,y.blend=b,D++;var S=void 0;for(S=0;S<e;++S)u[S]=h[S],u[S]._virtalBoundId=S;for(S=0;S<this.currentIndex;++S){var A=r[S];if(d=A._texture.baseTexture,b!==A.blendMode&&(b=A.blendMode,f=null,_=e,D++),f!==d&&(f=d,d._enabled!==D)){if(_===e&&(D++,y.size=S-y.start,_=0,y=s[m++],y.blend=b,y.textureCount=0,y.start=S),d.touched=c,d._virtalBoundId===-1)for(var B=0;B<e;++B){var M=(B+T)%e,E=u[M];if(E._enabled!==D){T++,E._virtalBoundId=-1,d._virtalBoundId=M,u[M]=d;break}}d._enabled=D,y.textureCount++,y.ids[_]=d._virtalBoundId,y.textures[_++]=d}if(x=A.vertexData,v=A._texture._uvs.uvsUint32,this.renderer.roundPixels){var P=this.renderer.resolution;a[p]=(x[0]*P|0)/P,a[p+1]=(x[1]*P|0)/P,a[p+5]=(x[2]*P|0)/P,a[p+6]=(x[3]*P|0)/P,a[p+10]=(x[4]*P|0)/P,a[p+11]=(x[5]*P|0)/P,a[p+15]=(x[6]*P|0)/P,a[p+16]=(x[7]*P|0)/P}else a[p]=x[0],a[p+1]=x[1],a[p+5]=x[2],a[p+6]=x[3],a[p+10]=x[4],a[p+11]=x[5],a[p+15]=x[6],a[p+16]=x[7];l[p+2]=v[0],l[p+7]=v[1],l[p+12]=v[2],l[p+17]=v[3],l[p+3]=l[p+8]=l[p+13]=l[p+18]=A._tintRGB+(255*Math.min(A.worldAlpha,1)<<24),a[p+4]=a[p+9]=a[p+14]=a[p+19]=d._virtalBoundId,p+=20}for(y.size=S-y.start,g.default.CAN_UPLOAD_SAME_BUFFER?this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!0):(this.vaoMax<=this.vertexCount&&(this.vaoMax++,this.vertexBuffers[this.vertexCount]=w.default.GLBuffer.createVertexBuffer(t,null,t.STREAM_DRAW),this.vaos[this.vertexCount]=this.renderer.createVao().addIndex(this.indexBuffer).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aVertexPosition,t.FLOAT,!1,this.vertByteSize,0).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aTextureCoord,t.UNSIGNED_SHORT,!0,this.vertByteSize,8).addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aColor,t.UNSIGNED_BYTE,!0,this.vertByteSize,12),this.shader.attributes.aTextureId&&this.vaos[this.vertexCount].addAttribute(this.vertexBuffers[this.vertexCount],this.shader.attributes.aTextureId,t.FLOAT,!1,this.vertByteSize,16)),this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].upload(o.vertices,0,!1),this.vertexCount++),S=0;S<e;++S)h[S]._virtalBoundId=-1;for(S=0;S<m;++S){for(var I=s[S],O=I.textureCount,R=0;R<O;R++)f=I.textures[R],h[I.ids[R]]!==f&&this.renderer.bindTexture(f,I.ids[R],!0),f._virtalBoundId=-1;this.renderer.state.setBlendMode(I.blend),t.drawElements(t.TRIANGLES,6*I.size,t.UNSIGNED_SHORT,6*I.start*2)}this.currentIndex=0}},e.prototype.start=function(){this.renderer.bindShader(this.shader),g.default.CAN_UPLOAD_SAME_BUFFER&&(this.renderer.bindVao(this.vaos[this.vertexCount]),this.vertexBuffers[this.vertexCount].bind())},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vertexBuffers[e]&&this.vertexBuffers[e].destroy(),this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.vertexBuffers=null,this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null;for(var i=0;i<this.buffers.length;++i)this.buffers[i].destroy()},e}(l.default);i.default=A,h.default.registerPlugin("sprite",A)},{"../../renderers/webgl/WebGLRenderer":83,"../../renderers/webgl/utils/ObjectRenderer":93,"../../renderers/webgl/utils/checkMaxIfStatmentsInShader":96,"../../settings":100,"../../utils/createIndicesForQuads":119,"./BatchBuffer":104,"./generateMultiTextureShader":106,"bit-twiddle":1,"pixi-gl-core":12}],106:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n",n=l;n=n.replace(/%count%/gi,e),n=n.replace(/%forloop%/gi,r(e));for(var o=new a.default(t,i,n),s=[],u=0;u<e;u++)s[u]=u;return o.bind(),o.uniforms.uSamplers=s,o}function r(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(textureId == "+i+".0)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}i.__esModule=!0,i.default=o;var s=t("../../Shader"),a=n(s),l=(t("path"),["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","float textureId = floor(vTextureId+0.5);","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"))},{"../../Shader":43,path:23}],107:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../sprites/Sprite"),u=n(l),h=t("../textures/Texture"),c=n(h),p=t("../math"),d=t("../utils"),f=t("../const"),m=t("../settings"),_=n(m),y=t("./TextStyle"),x=n(y),v=t("../utils/trimCanvas"),g=n(v),b={texture:!0,children:!1,baseTexture:!0},w=function(t){function e(i,n,s){o(this,e),s=s||document.createElement("canvas"),s.width=3,s.height=3;var a=c.default.fromCanvas(s);a.orig=new p.Rectangle,a.trim=new p.Rectangle;var l=r(this,t.call(this,a));return l.canvas=s,l.context=l.canvas.getContext("2d"),l.resolution=_.default.RESOLUTION,l._text=null,l._style=null,l._styleListener=null,l._font="",l.text=i,l.style=n,l.localStyleID=-1,l}return s(e,t),e.prototype.updateText=function(t){var i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),this.dirty||!t){this._font=e.getFontStyle(i),this.context.font=this._font;for(var n=i.wordWrap?this.wordWrap(this._text):this._text,o=n.split(/(?:\r\n|\r|\n)/),r=new Array(o.length),s=0,a=e.calculateFontProperties(this._font),l=0;l<o.length;l++){var u=this.context.measureText(o[l]).width+(o[l].length-1)*i.letterSpacing;r[l]=u,s=Math.max(s,u)}var h=s+i.strokeThickness;i.dropShadow&&(h+=i.dropShadowDistance),this.canvas.width=Math.ceil((h+2*i.padding)*this.resolution);var c=i.lineHeight||a.fontSize+i.strokeThickness,p=Math.max(c,a.fontSize+i.strokeThickness)+(o.length-1)*c;i.dropShadow&&(p+=i.dropShadowDistance),this.canvas.height=Math.ceil((p+2*i.padding)*this.resolution),this.context.scale(this.resolution,this.resolution),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this._font,this.context.strokeStyle=i.stroke,this.context.lineWidth=i.strokeThickness,this.context.textBaseline=i.textBaseline,this.context.lineJoin=i.lineJoin,this.context.miterLimit=i.miterLimit;var d=void 0,f=void 0;if(i.dropShadow){this.context.shadowBlur=i.dropShadowBlur,this.context.globalAlpha=i.dropShadowAlpha,i.dropShadowBlur>0?this.context.shadowColor=i.dropShadowColor:this.context.fillStyle=i.dropShadowColor;
for(var m=Math.cos(i.dropShadowAngle)*i.dropShadowDistance,_=Math.sin(i.dropShadowAngle)*i.dropShadowDistance,y=0;y<o.length;y++)d=i.strokeThickness/2,f=i.strokeThickness/2+y*c+a.ascent,"right"===i.align?d+=s-r[y]:"center"===i.align&&(d+=(s-r[y])/2),i.fill&&(this.drawLetterSpacing(o[y],d+m+i.padding,f+_+i.padding),i.stroke&&i.strokeThickness&&(this.context.strokeStyle=i.dropShadowColor,this.drawLetterSpacing(o[y],d+m+i.padding,f+_+i.padding,!0),this.context.strokeStyle=i.stroke))}this.context.shadowBlur=0,this.context.globalAlpha=1,this.context.fillStyle=this._generateFillStyle(i,o);for(var x=0;x<o.length;x++)d=i.strokeThickness/2,f=i.strokeThickness/2+x*c+a.ascent,"right"===i.align?d+=s-r[x]:"center"===i.align&&(d+=(s-r[x])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(o[x],d+i.padding,f+i.padding,!0),i.fill&&this.drawLetterSpacing(o[x],d+i.padding,f+i.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this._style,r=o.letterSpacing;if(0===r)return void(n?this.context.strokeText(t,e,i):this.context.fillText(t,e,i));for(var s=String.prototype.split.call(t,""),a=e,l=0,u="";l<t.length;)u=s[l++],n?this.context.strokeText(u,a,i):this.context.fillText(u,a,i),a+=this.context.measureText(u).width+r},e.prototype.updateTexture=function(){if(this._style.trim){var t=(0,g.default)(this.canvas);this.canvas.width=t.width,this.canvas.height=t.height,this.context.putImageData(t.data,0,0)}var e=this._texture,i=this._style;e.baseTexture.hasLoaded=!0,e.baseTexture.resolution=this.resolution,e.baseTexture.realWidth=this.canvas.width,e.baseTexture.realHeight=this.canvas.height,e.baseTexture.width=this.canvas.width/this.resolution,e.baseTexture.height=this.canvas.height/this.resolution,e.trim.width=e._frame.width=this.canvas.width/this.resolution,e.trim.height=e._frame.height=this.canvas.height/this.resolution,e.trim.x=-i.padding,e.trim.y=-i.padding,e.orig.width=e._frame.width-2*i.padding,e.orig.height=e._frame.height-2*i.padding,this._onTextureUpdate(),e.baseTexture.emit("update",e.baseTexture),this.dirty=!1},e.prototype.renderWebGL=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.renderWebGL.call(this,e)},e.prototype._renderCanvas=function(e){this.resolution!==e.resolution&&(this.resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.wordWrap=function(t){for(var e="",i=this._style,n=t.split("\n"),o=i.wordWrapWidth,r=0;r<n.length;r++){for(var s=o,a=n[r].split(" "),l=0;l<a.length;l++){var u=this.context.measureText(a[l]).width;if(i.breakWords&&u>o)for(var h=a[l].split(""),c=0;c<h.length;c++){var p=this.context.measureText(h[c]).width;p>s?(e+="\n"+h[c],s=o-p):(0===c&&(e+=" "),e+=h[c],s-=p)}else{var d=u+this.context.measureText(" ").width;0===l||d>s?(l>0&&(e+="\n"),e+=a[l],s=o-u):(s-=d,e+=" "+a[l])}}r<n.length-1&&(e+="\n")}return e},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;if(navigator.isCocoonJS)return t.fill[0];var i=void 0,n=void 0,o=void 0,r=void 0,s=this.canvas.width/this.resolution,a=this.canvas.height/this.resolution,l=t.fill.slice(),u=t.fillGradientStops.slice();if(!u.length)for(var h=l.length+1,c=1;c<h;++c)u.push(c/h);if(l.unshift(t.fill[0]),u.unshift(0),l.push(t.fill[t.fill.length-1]),u.push(1),t.fillGradientType===f.TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,0,s/2,a),n=(l.length+1)*e.length,o=0;for(var p=0;p<e.length;p++){o+=1;for(var d=0;d<l.length;d++)r=u[d]?u[d]/e.length+p/e.length:o/n,i.addColorStop(r,l[d]),o++}}else{i=this.context.createLinearGradient(0,a/2,s,a/2),n=l.length+1,o=1;for(var m=0;m<l.length;m++)r=u[m]?u[m]:o/n,i.addColorStop(r,l[m]),o++}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},b,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},e.getFontStyle=function(t){t=t||{},t instanceof x.default||(t=new x.default(t));var e="number"==typeof t.fontSize?t.fontSize+"px":t.fontSize,i=t.fontFamily;Array.isArray(t.fontFamily)||(i=t.fontFamily.split(","));for(var n=i.length-1;n>=0;n--){var o=i[n].trim();/([\"\'])[^\'\"]+\1/.test(o)||(o='"'+o+'"'),i[n]=o}return t.fontStyle+" "+t.fontVariant+" "+t.fontWeight+" "+e+" "+i.join(",")},e.calculateFontProperties=function(t){if(e.fontPropertiesCache[t])return e.fontPropertiesCache[t];var i={},n=e.fontPropertiesCanvas,o=e.fontPropertiesContext;o.font=t;var r=Math.ceil(o.measureText("|MÉq").width),s=Math.ceil(o.measureText("M").width),a=2*s;s=1.4*s|0,n.width=r,n.height=a,o.fillStyle="#f00",o.fillRect(0,0,r,a),o.font=t,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText("|MÉq",0,s);var l=o.getImageData(0,0,r,a).data,u=l.length,h=4*r,c=0,p=0,d=!1;for(c=0;c<s;++c){for(var f=0;f<h;f+=4)if(255!==l[p+f]){d=!0;break}if(d)break;p+=h}for(i.ascent=s-c,p=u-h,d=!1,c=a;c>s;--c){for(var m=0;m<h;m+=4)if(255!==l[p+m]){d=!0;break}if(d)break;p-=h}return i.descent=c-s,i.fontSize=i.ascent+i.descent,e.fontPropertiesCache[t]=i,i},a(e,[{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,d.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,d.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){t=t||{},t instanceof x.default?this._style=t:this._style=new x.default(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(""===t||null===t||void 0===t?" ":t),this._text!==t&&(this._text=t,this.dirty=!0)}}]),e}(u.default);i.default=w,w.fontPropertiesCache={},w.fontPropertiesCanvas=document.createElement("canvas"),w.fontPropertiesContext=w.fontPropertiesCanvas.getContext("2d")},{"../const":45,"../math":69,"../settings":100,"../sprites/Sprite":101,"../textures/Texture":113,"../utils":121,"../utils/trimCanvas":125,"./TextStyle":108}],108:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){return"number"==typeof t?(0,u.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function r(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=o(t[e]);return t}return o(t)}function s(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../const"),u=t("../utils"),h={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"#000000",dropShadowDistance:5,fill:"black",fillGradientType:l.TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,wordWrap:!1,wordWrapWidth:100},c=function(){function t(e){n(this,t),this.styleID=0,Object.assign(this,h,e)}return t.prototype.clone=function(){var e={};for(var i in h)e[i]=this[i];return new t(e)},t.prototype.reset=function(){Object.assign(this,h)},a(t,[{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=r(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=r(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){s(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=r(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}}]),t}();i.default=c},{"../const":45,"../utils":121}],109:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("./BaseTexture"),l=n(a),u=t("../settings"),h=n(u),c=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments[2],a=arguments[3];o(this,e);var l=r(this,t.call(this,null,s));return l.resolution=a||h.default.RESOLUTION,l.width=i,l.height=n,l.realWidth=l.width*l.resolution,l.realHeight=l.height*l.resolution,l.scaleMode=void 0!==s?s:h.default.SCALE_MODE,l.hasLoaded=!0,l._glRenderTargets={},l._canvasRenderTarget=null,l.valid=!1,l}return s(e,t),e.prototype.resize=function(t,e){t===this.width&&e===this.height||(this.valid=t>0&&e>0,this.width=t,this.height=e,this.realWidth=this.width*this.resolution,this.realHeight=this.height*this.resolution,this.valid&&this.emit("update",this))},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.renderer=null},e}(l.default);i.default=c},{"../settings":100,"./BaseTexture":110}],110:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../utils"),l=t("../settings"),u=n(l),h=t("eventemitter3"),c=n(h),p=t("../utils/determineCrossOrigin"),d=n(p),f=t("bit-twiddle"),m=n(f),_=function(t){function e(i,n,s){o(this,e);var l=r(this,t.call(this));return l.uid=(0,a.uid)(),l.touched=0,l.resolution=s||u.default.RESOLUTION,l.width=100,l.height=100,l.realWidth=100,l.realHeight=100,l.scaleMode=void 0!==n?n:u.default.SCALE_MODE,l.hasLoaded=!1,l.isLoading=!1,l.source=null,l.origSource=null,l.imageType=null,l.sourceScale=1,l.premultipliedAlpha=!0,l.imageUrl=null,l.isPowerOfTwo=!1,l.mipmap=u.default.MIPMAP_TEXTURES,l.wrapMode=u.default.WRAP_MODE,l._glTextures={},l._enabled=0,l._virtalBoundId=-1,i&&l.loadSource(i),l}return s(e,t),e.prototype.update=function(){"svg"!==this.imageType&&(this.realWidth=this.source.naturalWidth||this.source.videoWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.videoHeight||this.source.height,this._updateDimensions()),this.emit("update",this)},e.prototype._updateDimensions=function(){this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=m.default.isPow2(this.realWidth)&&m.default.isPow2(this.realHeight)},e.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null);var i=!this.source;if(this.source=t,(t.src&&t.complete||t.getContext)&&t.width&&t.height)this._updateImageType(),"svg"===this.imageType?this._loadSvgSource():this._sourceLoaded(),i&&this.emit("loaded",this);else if(!t.getContext){this.isLoading=!0;var n=this;if(t.onload=function(){if(n._updateImageType(),t.onload=null,t.onerror=null,n.isLoading)return n.isLoading=!1,n._sourceLoaded(),"svg"===n.imageType?void n._loadSvgSource():void n.emit("loaded",n)},t.onerror=function(){t.onload=null,t.onerror=null,n.isLoading&&(n.isLoading=!1,n.emit("error",n))},t.complete&&t.src){if(t.onload=null,t.onerror=null,"svg"===n.imageType)return void n._loadSvgSource();this.isLoading=!1,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this)}}},e.prototype._updateImageType=function(){if(this.imageUrl){var t=(0,a.decomposeDataUri)(this.imageUrl),e=void 0;if(t&&"image"===t.mediaType){var i=t.subType.split("+")[0];if(e=(0,a.getUrlFileExtension)("."+i),!e)throw new Error("Invalid image type in data URI.")}else e=(0,a.getUrlFileExtension)(this.imageUrl),e||(e="png");this.imageType=e}},e.prototype._loadSvgSource=function(){if("svg"===this.imageType){var t=(0,a.decomposeDataUri)(this.imageUrl);t?this._loadSvgSourceUsingDataUri(t):this._loadSvgSourceUsingXhr()}},e.prototype._loadSvgSourceUsingDataUri=function(t){var e=void 0;if("base64"===t.encoding){if(!atob)throw new Error("Your browser doesn't support base64 conversions.");e=atob(t.data)}else e=t.data;this._loadSvgSourceUsingString(e)},e.prototype._loadSvgSourceUsingXhr=function(){var t=this,e=new XMLHttpRequest;e.onload=function(){if(e.readyState!==e.DONE||200!==e.status)throw new Error("Failed to load SVG using XHR.");t._loadSvgSourceUsingString(e.response)},e.onerror=function(){return t.emit("error",t)},e.open("GET",this.imageUrl,!0),e.send()},e.prototype._loadSvgSourceUsingString=function(t){var e=(0,a.getSvgSize)(t),i=e.width,n=e.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");this.realWidth=Math.round(i*this.sourceScale),this.realHeight=Math.round(n*this.sourceScale),this._updateDimensions();var o=document.createElement("canvas");o.width=this.realWidth,o.height=this.realHeight,o._pixiId="canvas_"+(0,a.uid)(),o.getContext("2d").drawImage(this.source,0,0,i,n,0,0,this.realWidth,this.realHeight),this.origSource=this.source,this.source=o,a.BaseTextureCache[o._pixiId]=this,this.isLoading=!1,this._sourceLoaded(),this.emit("loaded",this)},e.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},e.prototype.destroy=function(){this.imageUrl&&(delete a.BaseTextureCache[this.imageUrl],delete a.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")),this.source&&this.source._pixiId&&delete a.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},e.fromImage=function(t,i,n,o){var r=a.BaseTextureCache[t];if(!r){var s=new Image;void 0===i&&0!==t.indexOf("data:")&&(s.crossOrigin=(0,d.default)(t)),r=new e(s,n),r.imageUrl=t,o&&(r.sourceScale=o),r.resolution=(0,a.getResolutionOfUrl)(t),s.src=t,a.BaseTextureCache[t]=r}return r},e.fromCanvas=function(t,i){t._pixiId||(t._pixiId="canvas_"+(0,a.uid)());var n=a.BaseTextureCache[t._pixiId];return n||(n=new e(t,i),a.BaseTextureCache[t._pixiId]=n),n},e.from=function(t,i,n){if("string"==typeof t)return e.fromImage(t,void 0,i,n);if(t instanceof HTMLImageElement){var o=t.src,r=a.BaseTextureCache[o];return r||(r=new e(t,i),r.imageUrl=o,n&&(r.sourceScale=n),r.resolution=(0,a.getResolutionOfUrl)(o),a.BaseTextureCache[o]=r),r}return t instanceof HTMLCanvasElement?e.fromCanvas(t,i):t},e}(c.default);i.default=_},{"../settings":100,"../utils":121,"../utils/determineCrossOrigin":120,"bit-twiddle":1,eventemitter3:3}],111:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("./BaseRenderTexture"),l=n(a),u=t("./Texture"),h=n(u),c=function(t){function e(i,n){o(this,e);var s=null;if(!(i instanceof l.default)){var a=arguments[1],u=arguments[2],h=arguments[3],c=arguments[4];console.warn("Please use RenderTexture.create("+a+", "+u+") instead of the ctor directly."),s=arguments[0],n=null,i=new l.default(a,u,h,c)}var p=r(this,t.call(this,i,n));return p.legacyRenderer=s,p.valid=!0,p._updateUvs(),p}return s(e,t),e.prototype.resize=function(t,e,i){this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i||this.baseTexture.resize(t,e),this._updateUvs()},e.create=function(t,i,n,o){return new e(new l.default(t,i,n,o))},e}(h.default);i.default=c},{"./BaseRenderTexture":109,"./Texture":113}],112:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t("../"),s=t("../utils"),a=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,t),this.baseTexture=e,this.textures={},this.data=i,this.resolution=this._updateResolution(o||this.baseTexture.imageUrl),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return o(t,null,[{key:"BATCH_SIZE",get:function(){return 1e3}}]),t.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=(0,s.getResolutionOfUrl)(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&(this.baseTexture.resolution=i,this.baseTexture.update()),i},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._parseComplete()):this._nextBatch()},t.prototype._processFrames=function(e){for(var i=e,n=t.BATCH_SIZE;i-e<n&&i<this._frameKeys.length;){var o=this._frameKeys[i],a=this._frames[o].frame;if(a){var l=null,u=null,h=new r.Rectangle(0,0,this._frames[o].sourceSize.w/this.resolution,this._frames[o].sourceSize.h/this.resolution);l=this._frames[o].rotated?new r.Rectangle(a.x/this.resolution,a.y/this.resolution,a.h/this.resolution,a.w/this.resolution):new r.Rectangle(a.x/this.resolution,a.y/this.resolution,a.w/this.resolution,a.h/this.resolution),this._frames[o].trimmed&&(u=new r.Rectangle(this._frames[o].spriteSourceSize.x/this.resolution,this._frames[o].spriteSourceSize.y/this.resolution,a.w/this.resolution,a.h/this.resolution)),this.textures[o]=new r.Texture(this.baseTexture,l,h,u,this._frames[o].rotated?2:0),s.TextureCache[o]=this.textures[o]}i++}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():e._parseComplete()},0)},t.prototype.destroy=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},t}();i.default=a},{"../":64,"../utils":121}],113:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(){var t=document.createElement("canvas");t.width=10,t.height=10;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,10,10),new g(new c.default(t))}function l(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}i.__esModule=!0;var u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=t("./BaseTexture"),c=n(h),p=t("./VideoBaseTexture"),d=n(p),f=t("./TextureUvs"),m=n(f),_=t("eventemitter3"),y=n(_),x=t("../math"),v=t("../utils"),g=function(t){function e(i,n,s,a,l){o(this,e);var u=r(this,t.call(this));if(u.noFrame=!1,n||(u.noFrame=!0,n=new x.Rectangle(0,0,1,1)),i instanceof e&&(i=i.baseTexture),u.baseTexture=i,u._frame=n,u.trim=a,u.valid=!1,u.requiresUpdate=!1,u._uvs=null,u.orig=s||n,u._rotate=Number(l||0),l===!0)u._rotate=2;else if(u._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return i.hasLoaded?(u.noFrame&&(n=new x.Rectangle(0,0,i.width,i.height),i.on("update",u.onBaseTextureUpdated,u)),u.frame=n):i.once("loaded",u.onBaseTextureLoaded,u),u._updateID=0,u.transform=null,u}return s(e,t),e.prototype.update=function(){this.baseTexture.update()},e.prototype.onBaseTextureLoaded=function(t){this._updateID++,this.noFrame?this.frame=new x.Rectangle(0,0,t.width,t.height):this.frame=this._frame,this.baseTexture.on("update",this.onBaseTextureUpdated,this),this.emit("update",this)},e.prototype.onBaseTextureUpdated=function(t){this._updateID++,this._frame.width=t.width,this._frame.height=t.height,this.emit("update",this)},e.prototype.destroy=function(t){this.baseTexture&&(t&&(v.TextureCache[this.baseTexture.imageUrl]&&delete v.TextureCache[this.baseTexture.imageUrl],this.baseTexture.destroy()),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate)},e.prototype._updateUvs=function(){this._uvs||(this._uvs=new m.default),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.fromImage=function(t,i,n,o){var r=v.TextureCache[t];return r||(r=new e(c.default.fromImage(t,i,n,o)),v.TextureCache[t]=r),r},e.fromFrame=function(t){var e=v.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},e.fromCanvas=function(t,i){return new e(c.default.fromCanvas(t,i))},e.fromVideo=function(t,i){return"string"==typeof t?e.fromVideoUrl(t,i):new e(d.default.fromVideo(t,i))},e.fromVideoUrl=function(t,i){return new e(d.default.fromUrl(t,i))},e.from=function(t){if("string"==typeof t){var i=v.TextureCache[t];if(!i){var n=null!==t.match(/\.(mp4|webm|ogg|h264|avi|mov)$/);return n?e.fromVideoUrl(t):e.fromImage(t)}return i}return t instanceof HTMLImageElement?new e(c.default.from(t)):t instanceof HTMLCanvasElement?e.fromCanvas(t):t instanceof HTMLVideoElement?e.fromVideo(t):t instanceof c.default?new e(t):t},e.fromLoader=function(t,i,n){var o=new c.default(t,void 0,(0,v.getResolutionOfUrl)(i)),r=new e(o);return o.imageUrl=i,n||(n=i),v.BaseTextureCache[n]=o,v.TextureCache[n]=r,n!==i&&(v.BaseTextureCache[i]=o,v.TextureCache[i]=r),r},e.addTextureToCache=function(t,e){v.TextureCache[e]=t},e.removeTextureFromCache=function(t){var e=v.TextureCache[t];return delete v.TextureCache[t],delete v.BaseTextureCache[t],e},u(e,[{key:"frame",get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+("X: "+t.x+" + "+t.width+" > "+this.baseTexture.width+" ")+("Y: "+t.y+" + "+t.height+" > "+this.baseTexture.height));this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim||this.rotate||(this.orig=t),this.valid&&this._updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this._updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}}]),e}(y.default);i.default=g,g.EMPTY=new g(new c.default),l(g.EMPTY),g.WHITE=a(),l(g.WHITE)},{"../math":69,"../utils":121,"./BaseTexture":110,"./TextureUvs":114,"./VideoBaseTexture":115,eventemitter3:3}],114:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../math/GroupD8"),s=n(r),a=function(){function t(){o(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsUint32=new Uint32Array(4)}return t.prototype.set=function(t,e,i){var n=e.width,o=e.height;if(i){var r=t.width/2/n,a=t.height/2/o,l=t.x/n+r,u=t.y/o+a;i=s.default.add(i,s.default.NW),this.x0=l+r*s.default.uX(i),this.y0=u+a*s.default.uY(i),i=s.default.add(i,2),this.x1=l+r*s.default.uX(i),this.y1=u+a*s.default.uY(i),i=s.default.add(i,2),this.x2=l+r*s.default.uX(i),this.y2=u+a*s.default.uY(i),i=s.default.add(i,2),this.x3=l+r*s.default.uX(i),this.y3=u+a*s.default.uY(i)}else this.x0=t.x/n,this.y0=t.y/o,this.x1=(t.x+t.width)/n,this.y1=t.y/o,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/o,this.x3=t.x/n,this.y3=(t.y+t.height)/o;this.uvsUint32[0]=(65535*this.y0&65535)<<16|65535*this.x0&65535,this.uvsUint32[1]=(65535*this.y1&65535)<<16|65535*this.x1&65535,this.uvsUint32[2]=(65535*this.y2&65535)<<16|65535*this.x2&65535,this.uvsUint32[3]=(65535*this.y3&65535)<<16|65535*this.x3&65535},t}();i.default=a},{"../math/GroupD8":65}],115:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var i=document.createElement("source");return i.src=t,i.type=e,i}i.__esModule=!0;var u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=t("./BaseTexture"),c=o(h),p=t("../utils"),d=t("../ticker"),f=n(d),m=function(t){function e(i,n){if(r(this,e),!i)throw new Error("No video source element specified.");(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0);var o=s(this,t.call(this,i,n));return o.width=i.videoWidth,o.height=i.videoHeight,o._autoUpdate=!0,o._isAutoUpdating=!1,o.autoPlay=!0,o.update=o.update.bind(o),o._onCanPlay=o._onCanPlay.bind(o),i.addEventListener("play",o._onPlayStart.bind(o)),i.addEventListener("pause",o._onPlayStop.bind(o)),o.hasLoaded=!1,o.__loaded=!1,o._isSourceReady()?o._onCanPlay():(i.addEventListener("canplay",o._onCanPlay),
i.addEventListener("canplaythrough",o._onCanPlay)),o}return a(e,t),e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&t.paused===!1&&t.ended===!1&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.hasLoaded||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(f.shared.add(this.update,this),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(f.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.emit("loaded",this)),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.source.play())},e.prototype.destroy=function(){this._isAutoUpdating&&f.shared.remove(this.update,this),this.source&&this.source._pixiId&&(delete p.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),t.prototype.destroy.call(this)},e.fromVideo=function(t,i){t._pixiId||(t._pixiId="video_"+(0,p.uid)());var n=p.BaseTextureCache[t._pixiId];return n||(n=new e(t,i),p.BaseTextureCache[t._pixiId]=n),n},e.fromUrl=function(t,i){var n=document.createElement("video");if(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),Array.isArray(t))for(var o=0;o<t.length;++o)n.appendChild(l(t[o].src||t[o],t[o].mime));else n.appendChild(l(t.src||t,t.mime));return n.load(),e.fromVideo(n,i)},u(e,[{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(f.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(f.shared.add(this.update,this),this._isAutoUpdating=!0))}}]),e}(c.default);i.default=m,m.fromUrls=m.fromUrl},{"../ticker":117,"../utils":121,"./BaseTexture":110}],116:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("../settings"),a=n(s),l=t("eventemitter3"),u=n(l),h="tick",c=function(){function t(){var e=this;o(this,t),this._emitter=new u.default,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/a.default.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._emitter.listeners(h,!0)&&(e._requestId=requestAnimationFrame(e._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(h,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e){return this._emitter.on(h,t,e),this._startIfPossible(),this},t.prototype.addOnce=function(t,e){return this._emitter.once(h,t,e),this._startIfPossible(),this},t.prototype.remove=function(t,e){return this._emitter.off(h,t,e),this._emitter.listeners(h,!0)||this._cancelIfNeeded(),this},t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now(),e=void 0;t>this.lastTime?(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),this.deltaTime=e*a.default.TARGET_FPMS*this.speed,this._emitter.emit(h,this.deltaTime)):this.deltaTime=this.elapsedMS=0,this.lastTime=t},r(t,[{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(Math.max(0,t)/1e3,a.default.TARGET_FPMS);this._maxElapsedMS=1/e}}]),t}();i.default=c},{"../settings":100,eventemitter3:3}],117:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,i.Ticker=i.shared=void 0;var o=t("./Ticker"),r=n(o),s=new r.default;s.autoStart=!0,i.shared=s,i.Ticker=r.default},{"./Ticker":116}],118:[function(t,e,i){"use strict";function n(){var t=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);return!t}i.__esModule=!0,i.default=n},{}],119:[function(t,e,i){"use strict";function n(t){for(var e=6*t,i=new Uint16Array(e),n=0,o=0;n<e;n+=6,o+=4)i[n+0]=o+0,i[n+1]=o+1,i[n+2]=o+2,i[n+3]=o+0,i[n+4]=o+2,i[n+5]=o+3;return i}i.__esModule=!0,i.default=n},{}],120:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location;if(0===t.indexOf("data:"))return"";e=e||window.location,a||(a=document.createElement("a")),a.href=t,t=s.default.parse(a.href);var i=!t.port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}i.__esModule=!0,i.default=o;var r=t("url"),s=n(r),a=void 0},{url:29}],121:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(){return++P}function s(t,e){return e=e||[],e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function a(t){return t=t.toString(16),t="000000".substr(0,6-t.length)+t,"#"+t}function l(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}function u(t,e){var i=w.default.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}function h(t){var e=g.DATA_URI.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,encoding:e[3]?e[3].toLowerCase():void 0,data:e[4]}}function c(t){var e=g.URL_FILE_EXTENSION.exec(t);if(e)return e[1].toLowerCase()}function p(t){var e=g.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}function d(){I=!0}function f(t){if(!I){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c Pixi.js "+g.VERSION+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+g.VERSION+" - "+t+" - http://www.pixijs.com/");I=!0}}function m(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!(!i||!i.getContextAttributes().stencil);if(i){var o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,n}catch(t){return!1}}function _(t){return 0===t?0:t<0?-1:1}function y(t,e,i){var n=t.length;if(!(e>=n||0===i)){i=e+i>n?n-e:i;for(var o=n-i,r=e;r<o;++r)t[r]=t[r+i];t.length=o}}function x(){var t=void 0;for(t in O)O[t].destroy();for(t in R)R[t].destroy()}function v(){var t=void 0;for(t in O)delete O[t];for(t in R)delete R[t]}i.__esModule=!0,i.BaseTextureCache=i.TextureCache=i.mixins=i.pluginTarget=i.EventEmitter=i.isMobile=void 0,i.uid=r,i.hex2rgb=s,i.hex2string=a,i.rgb2hex=l,i.getResolutionOfUrl=u,i.decomposeDataUri=h,i.getUrlFileExtension=c,i.getSvgSize=p,i.skipHello=d,i.sayHello=f,i.isWebGLSupported=m,i.sign=_,i.removeItems=y,i.destroyTextureCache=x,i.clearTextureCache=v;var g=t("../const"),b=t("../settings"),w=o(b),S=t("eventemitter3"),C=o(S),D=t("./pluginTarget"),T=o(D),A=t("./mixin"),B=n(A),M=t("ismobilejs"),E=n(M),P=0,I=!1;i.isMobile=E,i.EventEmitter=C.default,i.pluginTarget=T.default,i.mixins=B;var O=i.TextureCache={},R=i.BaseTextureCache={}},{"../const":45,"../settings":100,"./mixin":123,"./pluginTarget":124,eventemitter3:3,ismobilejs:4}],122:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){return s.default.tablet||s.default.phone?4:t}i.__esModule=!0,i.default=o;var r=t("ismobilejs"),s=n(r)},{ismobilejs:4}],123:[function(t,e,i){"use strict";function n(t,e){if(t&&e)for(var i=Object.keys(e),n=0;n<i.length;++n){var o=i[n];Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}}function o(t,e){s.push(t,e)}function r(){for(var t=0;t<s.length;t+=2)n(s[t],s[t+1]);s.length=0}i.__esModule=!0,i.mixin=n,i.delayMixin=o,i.performMixins=r;var s=[]},{}],124:[function(t,e,i){"use strict";function n(t){t.__plugins={},t.registerPlugin=function(e,i){t.__plugins[e]=i},t.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}i.__esModule=!0,i.default={mixin:function(t){n(t)}}},{}],125:[function(t,e,i){"use strict";function n(t){var e=t.width,i=t.height,n=t.getContext("2d"),o=n.getImageData(0,0,e,i),r=o.data,s=r.length,a={top:null,left:null,right:null,bottom:null},l=void 0,u=void 0,h=void 0;for(l=0;l<s;l+=4)0!==r[l+3]&&(u=l/4%e,h=~~(l/4/e),null===a.top&&(a.top=h),null===a.left?a.left=u:u<a.left&&(a.left=u),null===a.right?a.right=u+1:a.right<u&&(a.right=u+1),null===a.bottom?a.bottom=h:a.bottom<h&&(a.bottom=h));e=a.right-a.left,i=a.bottom-a.top+1;var c=n.getImageData(a.left,a.top,e,i);return{height:i,width:e,data:c}}i.__esModule=!0,i.default=n},{}],126:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){var e=(new Error).stack;"undefined"==typeof e?console.warn("Deprecation Warning: ",t):(e=e.split("\n").splice(3).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cDeprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t),console.warn(e),console.groupEnd()):(console.warn("Deprecation Warning: ",t),console.warn(e)))}var r=t("./core"),s=n(r),a=t("./mesh"),l=n(a),u=t("./particles"),h=n(u),c=t("./extras"),p=n(c),d=t("./filters"),f=n(d),m=t("./prepare"),_=n(m),y=t("./loaders"),x=n(y),v=t("./interaction"),g=n(v);s.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},s.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(s,{Stage:{enumerable:!0,get:function(){return o("You do not need to use a PIXI Stage any more, you can simply render any container."),s.Container}},DisplayObjectContainer:{enumerable:!0,get:function(){return o("DisplayObjectContainer has been shortened to Container, please use Container from now on."),s.Container}},Strip:{enumerable:!0,get:function(){return o("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),l.Mesh}},Rope:{enumerable:!0,get:function(){return o("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),l.Rope}},ParticleContainer:{enumerable:!0,get:function(){return o("The ParticleContainer class has been moved to particles.ParticleContainer, please use particles.ParticleContainer from now on."),h.ParticleContainer}},MovieClip:{enumerable:!0,get:function(){return o("The MovieClip class has been moved to extras.AnimatedSprite, please use extras.AnimatedSprite."),p.AnimatedSprite}},TilingSprite:{enumerable:!0,get:function(){return o("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),p.TilingSprite}},BitmapText:{enumerable:!0,get:function(){return o("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),p.BitmapText}},blendModes:{enumerable:!0,get:function(){return o("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),s.BLEND_MODES}},scaleModes:{enumerable:!0,get:function(){return o("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),s.SCALE_MODES}},BaseTextureCache:{enumerable:!0,get:function(){return o("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),s.utils.BaseTextureCache}},TextureCache:{enumerable:!0,get:function(){return o("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),s.utils.TextureCache}},math:{enumerable:!0,get:function(){return o("The math namespace is deprecated, please access members already accessible on PIXI."),s}},AbstractFilter:{enumerable:!0,get:function(){return o("AstractFilter has been renamed to Filter, please use PIXI.Filter"),s.Filter}},TransformManual:{enumerable:!0,get:function(){return o("TransformManual has been renamed to TransformBase, please update your pixi-spine"),s.TransformBase}},TARGET_FPMS:{enumerable:!0,get:function(){return o("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),s.settings.TARGET_FPMS},set:function(t){o("PIXI.TARGET_FPMS has been deprecated, please use PIXI.settings.TARGET_FPMS"),s.settings.TARGET_FPMS=t}},FILTER_RESOLUTION:{enumerable:!0,get:function(){return o("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),s.settings.FILTER_RESOLUTION},set:function(t){o("PIXI.FILTER_RESOLUTION has been deprecated, please use PIXI.settings.FILTER_RESOLUTION"),s.settings.FILTER_RESOLUTION=t}},RESOLUTION:{enumerable:!0,get:function(){return o("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),s.settings.RESOLUTION},set:function(t){o("PIXI.RESOLUTION has been deprecated, please use PIXI.settings.RESOLUTION"),s.settings.RESOLUTION=t}},MIPMAP_TEXTURES:{enumerable:!0,get:function(){return o("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),s.settings.MIPMAP_TEXTURES},set:function(t){o("PIXI.MIPMAP_TEXTURES has been deprecated, please use PIXI.settings.MIPMAP_TEXTURES"),s.settings.MIPMAP_TEXTURES=t}},SPRITE_BATCH_SIZE:{enumerable:!0,get:function(){return o("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),s.settings.SPRITE_BATCH_SIZE},set:function(t){o("PIXI.SPRITE_BATCH_SIZE has been deprecated, please use PIXI.settings.SPRITE_BATCH_SIZE"),s.settings.SPRITE_BATCH_SIZE=t}},SPRITE_MAX_TEXTURES:{enumerable:!0,get:function(){return o("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),s.settings.SPRITE_MAX_TEXTURES},set:function(t){o("PIXI.SPRITE_MAX_TEXTURES has been deprecated, please use PIXI.settings.SPRITE_MAX_TEXTURES"),s.settings.SPRITE_MAX_TEXTURES=t}},RETINA_PREFIX:{enumerable:!0,get:function(){return o("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),s.settings.RETINA_PREFIX},set:function(t){o("PIXI.RETINA_PREFIX has been deprecated, please use PIXI.settings.RETINA_PREFIX"),s.settings.RETINA_PREFIX=t}},DEFAULT_RENDER_OPTIONS:{enumerable:!0,get:function(){return o("PIXI.DEFAULT_RENDER_OPTIONS has been deprecated, please use PIXI.settings.DEFAULT_RENDER_OPTIONS"),s.settings.RENDER_OPTIONS}}});for(var b=[{parent:"TRANSFORM_MODE",target:"TRANSFORM_MODE"},{parent:"GC_MODES",target:"GC_MODE"},{parent:"WRAP_MODES",target:"WRAP_MODE"},{parent:"SCALE_MODES",target:"SCALE_MODE"},{parent:"PRECISION",target:"PRECISION_FRAGMENT"}],w=function(t){var e=b[t];Object.defineProperty(s[e.parent],"DEFAULT",{enumerable:!0,get:function(){return o("PIXI."+e.parent+".DEFAULT has been deprecated, please use PIXI.settings."+e.target),s.settings[e.target]},set:function(t){o("PIXI."+e.parent+".DEFAULT has been deprecated, please use PIXI.settings."+e.target),s.settings[e.target]=t}})},S=0;S<b.length;S++)w(S);Object.defineProperties(s.settings,{PRECISION:{enumerable:!0,get:function(){return o("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),s.settings.PRECISION_FRAGMENT},set:function(t){o("PIXI.settings.PRECISION has been deprecated, please use PIXI.settings.PRECISION_FRAGMENT"),s.settings.PRECISION_FRAGMENT=t}}}),Object.defineProperties(p,{MovieClip:{enumerable:!0,get:function(){return o("The MovieClip class has been renamed to AnimatedSprite, please use AnimatedSprite from now on."),p.AnimatedSprite}}}),s.DisplayObject.prototype.generateTexture=function(t,e,i){return o("generateTexture has moved to the renderer, please use renderer.generateTexture(displayObject)"),t.generateTexture(this,e,i)},s.Graphics.prototype.generateTexture=function(t,e){return o("graphics generate texture has moved to the renderer. Or to render a graphics to a texture using canvas please use generateCanvasTexture"),this.generateCanvasTexture(t,e)},s.RenderTexture.prototype.render=function(t,e,i,n){this.legacyRenderer.render(t,this,i,e,!n),o("RenderTexture.render is now deprecated, please use renderer.render(displayObject, renderTexture)")},s.RenderTexture.prototype.getImage=function(t){return o("RenderTexture.getImage is now deprecated, please use renderer.extract.image(target)"),this.legacyRenderer.extract.image(t)},s.RenderTexture.prototype.getBase64=function(t){return o("RenderTexture.getBase64 is now deprecated, please use renderer.extract.base64(target)"),this.legacyRenderer.extract.base64(t)},s.RenderTexture.prototype.getCanvas=function(t){return o("RenderTexture.getCanvas is now deprecated, please use renderer.extract.canvas(target)"),this.legacyRenderer.extract.canvas(t)},s.RenderTexture.prototype.getPixels=function(t){return o("RenderTexture.getPixels is now deprecated, please use renderer.extract.pixels(target)"),this.legacyRenderer.pixels(t)},s.Sprite.prototype.setTexture=function(t){this.texture=t,o("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},p.BitmapText.prototype.setText=function(t){this.text=t,o("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},s.Text.prototype.setText=function(t){this.text=t,o("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},s.Text.prototype.setStyle=function(t){this.style=t,o("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},s.Text.prototype.determineFontProperties=function(t){return o("determineFontProperties is now deprecated, please use the static calculateFontProperties method, e.g : Text.calculateFontProperties(fontStyle);"),s.Text.calculateFontProperties(t)},Object.defineProperties(s.TextStyle.prototype,{font:{get:function(){o("text style property 'font' is now deprecated, please use the 'fontFamily', 'fontSize', 'fontStyle', 'fontVariant' and 'fontWeight' properties from now on");var t="number"==typeof this._fontSize?this._fontSize+"px":this._fontSize;return this._fontStyle+" "+this._fontVariant+" "+this._fontWeight+" "+t+" "+this._fontFamily},set:function(t){o("text style property 'font' is now deprecated, please use the 'fontFamily','fontSize',fontStyle','fontVariant' and 'fontWeight' properties from now on"),t.indexOf("italic")>1?this._fontStyle="italic":t.indexOf("oblique")>-1?this._fontStyle="oblique":this._fontStyle="normal",t.indexOf("small-caps")>-1?this._fontVariant="small-caps":this._fontVariant="normal";var e=t.split(" "),i=-1;this._fontSize=26;for(var n=0;n<e.length;++n)if(e[n].match(/(px|pt|em|%)/)){i=n,this._fontSize=e[n];break}this._fontWeight="normal";for(var r=0;r<i;++r)if(e[r].match(/(bold|bolder|lighter|100|200|300|400|500|600|700|800|900)/)){this._fontWeight=e[r];break}if(i>-1&&i<e.length-1){this._fontFamily="";for(var s=i+1;s<e.length;++s)this._fontFamily+=e[s]+" ";this._fontFamily=this._fontFamily.slice(0,-1)}else this._fontFamily="Arial";this.styleID++}}}),s.Texture.prototype.setFrame=function(t){this.frame=t,o("setFrame is now deprecated, please use the frame property, e.g: myTexture.frame = frame;")},Object.defineProperties(f,{AbstractFilter:{get:function(){return o("AstractFilter has been renamed to Filter, please use PIXI.Filter"),s.AbstractFilter}},SpriteMaskFilter:{get:function(){return o("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),s.SpriteMaskFilter}}}),s.utils.uuid=function(){return o("utils.uuid() is deprecated, please use utils.uid() from now on."),s.utils.uid()},s.utils.canUseNewCanvasBlendModes=function(){return o("utils.canUseNewCanvasBlendModes() is deprecated, please use CanvasTinter.canUseMultiply from now on"),s.CanvasTinter.canUseMultiply};var C=!0;Object.defineProperty(s.utils,"_saidHello",{set:function(t){t&&(o("PIXI.utils._saidHello is deprecated, please use PIXI.utils.skipHello()"),this.skipHello()),C=t},get:function(){return C}}),Object.defineProperty(_.canvas,"UPLOADS_PER_FRAME",{set:function(){o("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return o("PIXI.CanvasPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),Object.defineProperty(_.webgl,"UPLOADS_PER_FRAME",{set:function(){o("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please set renderer.plugins.prepare.limiter.maxItemsPerFrame on your renderer")},get:function(){return o("PIXI.WebGLPrepare.UPLOADS_PER_FRAME has been removed. Please use renderer.plugins.prepare.limiter"),NaN}}),Object.defineProperties(x.Resource.prototype,{isJson:{get:function(){return o("The isJson property is deprecated, please use `resource.type === Resource.TYPE.JSON`."),this.type===x.Loader.Resource.TYPE.JSON}},isXml:{get:function(){return o("The isXml property is deprecated, please use `resource.type === Resource.TYPE.XML`."),this.type===x.Loader.Resource.TYPE.XML}},isImage:{get:function(){return o("The isImage property is deprecated, please use `resource.type === Resource.TYPE.IMAGE`."),this.type===x.Loader.Resource.TYPE.IMAGE}},isAudio:{get:function(){return o("The isAudio property is deprecated, please use `resource.type === Resource.TYPE.AUDIO`."),this.type===x.Loader.Resource.TYPE.AUDIO}},isVideo:{get:function(){return o("The isVideo property is deprecated, please use `resource.type === Resource.TYPE.VIDEO`."),this.type===x.Loader.Resource.TYPE.VIDEO}}}),Object.defineProperties(x.Loader.prototype,{before:{get:function(){return o("The before() method is deprecated, please use pre()."),this.pre}},after:{get:function(){return o("The after() method is deprecated, please use use()."),this.use}}}),Object.defineProperty(g.interactiveTarget,"defaultCursor",{set:function(t){o("Property defaultCursor has been replaced with 'cursor'. "),this.cursor=t},get:function(){return o("Property defaultCursor has been replaced with 'cursor'. "),this.cursor},enumerable:!0}),Object.defineProperty(g.InteractionManager,"defaultCursorStyle",{set:function(t){o("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default=t},get:function(){return o("Property defaultCursorStyle has been replaced with 'cursorStyles.default'. "),this.cursorStyles.default}}),Object.defineProperty(g.InteractionManager,"currentCursorStyle",{set:function(t){o("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode=t},get:function(){return o("Property currentCursorStyle has been removed.See the currentCursorMode property, which works differently."),this.currentCursorMode}})},{"./core":64,"./extras":137,"./filters":148,"./interaction":155,"./loaders":158,"./mesh":167,"./particles":170,"./prepare":180}],127:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../core"),s=n(r),a=new s.Rectangle,l=function(){function t(e){o(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function t(e){var t=new Image;return t.src=this.base64(e),t},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0;t&&(r=t instanceof s.RenderTexture?t:e.generateTexture(t)),r?(i=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,o=r.frame):(i=e.rootContext,o=a,o.width=this.renderer.width,o.height=this.renderer.height);var l=o.width*n,u=o.height*n,h=new s.CanvasRenderTarget(l,u),c=i.getImageData(o.x*n,o.y*n,l,u);return h.context.putImageData(c,0,0),h.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0;return t&&(r=t instanceof s.RenderTexture?t:e.generateTexture(t)),r?(i=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,o=r.frame):(i=e.rootContext,o=a,o.width=e.width,o.height=e.height),i.getImageData(0,0,o.width*n,o.height*n).data},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=l,s.CanvasRenderer.registerPlugin("extract",l)},{"../../core":64}],128:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./webgl/WebGLExtract");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return n(o).default}});var r=t("./canvas/CanvasExtract");Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return n(r).default}})},{"./canvas/CanvasExtract":127,"./webgl/WebGLExtract":129}],129:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../../core"),s=n(r),a=new s.Rectangle,l=4,u=function(){function t(e){o(this,t),this.renderer=e,e.extract=this}return t.prototype.image=function t(e){var t=new Image;return t.src=this.base64(e),t},t.prototype.base64=function(t){return this.canvas(t).toDataURL()},t.prototype.canvas=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=!1,u=void 0;t&&(u=t instanceof s.RenderTexture?t:this.renderer.generateTexture(t)),u?(i=u.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],n=i.resolution,o=u.frame,r=!1):(i=this.renderer.rootRenderTarget,n=i.resolution,r=!0,o=a,o.width=i.size.width,o.height=i.size.height);var h=o.width*n,c=o.height*n,p=new s.CanvasRenderTarget(h,c);if(i){e.bindRenderTarget(i);var d=new Uint8Array(l*h*c),f=e.gl;f.readPixels(o.x*n,o.y*n,h,c,f.RGBA,f.UNSIGNED_BYTE,d);var m=p.context.getImageData(0,0,h,c);m.data.set(d),p.context.putImageData(m,0,0),r&&(p.context.scale(1,-1),p.context.drawImage(p.canvas,0,-c))}return p.canvas},t.prototype.pixels=function(t){var e=this.renderer,i=void 0,n=void 0,o=void 0,r=void 0;t&&(r=t instanceof s.RenderTexture?t:this.renderer.generateTexture(t)),r?(i=r.baseTexture._glRenderTargets[this.renderer.CONTEXT_UID],n=i.resolution,o=r.frame):(i=this.renderer.rootRenderTarget,n=i.resolution,o=a,o.width=i.size.width,o.height=i.size.height);var u=o.width*n,h=o.height*n,c=new Uint8Array(l*u*h);if(i){e.bindRenderTarget(i);var p=e.gl;p.readPixels(o.x*n,o.y*n,u,h,p.RGBA,p.UNSIGNED_BYTE,c)}return c},t.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},t}();i.default=u,s.WebGLRenderer.registerPlugin("extract",u)},{"../../core":64}],130:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../core"),u=n(l),h=function(t){function e(i,n){o(this,e);var s=r(this,t.call(this,i[0]instanceof u.Texture?i[0]:i[0].texture));return s._textures=null,s._durations=null,s.textures=i,s._autoUpdate=n!==!1,s.animationSpeed=1,s.loop=!0,s.onComplete=null,s.onFrameChange=null,s._currentTime=0,s.playing=!1,s}return s(e,t),e.prototype.stop=function(){this.playing&&(this.playing=!1,this._autoUpdate&&u.ticker.shared.remove(this.update,this))},e.prototype.play=function(){this.playing||(this.playing=!0,this._autoUpdate&&u.ticker.shared.add(this.update,this))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){var e=this.animationSpeed*t,i=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=e/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&this.updateTexture()},e.prototype.updateTexture=function(){this._texture=this._textures[this.currentFrame],this._textureID=-1,this.onFrameChange&&this.onFrameChange(this.currentFrame)},e.prototype.destroy=function(){this.stop(),t.prototype.destroy.call(this)},e.fromFrames=function(t){for(var i=[],n=0;n<t.length;++n)i.push(u.Texture.fromFrame(t[n]));return new e(i)},e.fromImages=function(t){for(var i=[],n=0;n<t.length;++n)i.push(u.Texture.fromImage(t[n]));return new e(i)},a(e,[{key:"totalFrames",get:function(){return this._textures.length}},{key:"textures",get:function(){return this._textures},set:function(t){if(t[0]instanceof u.Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}}},{key:"currentFrame",get:function(){var t=Math.floor(this._currentTime)%this._textures.length;
return t<0&&(t+=this._textures.length),t}}]),e}(u.Sprite);i.default=h},{"../core":64}],131:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("../core"),h=o(u),c=t("../core/math/ObservablePoint"),p=n(c),d=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,e);var o=s(this,t.call(this));return o._textWidth=0,o._textHeight=0,o._glyphs=[],o._font={tint:void 0!==n.tint?n.tint:16777215,align:n.align||"left",name:null,size:0},o.font=n.font,o._text=i,o.maxWidth=0,o.maxLineHeight=0,o._anchor=new p.default(function(){o.dirty=!0},o,0,0),o.dirty=!1,o.updateText(),o}return a(e,t),e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],i=this._font.size/t.size,n=new h.Point,o=[],r=[],s=null,a=0,l=0,u=0,c=-1,p=0,d=0,f=0;f<this.text.length;f++){var m=this.text.charCodeAt(f);if(/(\s)/.test(this.text.charAt(f))&&(c=f,p=a),/(?:\r\n|\r|\n)/.test(this.text.charAt(f)))r.push(a),l=Math.max(l,a),u++,n.x=0,n.y+=t.lineHeight,s=null;else if(c!==-1&&this.maxWidth>0&&n.x*i>this.maxWidth)h.utils.removeItems(o,c,f-c),f=c,c=-1,r.push(p),l=Math.max(l,p),u++,n.x=0,n.y+=t.lineHeight,s=null;else{var _=t.chars[m];_&&(s&&_.kerning[s]&&(n.x+=_.kerning[s]),o.push({texture:_.texture,line:u,charCode:m,position:new h.Point(n.x+_.xOffset,n.y+_.yOffset)}),a=n.x+(_.texture.width+_.xOffset),n.x+=_.xAdvance,d=Math.max(d,_.yOffset+_.texture.height),s=m)}}r.push(a),l=Math.max(l,a);for(var y=[],x=0;x<=u;x++){var v=0;"right"===this._font.align?v=l-r[x]:"center"===this._font.align&&(v=(l-r[x])/2),y.push(v)}for(var g=o.length,b=this.tint,w=0;w<g;w++){var S=this._glyphs[w];S?S.texture=o[w].texture:(S=new h.Sprite(o[w].texture),this._glyphs.push(S)),S.position.x=(o[w].position.x+y[o[w].line])*i,S.position.y=o[w].position.y*i,S.scale.x=S.scale.y=i,S.tint=b,S.parent||this.addChild(S)}for(var C=g;C<this._glyphs.length;++C)this.removeChild(this._glyphs[C]);if(this._textWidth=l*i,this._textHeight=(n.y+t.lineHeight)*i,0!==this.anchor.x||0!==this.anchor.y)for(var D=0;D<g;D++)this._glyphs[D].x-=this._textWidth*this.anchor.x,this._glyphs[D].y-=this._textHeight*this.anchor.y;this.maxLineHeight=d*i},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},e.registerFont=function(t,i){var n={},o=t.getElementsByTagName("info")[0],r=t.getElementsByTagName("common")[0];n.font=o.getAttribute("face"),n.size=parseInt(o.getAttribute("size"),10),n.lineHeight=parseInt(r.getAttribute("lineHeight"),10),n.chars={};for(var s=t.getElementsByTagName("char"),a=0;a<s.length;a++){var l=s[a],u=parseInt(l.getAttribute("id"),10),c=new h.Rectangle(parseInt(l.getAttribute("x"),10)+i.frame.x,parseInt(l.getAttribute("y"),10)+i.frame.y,parseInt(l.getAttribute("width"),10),parseInt(l.getAttribute("height"),10));n.chars[u]={xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{},texture:new h.Texture(i.baseTexture,c)}}for(var p=t.getElementsByTagName("kerning"),d=0;d<p.length;d++){var f=p[d],m=parseInt(f.getAttribute("first"),10),_=parseInt(f.getAttribute("second"),10),y=parseInt(f.getAttribute("amount"),10);n.chars[_]&&(n.chars[_].kerning[m]=y)}return e.fonts[n.font]=n,n},l(e,[{key:"tint",get:function(){return this._font.tint},set:function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0}},{key:"align",get:function(){return this._font.align},set:function(t){this._font.align=t||"left",this.dirty=!0}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copy(t)}},{key:"font",get:function(){return this._font},set:function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)}},{key:"text",get:function(){return this._text},set:function(t){t=t.toString()||" ",this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}}]),e}(h.Container);i.default=d,d.fonts={}},{"../core":64,"../core/math/ObservablePoint":67}],132:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("../core/math/Matrix"),a=n(s),l=new a.default,u=function(){function t(e,i){o(this,t),this._texture=e,this.mapCoord=new a.default,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._lastTextureID=-1,this.clampOffset=0,this.clampMargin="undefined"==typeof i?.5:i}return t.prototype.update=function(t){var e=this._texture;if(e&&e.valid&&(t||this._lastTextureID!==e._updateID)){this._lastTextureID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var n=e.orig,o=e.trim;o&&(l.set(n.width/o.width,0,0,n.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(l));var r=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/r.resolution,u=this.clampOffset;s[0]=(e._frame.x+a+u)/r.width,s[1]=(e._frame.y+a+u)/r.height,s[2]=(e._frame.x+e._frame.width-a+u)/r.width,s[3]=(e._frame.y+e._frame.height-a+u)/r.height,this.uClampOffset[0]=u/r.realWidth,this.uClampOffset[1]=u/r.realHeight}},r(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._lastTextureID=-1}}]),t}();i.default=u},{"../core/math/Matrix":66}],133:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("../core"),h=o(u),c=t("../core/sprites/canvas/CanvasTinter"),p=n(c),d=t("./TextureTransform"),f=n(d),m=new h.Point,_=function(t){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;r(this,e);var a=s(this,t.call(this,i));return a.tileTransform=new h.TransformStatic,a._width=n,a._height=o,a._canvasPattern=null,a.uvTransform=i.transform||new f.default(i),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return a(e,t),e.prototype._onTextureUpdate=function(){this.uvTransform&&(this.uvTransform.texture=this._texture)},e.prototype._renderWebGL=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvTransform.update(),t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._renderCanvas=function(t){var e=this._texture;if(e.baseTexture.hasLoaded){var i=t.context,n=this.worldTransform,o=t.resolution,r=e.baseTexture,s=e.baseTexture.resolution,a=this.tilePosition.x/this.tileScale.x%e._frame.width,l=this.tilePosition.y/this.tileScale.y%e._frame.height;if(!this._canvasPattern){var u=new h.CanvasRenderTarget(e._frame.width,e._frame.height,s);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=p.default.getTintedTexture(this,this.tint)),u.context.drawImage(this.tintedTexture,0,0)):u.context.drawImage(r.source,-e._frame.x,-e._frame.y),this._canvasPattern=u.context.createPattern(u.canvas,"repeat")}i.globalAlpha=this.worldAlpha,i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t.setBlendMode(this.blendMode),i.fillStyle=this._canvasPattern,i.scale(this.tileScale.x/s,this.tileScale.y/s);var c=this.anchor.x*-this._width,d=this.anchor.y*-this._height;this.uvRespectAnchor?(i.translate(a,l),i.fillRect(-a+c,-l+d,this._width/this.tileScale.x*s,this._height/this.tileScale.y*s)):(i.translate(a+c,l+d),i.fillRect(-a,-l,this._width/this.tileScale.x*s,this._height/this.tileScale.y*s))}},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,n)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._x),e||(this._localBoundsRect||(this._localBoundsRect=new h.Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,m);var e=this._width,i=this._height,n=-e*this.anchor._x;if(m.x>n&&m.x<n+e){var o=-i*this.anchor._y;if(m.y>o&&m.y<o+i)return!0}return!1},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.tileTransform=null,this.uvTransform=null},e.from=function(t,i,n){return new e(h.Texture.from(t),i,n)},e.fromFrame=function(t,i,n){var o=h.utils.TextureCache[t];if(!o)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(o,i,n)},e.fromImage=function(t,i,n,o,r){return new e(h.Texture.fromImage(t,o,r),i,n)},l(e,[{key:"clampMargin",get:function(){return this.uvTransform.clampMargin},set:function(t){this.uvTransform.clampMargin=t,this.uvTransform.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copy(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copy(t)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}]),e}(h.Sprite);i.default=_},{"../core":64,"../core/sprites/canvas/CanvasTinter":103,"./TextureTransform":132}],134:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=t("../core"),s=n(r),a=s.DisplayObject,l=new s.Matrix;a.prototype._cacheAsBitmap=!1,a.prototype._cacheData=!1;var u=function t(){o(this,t),this.originalRenderWebGL=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(a.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap!==t){this._cacheAsBitmap=t;var e=void 0;t?(this._cacheData||(this._cacheData=new u),e=this._cacheData,e.originalRenderWebGL=this.renderWebGL,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this._calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(e=this._cacheData,e.sprite&&this._destroyCachedDisplayObject(),this.renderWebGL=e.originalRenderWebGL,this.renderCanvas=e.originalRenderCanvas,this._calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),a.prototype._renderCachedWebGL=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite._transformID=-1,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderWebGL(t))},a.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.currentRenderer.flush();var i=this.getLocalBounds().clone();if(this._filters){var n=this._filters[0].padding;i.pad(n)}var o=t._activeRenderTarget,r=t.filterManager.filterStack,a=s.RenderTexture.create(0|i.width,0|i.height),u=l;u.tx=-i.x,u.ty=-i.y,this.transform.worldTransform.identity(),this.renderWebGL=this._cacheData.originalRenderWebGL,t.render(this,a,!0,u,!0),t.bindRenderTarget(o),t.filterManager.filterStack=r,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this._mask=null,this.filterArea=null;var h=new s.Sprite(a);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(i.x/i.width),h.anchor.y=-(i.y/i.height),h.alpha=e,h._bounds=this._bounds,this._calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.updateTransform(),this.containsPoint=h.containsPoint.bind(h)}},a.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite.renderCanvas(t))},a.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var n=t.context,o=s.RenderTexture.create(0|e.width,0|e.height),r=l;this.transform.localTransform.copy(r),r.invert(),r.tx-=e.x,r.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,o,!0,r,!1),t.context=n,this.renderCanvas=this._renderCachedCanvas,this._calculateBounds=this._calculateCachedBounds,this._mask=null,this.filterArea=null;var a=new s.Sprite(o);a.transform.worldTransform=this.transform.worldTransform,a.anchor.x=-(e.x/e.width),a.anchor.y=-(e.y/e.height),a._bounds=this._bounds,a.alpha=i,this.updateTransform(),this.updateTransform=this.displayObjectUpdateTransform,this._cacheData.sprite=a,this.containsPoint=a.containsPoint.bind(a)}},a.prototype._calculateCachedBounds=function(){this._cacheData.sprite._calculateBounds()},a.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},a.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null},a.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this.destroy()}},{"../core":64}],135:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var o=t("../core"),r=n(o);r.DisplayObject.prototype.name=null,r.Container.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null}},{"../core":64}],136:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var o=t("../core"),r=n(o);r.DisplayObject.prototype.getGlobalPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Point,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t}},{"../core":64}],137:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,i.BitmapText=i.TilingSpriteRenderer=i.TilingSprite=i.AnimatedSprite=i.TextureTransform=void 0;var o=t("./TextureTransform");Object.defineProperty(i,"TextureTransform",{enumerable:!0,get:function(){return n(o).default}});var r=t("./AnimatedSprite");Object.defineProperty(i,"AnimatedSprite",{enumerable:!0,get:function(){return n(r).default}});var s=t("./TilingSprite");Object.defineProperty(i,"TilingSprite",{enumerable:!0,get:function(){return n(s).default}});var a=t("./webgl/TilingSpriteRenderer");Object.defineProperty(i,"TilingSpriteRenderer",{enumerable:!0,get:function(){return n(a).default}});var l=t("./BitmapText");Object.defineProperty(i,"BitmapText",{enumerable:!0,get:function(){return n(l).default}}),t("./cacheAsBitmap"),t("./getChildByName"),t("./getGlobalPosition")},{"./AnimatedSprite":130,"./BitmapText":131,"./TextureTransform":132,"./TilingSprite":133,"./cacheAsBitmap":134,"./getChildByName":135,"./getGlobalPosition":136,"./webgl/TilingSpriteRenderer":138}],138:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../core"),l=n(a),u=t("../../core/const"),h=(t("path"),new l.Matrix),c=new Float32Array(4),p=function(t){function e(i){o(this,e);var n=r(this,t.call(this,i));return n.shader=null,n.simpleShader=null,n.quad=null,n}return s(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new l.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n\n    gl_FragColor = sample * color ;\n}\n"),this.simpleShader=new l.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    vec4 color = vec4(uColor.rgb * uColor.a, uColor.a);\n    gl_FragColor = sample * color;\n}\n"),this.renderer.bindVao(null),this.quad=new l.Quad(t,this.renderer.state.attribState),this.quad.initVao(this.shader)},e.prototype.render=function(t){var e=this.renderer,i=this.quad;e.bindVao(i.vao);var n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&(n=i.uvs,n[0]=n[6]=-t.anchor.x,n[1]=n[3]=-t.anchor.y,n[2]=n[4]=1-t.anchor.x,n[5]=n[7]=1-t.anchor.y),i.upload();var o=t._texture,r=o.baseTexture,s=t.tileTransform.localTransform,a=t.uvTransform,p=r.isPowerOfTwo&&o.frame.width===r.width&&o.frame.height===r.height;p&&(r._glTextures[e.CONTEXT_UID]?p=r.wrapMode!==u.WRAP_MODES.CLAMP:r.wrapMode===u.WRAP_MODES.CLAMP&&(r.wrapMode=u.WRAP_MODES.REPEAT));var d=p?this.simpleShader:this.shader;e.bindShader(d);var f=o.width,m=o.height,_=t._width,y=t._height;h.set(s.a*f/_,s.b*f/y,s.c*m/_,s.d*m/y,s.tx/_,s.ty/y),h.invert(),p?h.append(a.mapCoord):(d.uniforms.uMapCoord=a.mapCoord.toArray(!0),d.uniforms.uClampFrame=a.uClampFrame,d.uniforms.uClampOffset=a.uClampOffset),d.uniforms.uTransform=h.toArray(!0);var x=c;l.utils.hex2rgb(t.tint,x),x[3]=t.worldAlpha,d.uniforms.uColor=x,d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=e.bindTexture(o),e.setBlendMode(t.blendMode),i.vao.draw(this.renderer.gl.TRIANGLES,6,0)},e}(l.ObjectRenderer);i.default=p,l.WebGLRenderer.registerPlugin("tilingSprite",p)},{"../../core":64,"../../core/const":45,path:23}],139:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("../../core"),h=o(u),c=t("./BlurXFilter"),p=n(c),d=t("./BlurYFilter"),f=n(d),m=function(t){function e(i,n,o,a){r(this,e);var l=s(this,t.call(this));return l.blurXFilter=new p.default(i,n,o,a),l.blurYFilter=new f.default(i,n,o,a),l.padding=0,l.resolution=o||h.settings.RESOLUTION,l.quality=n||4,l.blur=i||8,l}return a(e,t),e.prototype.apply=function(t,e,i){var n=t.getRenderTarget(!0);this.blurXFilter.apply(t,e,n,!0),this.blurYFilter.apply(t,n,i,!1),t.returnRenderTarget(n)},l(e,[{key:"blur",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"quality",get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t}},{key:"blurX",get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}},{key:"blurY",get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}}]),e}(h.Filter);i.default=m},{"../../core":64,"./BlurXFilter":140,"./BlurYFilter":141}],140:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("../../core"),h=o(u),c=t("./generateBlurVertSource"),p=n(c),d=t("./generateBlurFragSource"),f=n(d),m=t("./getMaxBlurKernelSize"),_=n(m),y=function(t){function e(i,n,o,a){r(this,e),a=a||5;var l=(0,p.default)(a,!0),u=(0,f.default)(a),c=s(this,t.call(this,l,u));return c.resolution=o||h.settings.RESOLUTION,c._quality=0,c.quality=n||4,c.strength=i||8,c.firstRun=!0,c}return a(e,t),e.prototype.apply=function(t,e,i,n){if(this.firstRun){var o=t.renderer.gl,r=(0,_.default)(o);this.vertexSrc=(0,p.default)(r,!0),this.fragmentSrc=(0,f.default)(r),this.firstRun=!1}if(this.uniforms.strength=1/i.size.width*(i.size.width/e.size.width),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var s=t.getRenderTarget(!0),a=e,l=s,u=0;u<this.passes-1;u++){t.applyFilter(this,a,l,!0);var h=l;l=a,a=h}t.applyFilter(this,a,i,n),t.returnRenderTarget(s)}},l(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(h.Filter);i.default=y},{"../../core":64,"./generateBlurFragSource":142,"./generateBlurVertSource":143,"./getMaxBlurKernelSize":144}],141:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=t("../../core"),h=o(u),c=t("./generateBlurVertSource"),p=n(c),d=t("./generateBlurFragSource"),f=n(d),m=t("./getMaxBlurKernelSize"),_=n(m),y=function(t){function e(i,n,o,a){r(this,e),a=a||5;var l=(0,p.default)(a,!1),u=(0,f.default)(a),c=s(this,t.call(this,l,u));return c.resolution=o||h.settings.RESOLUTION,c._quality=0,c.quality=n||4,c.strength=i||8,c.firstRun=!0,c}return a(e,t),e.prototype.apply=function(t,e,i,n){if(this.firstRun){var o=t.renderer.gl,r=(0,_.default)(o);this.vertexSrc=(0,p.default)(r,!1),this.fragmentSrc=(0,f.default)(r),this.firstRun=!1}if(this.uniforms.strength=1/i.size.height*(i.size.height/e.size.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,i,n);else{for(var s=t.getRenderTarget(!0),a=e,l=s,u=0;u<this.passes-1;u++){t.applyFilter(this,a,l,!0);var h=l;l=a,a=h}t.applyFilter(this,a,i,n),t.returnRenderTarget(s)}},l(e,[{key:"blur",get:function(){return this.strength},set:function(t){this.padding=2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),e}(h.Filter);i.default=y},{"../../core":64,"./generateBlurFragSource":142,"./generateBlurVertSource":143,"./getMaxBlurKernelSize":144}],142:[function(t,e,i){"use strict";function n(t){for(var e=o[t],i=e.length,n=r,s="",a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;",l=void 0,u=0;u<t;u++){var h=a.replace("%index%",u);l=u,u>=i&&(l=t-u-1),h=h.replace("%value%",e[l]),s+=h,s+="\n"}return n=n.replace("%blur%",s),n=n.replace("%size%",t)}i.__esModule=!0,i.default=n;var o={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},r=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n")},{}],143:[function(t,e,i){"use strict";function n(t,e){var i=Math.ceil(t/2),n=o,r="",s=void 0;s=e?"vBlurTexCoords[%index%] = aTextureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] = aTextureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var l=s.replace("%index%",a);l=l.replace("%sampleIndex%",a-(i-1)+".0"),r+=l,r+="\n"}return n=n.replace("%blur%",r),n=n.replace("%size%",t)}i.__esModule=!0,i.default=n;var o=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform float strength;","uniform mat3 projectionMatrix;","varying vec2 vBlurTexCoords[%size%];","void main(void)","{","gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);","%blur%","}"].join("\n")},{}],144:[function(t,e,i){"use strict";function n(t){for(var e=t.getParameter(t.MAX_VARYING_VECTORS),i=15;i>e;)i-=2;return i}i.__esModule=!0,i.default=n},{}],145:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../core"),u=n(l),h=(t("path"),function(t){function e(){o(this,e);var i=r(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n    vec4 result;\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    // Premultiply alpha again.\n    result.rgb *= result.a;\n\n    gl_FragColor = result;\n}\n"));return i.uniforms.m=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],i}return s(e,t),e.prototype._loadMatrix=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.blackAndWhite=function(t){var e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),n=Math.sin(t),o=Math.sqrt,r=1/3,s=o(r),a=i+(1-i)*r,l=r*(1-i)-s*n,u=r*(1-i)+s*n,h=r*(1-i)+s*n,c=i+r*(1-i),p=r*(1-i)-s*n,d=r*(1-i)-s*n,f=r*(1-i)+s*n,m=i+r*(1-i),_=[a,l,u,0,0,h,c,p,0,0,d,f,m,0,0,0,0,0,1,0];this._loadMatrix(_,e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,n=-128*(i-1),o=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.saturate=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1],i=2*t/3+1,n=(i-1)*-.5,o=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){var e=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.sepia=function(t){var e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.technicolor=function(t){var e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.polaroid=function(t){var e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.toBGR=function(t){var e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.kodachrome=function(t){var e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.browni=function(t){var e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.vintage=function(t){var e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.colorTone=function(t,e,i,n,o){t=t||.2,e=e||.15,i=i||16770432,n=n||3375104;var r=(i>>16&255)/255,s=(i>>8&255)/255,a=(255&i)/255,l=(n>>16&255)/255,u=(n>>8&255)/255,h=(255&n)/255,c=[.3,.59,.11,0,0,r,s,a,t,0,l,u,h,e,0,r-l,s-u,a-h,0,0];this._loadMatrix(c,o)},e.prototype.night=function(t,e){t=t||.1;var i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.lsd=function(t){var e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)},e.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)},a(e,[{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}}]),e}(u.Filter));i.default=h,h.prototype.grayscale=h.prototype.greyscale},{"../../core":64,path:23}],146:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../core"),u=n(l),h=(t("path"),function(t){function e(i,n){o(this,e);var s=new u.Matrix;i.renderable=!1;var a=r(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord;\n}","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), filterClamp.xy, filterClamp.zw));\n}\n"));return a.maskSprite=i,a.maskMatrix=s,a.uniforms.mapSampler=i.texture,a.uniforms.filterMatrix=s,a.uniforms.scale={x:1,y:1},null!==n&&void 0!==n||(n=20),a.scale=new u.Point(n,n),a}return s(e,t),e.prototype.apply=function(t,e,i){var n=1/i.destinationFrame.width*(i.size.width/e.size.width);this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x*n,this.uniforms.scale.y=this.scale.y*n,t.applyFilter(this,e,i)},a(e,[{key:"map",get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t}}]),e}(u.Filter));i.default=h},{"../../core":64,path:23}],147:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../core"),l=n(a),u=(t("path"),function(t){function e(){return o(this,e),r(this,t.call(this,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec4 filterArea;\n\nvarying vec2 vTextureCoord;\n\nvec2 mapCoord( vec2 coord )\n{\n    coord *= filterArea.xy;\n    coord += filterArea.zw;\n\n    return coord;\n}\n\nvec2 unmapCoord( vec2 coord )\n{\n    coord -= filterArea.zw;\n    coord /= filterArea.xy;\n\n    return coord;\n}\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n   vTextureCoord = aTextureCoord;\n\n   vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n   texcoords(fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec4 filterArea;\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n \n --\n \n From:\n https://github.com/mitsuhiko/webgl-meincraft\n \n Copyright (c) 2011 by Armin Ronacher.\n \n Some rights reserved.\n \n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n \n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n \n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n \n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n \n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec2 fragCoord = vTextureCoord * filterArea.xy;\n\n      vec4 color;\n\n    color = fxaa(uSampler, fragCoord, filterArea.xy, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n'))}return s(e,t),e}(l.Filter));i.default=u},{"../../core":64,path:23}],148:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./fxaa/FXAAFilter");Object.defineProperty(i,"FXAAFilter",{enumerable:!0,get:function(){return n(o).default}});var r=t("./noise/NoiseFilter");Object.defineProperty(i,"NoiseFilter",{enumerable:!0,get:function(){return n(r).default}});var s=t("./displacement/DisplacementFilter");Object.defineProperty(i,"DisplacementFilter",{enumerable:!0,get:function(){return n(s).default}});var a=t("./blur/BlurFilter");Object.defineProperty(i,"BlurFilter",{enumerable:!0,get:function(){return n(a).default}});var l=t("./blur/BlurXFilter");Object.defineProperty(i,"BlurXFilter",{enumerable:!0,get:function(){return n(l).default}});var u=t("./blur/BlurYFilter");Object.defineProperty(i,"BlurYFilter",{enumerable:!0,get:function(){return n(u).default}});var h=t("./colormatrix/ColorMatrixFilter");Object.defineProperty(i,"ColorMatrixFilter",{enumerable:!0,get:function(){return n(h).default}});var c=t("./void/VoidFilter");Object.defineProperty(i,"VoidFilter",{enumerable:!0,get:function(){return n(c).default}})},{"./blur/BlurFilter":139,"./blur/BlurXFilter":140,"./blur/BlurYFilter":141,"./colormatrix/ColorMatrixFilter":145,"./displacement/DisplacementFilter":146,"./fxaa/FXAAFilter":147,"./noise/NoiseFilter":149,"./void/VoidFilter":150}],149:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../core"),u=n(l),h=(t("path"),function(t){function e(){o(this,e);var i=r(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(gl_FragCoord.xy) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n"));return i.noise=.5,i}return s(e,t),a(e,[{key:"noise",get:function(){return this.uniforms.noise},set:function(t){this.uniforms.noise=t}}]),e}(u.Filter));i.default=h},{"../../core":64,path:23}],150:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../core"),l=n(a),u=(t("path"),function(t){function e(){o(this,e);var i=r(this,t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"));return i.glShaderKey="void",i}return s(e,t),e}(l.Filter));i.default=u},{"../../core":64,path:23}],151:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("../core"),s=n(r),a=function(){function t(){o(this,t),this.global=new s.Point,this.target=null,this.originalEvent=null,this.identifier=null}return t.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},t}();i.default=a},{"../core":64}],152:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(){n(this,t),this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0},t.prototype._reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null},t}();i.default=o},{}],153:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=t("../core"),h=o(u),c=t("./InteractionData"),p=n(c),d=t("./InteractionEvent"),f=n(d),m=t("./InteractionTrackingData"),_=n(m),y=t("eventemitter3"),x=n(y),v=t("./interactiveTarget"),g=n(v);h.utils.mixins.delayMixin(h.DisplayObject.prototype,g.default);var b="MOUSE",w=function(t){function e(i,n){r(this,e);var o=s(this,t.call(this));return n=n||{},o.renderer=i,o.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,o.interactionFrequency=n.interactionFrequency||10,o.mouse=new p.default,o.mouse.identifier=b,o.mouse.global.set(-999999),o.activeInteractionData={},o.activeInteractionData[b]=o.mouse,o.interactionDataPool=[],o.eventData=new f.default,o.interactionDOMElement=null,o.moveWhenInside=!1,o.eventsAdded=!1,o.mouseOverRenderer=!1,o.supportsTouchEvents="ontouchstart"in window,o.supportsPointerEvents=!!window.PointerEvent,o.onPointerUp=o.onPointerUp.bind(o),o.processPointerUp=o.processPointerUp.bind(o),o.onPointerCancel=o.onPointerCancel.bind(o),o.processPointerCancel=o.processPointerCancel.bind(o),o.onPointerDown=o.onPointerDown.bind(o),o.processPointerDown=o.processPointerDown.bind(o),o.onPointerMove=o.onPointerMove.bind(o),o.processPointerMove=o.processPointerMove.bind(o),o.onPointerOut=o.onPointerOut.bind(o),o.processPointerOverOut=o.processPointerOverOut.bind(o),o.onPointerOver=o.onPointerOver.bind(o),o.cursorStyles={default:"inherit",pointer:"pointer"},o.currentCursorMode=null,o.cursor=null,o._tempPoint=new h.Point,o.resolution=1,o.setTargetElement(o.renderer.view,o.renderer.resolution),o}return a(e,t),e.prototype.setTargetElement=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(h.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0))),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(h.ticker.shared.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor=null;for(var e in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(n,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch("undefined"==typeof e?"undefined":l(e)){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}}},e.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.mapPositionToPoint=function(t,e,i){var n=void 0;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var o=navigator.isCocoonJS?this.resolution:1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*o,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*o},e.prototype.processInteractive=function(t,e,i,n,o){if(!e||!e.visible)return!1;var r=t.data.global;o=e.interactive||o;var s=!1,a=o;e.hitArea?a=!1:n&&e._mask&&(e._mask.containsPoint(r)||(n=!1));var l=n;if(e.interactiveChildren&&e.children)for(var u=e.children,h=u.length-1;h>=0;h--){var c=u[h];if(this.processInteractive(t,c,i,n,a)){if(!c.parent)continue;s=!0,a=!1,l=!1,c.interactive&&(n=!1)}}return n=l,o&&(n&&!s&&(e.hitArea?(e.worldTransform.applyInverse(r,this._tempPoint),s=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):e.containsPoint&&(s=e.containsPoint(r))),e.interactive&&(s&&!t.target&&(t.target=e),i(t,e,s))),s},e.prototype.onPointerDown=function(t){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&t.preventDefault();for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);if(s.data.originalEvent=t,this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===o.pointerType)this.emit("touchstart",s);else if("mouse"===o.pointerType){var a=2===o.button||3===o.which;this.emit(a?"rightdown":"mousedown",this.eventData)}}},e.prototype.processPointerDown=function(t,e,i){var n=t.data.originalEvent,o=t.data.identifier;if(i)if(e.trackedPointers[o]||(e.trackedPointers[o]=new _.default(o)),this.dispatchEvent(e,"pointerdown",t),"touchstart"===n.type||"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mousedown"===n.type||"mouse"===n.pointerType){var r=2===n.button||3===n.which;r?e.trackedPointers[o].rightDown=!0:e.trackedPointers[o].leftDown=!0,this.dispatchEvent(e,r?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var n=this.normalizeToPointerData(t),o=n.length,r=0;r<o;r++){var s=n[r],a=this.getInteractionDataForPointerId(s),l=this.configureInteractionEventForDOMEvent(this.eventData,s,a);
if(l.data.originalEvent=t,this.processInteractive(l,this.renderer._lastObjectRendered,i,!0),this.emit(e?"pointercancel":"pointerup",l),"mouse"===s.pointerType){var u=2===s.button||3===s.which;this.emit(u?"rightup":"mouseup",l)}else"touch"===s.pointerType&&(this.emit(e?"touchcancel":"touchend",l),this.releaseInteractionDataForPointerId(s.pointerId,a))}},e.prototype.onPointerCancel=function(t){this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data.originalEvent,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touchcancel"!==i.type&&"touch"!==i.pointerType||this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var n=t.data.originalEvent,o=t.data.identifier,r=e.trackedPointers[o],s="touchend"===n.type||"touch"===n.pointerType,a=0===n.type.indexOf("mouse")||"mouse"===n.pointerType;if(a){var l=2===n.button||3===n.which,u=_.default.FLAGS,h=l?u.RIGHT_DOWN:u.LEFT_DOWN,c=void 0!==r&&r.flags&h;i?(this.dispatchEvent(e,l?"rightup":"mouseup",t),c&&this.dispatchEvent(e,l?"rightclick":"click",t)):c&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),r&&(l?r.rightDown=i:r.leftDown=i)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),r&&(this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),r.over=!1))):r&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),r&&r.none&&delete e.trackedPointers[o]},e.prototype.onPointerMove=function(t){var e=this.normalizeToPointerData(t);"mouse"===e[0].pointerType&&(this.didMove=!0,this.cursor=null);for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);s.data.originalEvent=t;var a="touch"!==o.pointerType||this.moveWhenInside;this.processInteractive(s,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",s),"touch"===o.pointerType&&this.emit("touchmove",s),"mouse"===o.pointerType&&this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)},e.prototype.processPointerMove=function(t,e,i){var n=t.data.originalEvent,o="touchmove"===n.type||"touch"===n.pointerType,r="mousemove"===n.type||"mouse"===n.pointerType;r&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),o&&this.dispatchEvent(e,"touchmove",t),r&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){var e=this.normalizeToPointerData(t),i=e[0];"mouse"===i.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,n);o.data.originalEvent=i,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),"mouse"===i.pointerType&&this.emit("mouseout",o)},e.prototype.processPointerOverOut=function(t,e,i){var n=t.data.originalEvent,o=t.data.identifier,r="mouseover"===n.type||"mouseout"===n.type||"mouse"===n.pointerType,s=e.trackedPointers[o];i&&!s&&(s=e.trackedPointers[o]=new _.default(o)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.dispatchEvent(e,"pointerover",t),r&&this.dispatchEvent(e,"mouseover",t)),r&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),r&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[o]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t),i=e[0],n=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,n);o.data.originalEvent=i,"mouse"===i.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),"mouse"===i.pointerType&&this.emit("mouseover",o)},e.prototype.getInteractionDataForPointerId=function(t){var e=t.pointerId;if(e===b||"mouse"===t.pointerType)return this.mouse;if(this.activeInteractionData[e])return this.activeInteractionData[e];var i=this.interactionDataPool.pop()||new p.default;return i.identifier=e,this.activeInteractionData[e]=i,i},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),navigator.isCocoonJS&&"touch"===e.pointerType&&(i.global.x=i.global.x/this.resolution,i.global.y=i.global.y/this.resolution),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t._reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var o=t.changedTouches[i];"undefined"==typeof o.button&&(o.button=t.touches.length?1:0),"undefined"==typeof o.buttons&&(o.buttons=t.touches.length?1:0),"undefined"==typeof o.isPrimary&&(o.isPrimary=1===t.touches.length),"undefined"==typeof o.width&&(o.width=o.radiusX||1),"undefined"==typeof o.height&&(o.height=o.radiusY||1),"undefined"==typeof o.tiltX&&(o.tiltX=0),"undefined"==typeof o.tiltY&&(o.tiltY=0),"undefined"==typeof o.pointerType&&(o.pointerType="touch"),"undefined"==typeof o.pointerId&&(o.pointerId=o.identifier||0),"undefined"==typeof o.pressure&&(o.pressure=o.force||.5),"undefined"==typeof o.rotation&&(o.rotation=o.rotationAngle||0),"undefined"==typeof o.layerX&&(o.layerX=o.offsetX=o.clientX),"undefined"==typeof o.layerY&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,e.push(o)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):("undefined"==typeof t.isPrimary&&(t.isPrimary=!0),"undefined"==typeof t.width&&(t.width=1),"undefined"==typeof t.height&&(t.height=1),"undefined"==typeof t.tiltX&&(t.tiltX=0),"undefined"==typeof t.tiltY&&(t.tiltY=0),"undefined"==typeof t.pointerType&&(t.pointerType="mouse"),"undefined"==typeof t.pointerId&&(t.pointerId=b),"undefined"==typeof t.pressure&&(t.pressure=.5),"undefined"==typeof t.rotation&&(t.rotation=0),t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(x.default);i.default=w,h.WebGLRenderer.registerPlugin("interaction",w),h.CanvasRenderer.registerPlugin("interaction",w)},{"../core":64,"./InteractionData":151,"./InteractionEvent":152,"./InteractionTrackingData":154,"./interactiveTarget":156,eventemitter3:3}],154:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){n(this,t),this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){e?this._flags=this._flags|t:this._flags=this._flags&~t},o(t,[{key:"pointerId",get:function(){return this._pointerId}},{key:"flags",get:function(){return this._flags},set:function(t){this._flags=t}},{key:"none",get:function(){return this._flags===this.constructor.FLAGS.NONE}},{key:"over",get:function(){return 0!==(this._flags&this.constructor.FLAGS.OVER)},set:function(t){this._doSet(this.constructor.FLAGS.OVER,t)}},{key:"rightDown",get:function(){return 0!==(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)}},{key:"leftDown",get:function(){return 0!==(this._flags&this.constructor.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)}}]),t}();i.default=r,r.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4})},{}],155:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./InteractionData");Object.defineProperty(i,"InteractionData",{enumerable:!0,get:function(){return n(o).default}});var r=t("./InteractionManager");Object.defineProperty(i,"InteractionManager",{enumerable:!0,get:function(){return n(r).default}});var s=t("./interactiveTarget");Object.defineProperty(i,"interactiveTarget",{enumerable:!0,get:function(){return n(s).default}})},{"./InteractionData":151,"./InteractionManager":153,"./interactiveTarget":156}],156:[function(t,e,i){"use strict";i.__esModule=!0,i.default={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0}},{}],157:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){t.bitmapFont=u.BitmapText.registerFont(t.data,e)}i.__esModule=!0,i.parse=o,i.default=function(){return function(t,e){if(!t.data||t.type!==l.Resource.TYPE.XML)return void e();if(0===t.data.getElementsByTagName("page").length||0===t.data.getElementsByTagName("info").length||null===t.data.getElementsByTagName("info")[0].getAttribute("face"))return void e();var i=t.isDataUrl?"":s.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/"),i=i.replace(this.baseUrl,""))),i&&"/"!==i.charAt(i.length-1)&&(i+="/");var n=i+t.data.getElementsByTagName("page")[0].getAttribute("file");if(a.utils.TextureCache[n])o(t,a.utils.TextureCache[n]),e();else{var r={crossOrigin:t.crossOrigin,loadType:l.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t};this.add(t.name+"_image",n,r,function(i){o(t,i.texture),e()})}}};var r=t("path"),s=n(r),a=t("../core"),l=t("resource-loader"),u=t("../extras")},{"../core":64,"../extras":137,path:23,"resource-loader":35}],158:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./loader");Object.defineProperty(i,"Loader",{enumerable:!0,get:function(){return n(o).default}});var r=t("./bitmapFontParser");Object.defineProperty(i,"bitmapFontParser",{enumerable:!0,get:function(){return n(r).default}}),Object.defineProperty(i,"parseBitmapFontData",{enumerable:!0,get:function(){return r.parse}});var s=t("./spritesheetParser");Object.defineProperty(i,"spritesheetParser",{enumerable:!0,get:function(){return n(s).default}});var a=t("./textureParser");Object.defineProperty(i,"textureParser",{enumerable:!0,get:function(){return n(a).default}});var l=t("resource-loader");Object.defineProperty(i,"Resource",{enumerable:!0,get:function(){return l.Resource}})},{"./bitmapFontParser":157,"./loader":159,"./spritesheetParser":160,"./textureParser":161,"resource-loader":35}],159:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("resource-loader"),l=n(a),u=t("resource-loader/lib/middlewares/parsing/blob"),h=t("eventemitter3"),c=n(h),p=t("./textureParser"),d=n(p),f=t("./spritesheetParser"),m=n(f),_=t("./bitmapFontParser"),y=n(_),x=function(t){function e(i,n){o(this,e);var s=r(this,t.call(this,i,n));c.default.call(s);for(var a=0;a<e._pixiMiddleware.length;++a)s.use(e._pixiMiddleware[a]());return s.onStart.add(function(t){return s.emit("start",t)}),s.onProgress.add(function(t,e){return s.emit("progress",t,e)}),s.onError.add(function(t,e,i){return s.emit("error",t,e,i)}),s.onLoad.add(function(t,e){return s.emit("load",t,e)}),s.onComplete.add(function(t,e){return s.emit("complete",t,e)}),s}return s(e,t),e.addPixiMiddleware=function(t){e._pixiMiddleware.push(t)},e}(l.default);i.default=x;for(var v in c.default.prototype)x.prototype[v]=c.default.prototype[v];x._pixiMiddleware=[u.blobMiddlewareFactory,d.default,m.default,y.default];var g=l.default.Resource;g.setExtensionXhrType("fnt",g.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":157,"./spritesheetParser":160,"./textureParser":161,eventemitter3:3,"resource-loader":35,"resource-loader/lib/middlewares/parsing/blob":36}],160:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,i.default=function(){return function(t,e){var i=void 0,n=t.name+"_image";if(!t.data||t.type!==o.Resource.TYPE.JSON||!t.data.frames||this.resources[n])return void e();var r={crossOrigin:t.crossOrigin,loadType:o.Resource.LOAD_TYPE.IMAGE,metadata:t.metadata.imageMetadata,parentResource:t};i=t.isDataUrl?t.data.meta.image:s.default.dirname(t.url.replace(this.baseUrl,""))+"/"+t.data.meta.image,this.add(n,i,r,function(i){var n=new a.Spritesheet(i.texture.baseTexture,t.data,t.url);n.parse(function(){t.spritesheet=n,t.textures=n.textures,e()})})}};var o=t("resource-loader"),r=t("path"),s=n(r),a=t("../core")},{"../core":64,path:23,"resource-loader":35}],161:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0,i.default=function(){return function(t,e){t.data&&t.type===o.Resource.TYPE.IMAGE&&(t.texture=s.default.fromLoader(t.data,t.url,t.name)),e()}};var o=t("resource-loader"),r=t("../core/textures/Texture"),s=n(r)},{"../core/textures/Texture":113,"resource-loader":35}],162:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../core"),u=n(l),h=new u.Point,c=new u.Polygon,p=function(t){function e(i,n,s,a,l){o(this,e);var h=r(this,t.call(this));return h._texture=null,h.uvs=s||new Float32Array([0,0,1,0,1,1,0,1]),h.vertices=n||new Float32Array([0,0,100,0,100,100,0,100]),h.indices=a||new Uint16Array([0,1,3,2]),h.dirty=0,h.indexDirty=0,h.blendMode=u.BLEND_MODES.NORMAL,h.canvasPadding=0,h.drawMode=l||e.DRAW_MODES.TRIANGLE_MESH,h.texture=i,h.shader=null,h.tintRgb=new Float32Array([1,1,1]),h._glDatas={},h.pluginName="mesh",h}return s(e,t),e.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._renderCanvas=function(t){t.plugins[this.pluginName].render(this)},e.prototype._onTextureUpdate=function(){},e.prototype._calculateBounds=function(){this._bounds.addVertices(this.transform,this.vertices,0,this.vertices.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,h);for(var i=this.vertices,n=c.points,o=this.indices,r=this.indices.length,s=this.drawMode===e.DRAW_MODES.TRIANGLES?3:1,a=0;a+2<r;a+=s){var l=2*o[a],u=2*o[a+1],p=2*o[a+2];if(n[0]=i[l],n[1]=i[l+1],n[2]=i[u],n[3]=i[u+1],n[4]=i[p],n[5]=i[p+1],c.contains(h.x,h.y))return!0}return!1},a(e,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}},{key:"tint",get:function(){return u.utils.rgb2hex(this.tintRgb)},set:function(t){this.tintRgb=u.utils.hex2rgb(t,this.tintRgb)}}]),e}(u.Container);i.default=p,p.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":64}],163:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("./Plane"),u=n(l),h=10,c=function(t){function e(i,n,s,a,l){o(this,e);var u=r(this,t.call(this,i,4,4)),c=u.uvs;return c[6]=c[14]=c[22]=c[30]=1,c[25]=c[27]=c[29]=c[31]=1,u._origWidth=i.width,u._origHeight=i.height,u._uvw=1/u._origWidth,u._uvh=1/u._origHeight,u.width=i.width,u.height=i.height,c[2]=c[10]=c[18]=c[26]=u._uvw*n,c[4]=c[12]=c[20]=c[28]=1-u._uvw*a,c[9]=c[11]=c[13]=c[15]=u._uvh*s,c[17]=c[19]=c[21]=c[23]=1-u._uvh*l,u.leftWidth="undefined"!=typeof n?n:h,u.rightWidth="undefined"!=typeof a?a:h,u.topHeight="undefined"!=typeof s?s:h,u.bottomHeight="undefined"!=typeof l?l:h,u}return s(e,t),e.prototype.updateHorizontalVertices=function(){var t=this.vertices;t[9]=t[11]=t[13]=t[15]=this._topHeight,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices;t[2]=t[10]=t[18]=t[26]=this._leftWidth,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha;var i=this.worldTransform,n=t.resolution;t.roundPixels?e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n|0,i.ty*n|0):e.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*n,i.ty*n);var o=this._texture.baseTexture,r=o.source,s=o.width,a=o.height;this.drawSegment(e,r,s,a,0,1,10,11),this.drawSegment(e,r,s,a,2,3,12,13),this.drawSegment(e,r,s,a,4,5,14,15),this.drawSegment(e,r,s,a,8,9,18,19),this.drawSegment(e,r,s,a,10,11,20,21),this.drawSegment(e,r,s,a,12,13,22,23),this.drawSegment(e,r,s,a,16,17,26,27),this.drawSegment(e,r,s,a,18,19,28,29),this.drawSegment(e,r,s,a,20,21,30,31)},e.prototype.drawSegment=function(t,e,i,n,o,r,s,a){var l=this.uvs,u=this.vertices,h=(l[s]-l[o])*i,c=(l[a]-l[r])*n,p=u[s]-u[o],d=u[a]-u[r];h<1&&(h=1),c<1&&(c=1),p<1&&(p=1),d<1&&(d=1),t.drawImage(e,l[o]*i,l[r]*n,h,c,u[o],u[r],p,d)},a(e,[{key:"width",get:function(){return this._width},set:function(t){this._width=t,this.updateVerticalVertices()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.updateHorizontalVertices()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t;var e=this.uvs,i=this.vertices;e[2]=e[10]=e[18]=e[26]=this._uvw*t,i[2]=i[10]=i[18]=i[26]=t,this.dirty=!0}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t;var e=this.uvs,i=this.vertices;e[4]=e[12]=e[20]=e[28]=1-this._uvw*t,i[4]=i[12]=i[20]=i[28]=this._width-t,this.dirty=!0}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t;var e=this.uvs,i=this.vertices;e[9]=e[11]=e[13]=e[15]=this._uvh*t,i[9]=i[11]=i[13]=i[15]=t,this.dirty=!0}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t;var e=this.uvs,i=this.vertices;e[17]=e[19]=e[21]=e[23]=1-this._uvh*t,i[17]=i[19]=i[21]=i[23]=this._height-t,this.dirty=!0}}]),e}(u.default);i.default=c},{"./Plane":164}],164:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("./Mesh"),l=n(a),u=function(t){function e(i,n,s){o(this,e);var a=r(this,t.call(this,i));return a._ready=!0,a.verticesX=n||10,a.verticesY=s||10,a.drawMode=l.default.DRAW_MODES.TRIANGLES,a.refresh(),a}return s(e,t),e.prototype.refresh=function(){for(var t=this.verticesX*this.verticesY,e=[],i=[],n=[],o=[],r=this.texture,s=this.verticesX-1,a=this.verticesY-1,l=r.width/s,u=r.height/a,h=0;h<t;h++)if(r._uvs){var c=h%this.verticesX,p=h/this.verticesX|0;e.push(c*l,p*u),n.push(r._uvs.x0+(r._uvs.x1-r._uvs.x0)*(c/(this.verticesX-1)),r._uvs.y0+(r._uvs.y3-r._uvs.y0)*(p/(this.verticesY-1)))}else n.push(0);for(var d=s*a,f=0;f<d;f++){var m=f%s,_=f/s|0,y=_*this.verticesX+m,x=_*this.verticesX+m+1,v=(_+1)*this.verticesX+m,g=(_+1)*this.verticesX+m+1;o.push(y,x,v),o.push(x,g,v)}this.vertices=new Float32Array(e),this.uvs=new Float32Array(n),this.colors=new Float32Array(i),this.indices=new Uint16Array(o),this.indexDirty=!0},e.prototype._onTextureUpdate=function(){l.default.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e}(l.default);i.default=u},{"./Mesh":162}],165:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=t("./Mesh"),u=o(l),h=t("../core"),c=n(h),p=function(t){function e(i,n){r(this,e);var o=s(this,t.call(this,i));return o.points=n,o.vertices=new Float32Array(4*n.length),o.uvs=new Float32Array(4*n.length),o.colors=new Float32Array(2*n.length),o.indices=new Uint16Array(2*n.length),o._ready=!0,o.refresh(),o}return a(e,t),e.prototype.refresh=function(){var t=this.points;if(!(t.length<1)&&this._texture._uvs){this.vertices.length/4!==t.length&&(this.vertices=new Float32Array(4*t.length),this.uvs=new Float32Array(4*t.length),this.colors=new Float32Array(2*t.length),this.indices=new Uint16Array(2*t.length));var e=this.uvs,i=this.indices,n=this.colors,o=this._texture._uvs,r=new c.Point(o.x0,o.y0),s=new c.Point(o.x2-o.x0,Number(o.y2-o.y0));e[0]=0+r.x,e[1]=0+r.y,e[2]=0+r.x,e[3]=s.y+r.y,n[0]=1,n[1]=1,i[0]=0,i[1]=1;for(var a=t.length,l=1;l<a;l++){var u=4*l,h=l/(a-1);e[u]=h*s.x+r.x,e[u+1]=0+r.y,e[u+2]=h*s.x+r.x,e[u+3]=s.y+r.y,u=2*l,n[u]=1,n[u+1]=1,u=2*l,i[u]=u,i[u+1]=u+1}this.dirty++,this.indexDirty++}},e.prototype._onTextureUpdate=function(){t.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},e.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){for(var e=t[0],i=void 0,n=0,o=0,r=this.vertices,s=t.length,a=0;a<s;a++){var l=t[a],u=4*a;i=a<t.length-1?t[a+1]:l,o=-(i.x-e.x),n=i.y-e.y;var h=10*(1-a/(s-1));h>1&&(h=1);var c=Math.sqrt(n*n+o*o),p=this._texture.height/2;n/=c,o/=c,n*=p,o*=p,r[u]=l.x+n,r[u+1]=l.y+o,r[u+2]=l.x-n,r[u+3]=l.y-o,e=l}this.containerUpdateTransform()}},e}(u.default);i.default=p},{"../core":64,"./Mesh":162}],166:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var s=t("../../core"),a=o(s),l=t("../Mesh"),u=n(l),h=function(){function t(e){r(this,t),this.renderer=e}return t.prototype.render=function(t){var e=this.renderer,i=e.context,n=t.worldTransform,o=e.resolution;e.roundPixels?i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o|0,n.ty*o|0):i.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),e.setBlendMode(t.blendMode),t.drawMode===u.default.DRAW_MODES.TRIANGLE_MESH?this._renderTriangleMesh(t):this._renderTriangles(t)},t.prototype._renderTriangleMesh=function(t){for(var e=t.vertices.length/2,i=0;i<e-2;i++){var n=2*i;this._renderDrawTriangle(t,n,n+2,n+4)}},t.prototype._renderTriangles=function(t){for(var e=t.indices,i=e.length,n=0;n<i;n+=3){var o=2*e[n],r=2*e[n+1],s=2*e[n+2];this._renderDrawTriangle(t,o,r,s)}},t.prototype._renderDrawTriangle=function(t,e,i,n){var o=this.renderer.context,r=t.uvs,s=t.vertices,a=t._texture;if(a.valid){var l=a.baseTexture,u=l.source,h=l.width,c=l.height,p=r[e]*l.width,d=r[i]*l.width,f=r[n]*l.width,m=r[e+1]*l.height,_=r[i+1]*l.height,y=r[n+1]*l.height,x=s[e],v=s[i],g=s[n],b=s[e+1],w=s[i+1],S=s[n+1];if(t.canvasPadding>0){var C=t.canvasPadding/t.worldTransform.a,D=t.canvasPadding/t.worldTransform.d,T=(x+v+g)/3,A=(b+w+S)/3,B=x-T,M=b-A,E=Math.sqrt(B*B+M*M);x=T+B/E*(E+C),b=A+M/E*(E+D),B=v-T,M=w-A,E=Math.sqrt(B*B+M*M),v=T+B/E*(E+C),w=A+M/E*(E+D),B=g-T,M=S-A,E=Math.sqrt(B*B+M*M),g=T+B/E*(E+C),S=A+M/E*(E+D)}o.save(),o.beginPath(),o.moveTo(x,b),o.lineTo(v,w),o.lineTo(g,S),o.closePath(),o.clip();var P=p*_+m*f+d*y-_*f-m*d-p*y,I=x*_+m*g+v*y-_*g-m*v-x*y,O=p*v+x*f+d*g-v*f-x*d-p*g,R=p*_*g+m*v*f+x*d*y-x*_*f-m*d*g-p*v*y,L=b*_+m*S+w*y-_*S-m*w-b*y,F=p*w+b*f+d*S-w*f-b*d-p*S,V=p*_*S+m*w*f+b*d*y-b*_*f-m*d*S-p*w*y;o.transform(I/P,L/P,O/P,F/P,R/P,V/P),o.drawImage(u,0,0,h*l.resolution,c*l.resolution,0,0,h,c),o.restore()}},t.prototype.renderMeshFlat=function(t){var e=this.renderer.context,i=t.vertices,n=i.length/2;e.beginPath();for(var o=1;o<n-2;++o){var r=2*o,s=i[r],a=i[r+1],l=i[r+2],u=i[r+3],h=i[r+4],c=i[r+5];e.moveTo(s,a),e.lineTo(l,u),e.lineTo(h,c)}e.fillStyle="#FF0000",e.fill(),e.closePath()},t.prototype.destroy=function(){this.renderer=null},t}();i.default=h,a.CanvasRenderer.registerPlugin("mesh",h)},{"../../core":64,"../Mesh":162}],167:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./Mesh");Object.defineProperty(i,"Mesh",{enumerable:!0,get:function(){return n(o).default}});var r=t("./webgl/MeshRenderer");Object.defineProperty(i,"MeshRenderer",{enumerable:!0,get:function(){return n(r).default}});var s=t("./canvas/CanvasMeshRenderer");Object.defineProperty(i,"CanvasMeshRenderer",{enumerable:!0,get:function(){return n(s).default}});var a=t("./Plane");Object.defineProperty(i,"Plane",{enumerable:!0,get:function(){return n(a).default}});var l=t("./NineSlicePlane");Object.defineProperty(i,"NineSlicePlane",{enumerable:!0,get:function(){return n(l).default}});var u=t("./Rope");Object.defineProperty(i,"Rope",{enumerable:!0,get:function(){return n(u).default}})},{"./Mesh":162,"./NineSlicePlane":163,"./Plane":164,"./Rope":165,"./canvas/CanvasMeshRenderer":166,"./webgl/MeshRenderer":168}],168:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=t("../../core"),u=o(l),h=t("pixi-gl-core"),c=n(h),p=t("../Mesh"),d=n(p),f=(t("path"),function(t){function e(i){r(this,e);var n=s(this,t.call(this,i));return n.shader=null,n}return a(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new u.Shader(t,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 translationMatrix;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n}\n","varying vec2 vTextureCoord;\nuniform float alpha;\nuniform vec3 tint;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vec4(tint * alpha, alpha);\n}\n")},e.prototype.render=function(t){var e=this.renderer,i=e.gl,n=t._texture;if(n.valid){var o=t._glDatas[e.CONTEXT_UID];o||(e.bindVao(null),o={shader:this.shader,vertexBuffer:c.default.GLBuffer.createVertexBuffer(i,t.vertices,i.STREAM_DRAW),uvBuffer:c.default.GLBuffer.createVertexBuffer(i,t.uvs,i.STREAM_DRAW),indexBuffer:c.default.GLBuffer.createIndexBuffer(i,t.indices,i.STATIC_DRAW),vao:null,dirty:t.dirty,indexDirty:t.indexDirty},o.vao=new c.default.VertexArrayObject(i).addIndex(o.indexBuffer).addAttribute(o.vertexBuffer,o.shader.attributes.aVertexPosition,i.FLOAT,!1,8,0).addAttribute(o.uvBuffer,o.shader.attributes.aTextureCoord,i.FLOAT,!1,8,0),t._glDatas[e.CONTEXT_UID]=o),e.bindVao(o.vao),t.dirty!==o.dirty&&(o.dirty=t.dirty,o.uvBuffer.upload(t.uvs)),t.indexDirty!==o.indexDirty&&(o.indexDirty=t.indexDirty,o.indexBuffer.upload(t.indices)),o.vertexBuffer.upload(t.vertices),e.bindShader(o.shader),o.shader.uniforms.uSampler=e.bindTexture(n),e.state.setBlendMode(t.blendMode),o.shader.uniforms.translationMatrix=t.worldTransform.toArray(!0),o.shader.uniforms.alpha=t.worldAlpha,o.shader.uniforms.tint=t.tintRgb;var r=t.drawMode===d.default.DRAW_MODES.TRIANGLE_MESH?i.TRIANGLE_STRIP:i.TRIANGLES;o.vao.draw(r,t.indices.length,0)}},e}(u.ObjectRenderer));i.default=f,u.WebGLRenderer.registerPlugin("mesh",f)},{"../../core":64,"../Mesh":162,path:23,"pixi-gl-core":12}],169:[function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../core"),l=n(a),u=function(t){function e(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,n=arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384;o(this,e);var a=r(this,t.call(this)),u=16384;return s>u&&(s=u),s>i&&(s=i),a._properties=[!1,!0,!1,!1,!1],a._maxSize=i,a._batchSize=s,a._glBuffers={},a._bufferToUpdate=0,a.interactiveChildren=!1,a.blendMode=l.BLEND_MODES.NORMAL,a.roundPixels=!0,a.baseTexture=null,a.setProperties(n),a}return s(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="scale"in t?!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="alpha"in t?!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},e.prototype.renderWebGL=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.hasLoaded||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){var e=Math.floor(t/this._batchSize);e<this._bufferToUpdate&&(this._bufferToUpdate=e)},e.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,i=this.worldTransform,n=!0,o=0,r=0,s=0,a=0,l=t.blendModes[this.blendMode];l!==e.globalCompositeOperation&&(e.globalCompositeOperation=l),e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var u=0;u<this.children.length;++u){var h=this.children[u];if(h.visible){var c=h._texture.frame;if(e.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)===0)n&&(e.setTransform(i.a,i.b,i.c,i.d,i.tx*t.resolution,i.ty*t.resolution),n=!1),o=h.anchor.x*(-c.width*h.scale.x)+h.position.x+.5,r=h.anchor.y*(-c.height*h.scale.y)+h.position.y+.5,s=c.width*h.scale.x,a=c.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var p=h.worldTransform;t.roundPixels?e.setTransform(p.a,p.b,p.c,p.d,p.tx*t.resolution|0,p.ty*t.resolution|0):e.setTransform(p.a,p.b,p.c,p.d,p.tx*t.resolution,p.ty*t.resolution),o=h.anchor.x*-c.width+.5,r=h.anchor.y*-c.height+.5,s=c.width,a=c.height}var d=h._texture.baseTexture.resolution;e.drawImage(h._texture.baseTexture.source,c.x*d,c.y*d,c.width*d,c.height*d,o*d,r*d,s*d,a*d)}}}},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._buffers)for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._properties=null,this._buffers=null},e}(l.Container);i.default=u},{"../core":64}],170:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./ParticleContainer");Object.defineProperty(i,"ParticleContainer",{enumerable:!0,get:function(){return n(o).default}});var r=t("./webgl/ParticleRenderer");Object.defineProperty(i,"ParticleRenderer",{enumerable:!0,get:function(){return n(r).default}})},{"./ParticleContainer":169,"./webgl/ParticleRenderer":172}],171:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var r=t("pixi-gl-core"),s=n(r),a=t("../../core/utils/createIndicesForQuads"),l=n(a),u=function(){function t(e,i,n,r){o(this,t),this.gl=e,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<i.length;++s){var a=i[s];a={attribute:a.attribute,size:a.size,uploadFunction:a.uploadFunction,offset:a.offset},n[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.gl,e=0;this.indices=(0,l.default)(this.size),this.indexBuffer=s.default.GLBuffer.createIndexBuffer(t,this.indices,t.STATIC_DRAW),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var n=this.dynamicProperties[i];n.offset=e,e+=n.size,this.dynamicStride+=n.size}this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=s.default.GLBuffer.createVertexBuffer(t,this.dynamicData,t.STREAM_DRAW);var o=0;this.staticStride=0;for(var r=0;r<this.staticProperties.length;++r){var a=this.staticProperties[r];a.offset=o,o+=a.size,this.staticStride+=a.size}this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=s.default.GLBuffer.createVertexBuffer(t,this.staticData,t.STATIC_DRAW),this.vao=new s.default.VertexArrayObject(t).addIndex(this.indexBuffer);for(var u=0;u<this.dynamicProperties.length;++u){var h=this.dynamicProperties[u];this.vao.addAttribute(this.dynamicBuffer,h.attribute,t.FLOAT,!1,4*this.dynamicStride,4*h.offset)}for(var c=0;c<this.staticProperties.length;++c){var p=this.staticProperties[c];this.vao.addAttribute(this.staticBuffer,p.attribute,t.FLOAT,!1,4*this.staticStride,4*p.offset)}},t.prototype.uploadDynamic=function(t,e,i){for(var n=0;n<this.dynamicProperties.length;n++){var o=this.dynamicProperties[n];o.uploadFunction(t,e,i,this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer.upload()},t.prototype.uploadStatic=function(t,e,i){for(var n=0;n<this.staticProperties.length;n++){var o=this.staticProperties[n];o.uploadFunction(t,e,i,this.staticData,this.staticStride,o.offset)}this.staticBuffer.upload()},t.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.dynamicBuffer.destroy(),this.staticProperties=null,this.staticData=null,this.staticBuffer.destroy()},t}();i.default=u},{"../../core/utils/createIndicesForQuads":119,"pixi-gl-core":12}],172:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var l=t("../../core"),u=o(l),h=t("./ParticleShader"),c=n(h),p=t("./ParticleBuffer"),d=n(p),f=function(t){function e(i){r(this,e);var n=s(this,t.call(this,i));return n.shader=null,n.indexBuffer=null,n.properties=null,n.tempMatrix=new u.Matrix,n.CONTEXT_UID=0,n}return a(e,t),e.prototype.onContextChange=function(){var t=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.shader=new c.default(t),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},e.prototype.start=function(){this.renderer.bindShader(this.shader)},e.prototype.render=function(t){var e=t.children,i=t._maxSize,n=t._batchSize,o=this.renderer,r=e.length;if(0!==r){r>i&&(r=i);var s=t._glBuffers[o.CONTEXT_UID];s||(s=t._glBuffers[o.CONTEXT_UID]=this.generateBuffers(t)),this.renderer.setBlendMode(t.blendMode);var a=o.gl,l=t.worldTransform.copy(this.tempMatrix);l.prepend(o._activeRenderTarget.projectionMatrix),this.shader.uniforms.projectionMatrix=l.toArray(!0),this.shader.uniforms.uAlpha=t.worldAlpha;var u=e[0]._texture.baseTexture;this.shader.uniforms.uSampler=o.bindTexture(u);for(var h=0,c=0;h<r;h+=n,c+=1){var p=r-h;p>n&&(p=n);var d=s[c];d.uploadDynamic(e,h,p),t._bufferToUpdate===c&&(d.uploadStatic(e,h,p),t._bufferToUpdate=c+1),o.bindVao(d.vao),d.vao.draw(a.TRIANGLES,6*p)}}},e.prototype.generateBuffers=function(t){for(var e=this.renderer.gl,i=[],n=t._maxSize,o=t._batchSize,r=t._properties,s=0;s<n;s+=o)i.push(new d.default(e,this.properties,r,o));return i},e.prototype.uploadVertices=function(t,e,i,n,o,r){for(var s=0,a=0,l=0,u=0,h=0;h<i;++h){var c=t[e+h],p=c._texture,d=c.scale.x,f=c.scale.y,m=p.trim,_=p.orig;m?(a=m.x-c.anchor.x*_.width,s=a+m.width,u=m.y-c.anchor.y*_.height,l=u+m.height):(s=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,l=_.height*(1-c.anchor.y),u=_.height*-c.anchor.y),n[r]=a*d,n[r+1]=u*f,n[r+o]=s*d,n[r+o+1]=u*f,n[r+2*o]=s*d,n[r+2*o+1]=l*f,n[r+3*o]=a*d,n[r+3*o+1]=l*f,r+=4*o}},e.prototype.uploadPosition=function(t,e,i,n,o,r){for(var s=0;s<i;s++){var a=t[e+s].position;n[r]=a.x,n[r+1]=a.y,n[r+o]=a.x,n[r+o+1]=a.y,n[r+2*o]=a.x,n[r+2*o+1]=a.y,n[r+3*o]=a.x,n[r+3*o+1]=a.y,r+=4*o}},e.prototype.uploadRotation=function(t,e,i,n,o,r){for(var s=0;s<i;s++){var a=t[e+s].rotation;n[r]=a,n[r+o]=a,n[r+2*o]=a,n[r+3*o]=a,r+=4*o}},e.prototype.uploadUvs=function(t,e,i,n,o,r){for(var s=0;s<i;++s){var a=t[e+s]._texture._uvs;a?(n[r]=a.x0,n[r+1]=a.y0,n[r+o]=a.x1,n[r+o+1]=a.y1,n[r+2*o]=a.x2,n[r+2*o+1]=a.y2,n[r+3*o]=a.x3,n[r+3*o+1]=a.y3,r+=4*o):(n[r]=0,n[r+1]=0,n[r+o]=0,n[r+o+1]=0,n[r+2*o]=0,n[r+2*o+1]=0,n[r+3*o]=0,n[r+3*o+1]=0,r+=4*o)}},e.prototype.uploadAlpha=function(t,e,i,n,o,r){for(var s=0;s<i;s++){var a=t[e+s].alpha;n[r]=a,n[r+o]=a,n[r+2*o]=a,n[r+3*o]=a,r+=4*o}},e.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),t.prototype.destroy.call(this),this.shader.destroy(),this.indices=null,this.tempMatrix=null},e}(u.ObjectRenderer);i.default=f,u.WebGLRenderer.registerPlugin("particle",f)},{"../../core":64,"./ParticleBuffer":171,"./ParticleShader":173}],173:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.__esModule=!0;var a=t("../../core/Shader"),l=n(a),u=function(t){function e(i){return o(this,e),r(this,t.call(this,i,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n")))}return s(e,t),e}(l.default);i.default=u},{"../../core/Shader":43}],174:[function(t,e,i){"use strict";Math.sign||(Math.sign=function(t){return t=Number(t),0===t||isNaN(t)?t:t>0?1:-1})},{}],175:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}var o=t("object-assign"),r=n(o);Object.assign||(Object.assign=r.default)},{"object-assign":5}],176:[function(t,e,i){"use strict";t("./Object.assign"),t("./requestAnimationFrame"),t("./Math.sign"),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array)},{"./Math.sign":174,"./Object.assign":175,"./requestAnimationFrame":177}],177:[function(t,e,i){(function(t){"use strict";var e=16;if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var i=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-i}}for(var n=Date.now(),o=["ms","moz","webkit","o"],r=0;r<o.length&&!t.requestAnimationFrame;++r){var s=o[r];t.requestAnimationFrame=t[s+"RequestAnimationFrame"],t.cancelAnimationFrame=t[s+"CancelAnimationFrame"]||t[s+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var i=Date.now(),o=e+n-i;return o<0&&(o=0),n=i,setTimeout(function(){n=Date.now(),t(performance.now())},o)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){return clearTimeout(t)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],178:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return e instanceof c.Text&&(e.updateText(!0),!0)}function a(t,e){if(e instanceof c.TextStyle){var i=c.Text.getFontStyle(e);return c.Text.fontPropertiesCache[i]||c.Text.calculateFontProperties(i),!0}return!1}function l(t,e){if(t instanceof c.Text){e.indexOf(t.style)===-1&&e.push(t.style),e.indexOf(t)===-1&&e.push(t);var i=t._texture.baseTexture;return e.indexOf(i)===-1&&e.push(i),!0}return!1}function u(t,e){return t instanceof c.TextStyle&&(e.indexOf(t)===-1&&e.push(t),!0)}i.__esModule=!0;var h=t("../core"),c=o(h),p=t("./limiters/CountLimiter"),d=n(p),f=c.ticker.shared;c.settings.UPLOADS_PER_FRAME=4;var m=function(){function t(e){var i=this;r(this,t),this.limiter=new d.default(c.settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){i.queue&&i.prepareItems()},this.register(l,s),this.register(u,a)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,f.addOnce(this.tick,this))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){for(var t=this.queue[0],e=!1,i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)f.addOnce(this.tick,this);else{this.ticking=!1;var o=this.completes.slice(0);this.completes.length=0;for(var r=0,s=o.length;r<s;r++)o[r]()}},t.prototype.register=function(t,e){return t&&this.addHooks.push(t),e&&this.uploadHooks.push(e),this},t.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof c.Container)for(var n=t.children.length-1;n>=0;n--)this.add(t.children[n]);return this},t.prototype.destroy=function(){this.ticking&&f.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();i.default=m},{"../core":64,"./limiters/CountLimiter":181}],179:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){if(e instanceof c.BaseTexture){var i=e.source,n=0===i.width?t.canvas.width:Math.min(t.canvas.width,i.width),o=0===i.height?t.canvas.height:Math.min(t.canvas.height,i.height);return t.ctx.drawImage(i,0,0,n,o,0,0,t.canvas.width,t.canvas.height),!0}return!1}function u(t,e){if(t instanceof c.BaseTexture)return e.indexOf(t)===-1&&e.push(t),!0;if(t._texture&&t._texture instanceof c.Texture){var i=t._texture.baseTexture;return e.indexOf(i)===-1&&e.push(i),!0}return!1}i.__esModule=!0;var h=t("../../core"),c=o(h),p=t("../BasePrepare"),d=n(p),f=16,m=function(t){function e(i){r(this,e);var n=s(this,t.call(this,i));return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=f,n.canvas.height=f,n.ctx=n.canvas.getContext("2d"),n.register(u,l),n}return a(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(d.default);i.default=m,c.CanvasRenderer.registerPlugin("prepare",m)},{"../../core":64,"../BasePrepare":178}],180:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}i.__esModule=!0;var o=t("./webgl/WebGLPrepare");Object.defineProperty(i,"webgl",{enumerable:!0,get:function(){return n(o).default}});var r=t("./canvas/CanvasPrepare");Object.defineProperty(i,"canvas",{enumerable:!0,get:function(){return n(r).default}});var s=t("./BasePrepare");Object.defineProperty(i,"BasePrepare",{enumerable:!0,get:function(){return n(s).default}});var a=t("./limiters/CountLimiter");Object.defineProperty(i,"CountLimiter",{enumerable:!0,get:function(){return n(a).default}});var l=t("./limiters/TimeLimiter");Object.defineProperty(i,"TimeLimiter",{enumerable:!0,get:function(){return n(l).default}})},{"./BasePrepare":178,"./canvas/CanvasPrepare":179,"./limiters/CountLimiter":181,"./limiters/TimeLimiter":182,"./webgl/WebGLPrepare":183}],181:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(e){n(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();i.default=o},{}],182:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function t(e){n(this,t),this.maxMilliseconds=e,this.frameStart=0}return t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},t}();i.default=o},{}],183:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){return e instanceof d.BaseTexture&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function u(t,e){return e instanceof d.Graphics&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function h(t,e){if(t instanceof d.BaseTexture)return e.indexOf(t)===-1&&e.push(t),!0;if(t._texture&&t._texture instanceof d.Texture){var i=t._texture.baseTexture;return e.indexOf(i)===-1&&e.push(i),!0}return!1}function c(t,e){return t instanceof d.Graphics&&(e.push(t),!0)}i.__esModule=!0;var p=t("../../core"),d=o(p),f=t("../BasePrepare"),m=n(f),_=function(t){function e(i){r(this,e);var n=s(this,t.call(this,i));return n.uploadHookHelper=n.renderer,n.register(h,l).register(c,u),n}return a(e,t),e}(m.default);i.default=_,d.WebGLRenderer.registerPlugin("prepare",_)},{"../../core":64,"../BasePrepare":178}],184:[function(t,e,i){(function(e){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}i.__esModule=!0,i.loader=i.prepare=i.particles=i.mesh=i.loaders=i.interaction=i.filters=i.extras=i.extract=i.accessibility=void 0;var o=t("./polyfill");Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return o[t]}})});var r=t("./deprecation");Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return r[t]}})});var s=t("./core");Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(i,t,{enumerable:!0,get:function(){return s[t]}})});var a=t("./accessibility"),l=n(a),u=t("./extract"),h=n(u),c=t("./extras"),p=n(c),d=t("./filters"),f=n(d),m=t("./interaction"),_=n(m),y=t("./loaders"),x=n(y),v=t("./mesh"),g=n(v),b=t("./particles"),w=n(b),S=t("./prepare"),C=n(S);s.utils.mixins.performMixins(),i.accessibility=l,i.extract=h,i.extras=p,i.filters=f,i.interaction=_,i.loaders=x,i.mesh=g,i.particles=w,i.prepare=C;var D=x&&x.Loader?new x.Loader:null;i.loader=D,e.PIXI=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./accessibility":41,"./core":64,"./deprecation":126,"./extract":128,"./extras":137,"./filters":148,"./interaction":155,"./loaders":158,"./mesh":167,"./particles":170,"./polyfill":176,"./prepare":180}]},{},[184])(184)});var Box2D={};!function(t,e){function i(){}!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(t,e,i){i.get instanceof Function&&t.__defineGetter__(e,i.get),i.set instanceof Function&&t.__defineSetter__(e,i.set)}),t.inherit=function(t,e){var n=t;i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=n},t.generateCallback=function(t,e){return function(){e.apply(t,arguments)}},t.NVector=function(t){t===e&&(t=0);for(var i=new Array(t||0),n=0;n<t;++n)i[n]=0;return i},t.is=function(t,i){return null!==t&&(i instanceof Function&&t instanceof i||!(t.constructor.__implements==e||!t.constructor.__implements[i]))},t.parseUInt=function(t){return Math.abs(parseInt(t))}}(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"==typeof Box2D&&(Box2D={}),"undefined"==typeof Box2D.Collision&&(Box2D.Collision={}),"undefined"==typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),"undefined"==typeof Box2D.Common&&(Box2D.Common={}),"undefined"==typeof Box2D.Common.Math&&(Box2D.Common.Math={}),"undefined"==typeof Box2D.Dynamics&&(Box2D.Dynamics={}),"undefined"==typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),"undefined"==typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),"undefined"==typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),function(){function t(){t.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function i(){i.b2BoundValues.apply(this,arguments),this.constructor===i&&this.b2BoundValues.apply(this,arguments)}function n(){n.b2Collision.apply(this,arguments)}function o(){o.b2ContactID.apply(this,arguments),this.constructor===o&&this.b2ContactID.apply(this,arguments)}function r(){r.b2ContactPoint.apply(this,arguments)}function s(){s.b2Distance.apply(this,arguments)}function a(){a.b2DistanceInput.apply(this,arguments)}function l(){l.b2DistanceOutput.apply(this,arguments)}function u(){u.b2DistanceProxy.apply(this,arguments)}function h(){h.b2DynamicTree.apply(this,arguments),this.constructor===h&&this.b2DynamicTree.apply(this,arguments)}function c(){c.b2DynamicTreeBroadPhase.apply(this,arguments)}function p(){p.b2DynamicTreeNode.apply(this,arguments)}function d(){d.b2DynamicTreePair.apply(this,arguments)}function f(){f.b2Manifold.apply(this,arguments),this.constructor===f&&this.b2Manifold.apply(this,arguments)}function m(){m.b2ManifoldPoint.apply(this,arguments),this.constructor===m&&this.b2ManifoldPoint.apply(this,arguments)}function _(){_.b2Point.apply(this,arguments)}function y(){y.b2RayCastInput.apply(this,arguments),this.constructor===y&&this.b2RayCastInput.apply(this,arguments)}function x(){x.b2RayCastOutput.apply(this,arguments)}function v(){v.b2Segment.apply(this,arguments)}function g(){g.b2SeparationFunction.apply(this,arguments)}function b(){b.b2Simplex.apply(this,arguments),this.constructor===b&&this.b2Simplex.apply(this,arguments)}function w(){w.b2SimplexCache.apply(this,arguments)}function S(){S.b2SimplexVertex.apply(this,arguments)}function C(){C.b2TimeOfImpact.apply(this,arguments)}function D(){D.b2TOIInput.apply(this,arguments)}function T(){T.b2WorldManifold.apply(this,arguments),this.constructor===T&&this.b2WorldManifold.apply(this,arguments)}function A(){A.ClipVertex.apply(this,arguments)}function B(){B.Features.apply(this,arguments)}function M(){M.b2CircleShape.apply(this,arguments),this.constructor===M&&this.b2CircleShape.apply(this,arguments)}function E(){E.b2EdgeChainDef.apply(this,arguments),this.constructor===E&&this.b2EdgeChainDef.apply(this,arguments)}function P(){P.b2EdgeShape.apply(this,arguments),this.constructor===P&&this.b2EdgeShape.apply(this,arguments)}function I(){I.b2MassData.apply(this,arguments)}function O(){O.b2PolygonShape.apply(this,arguments),this.constructor===O&&this.b2PolygonShape.apply(this,arguments)}function R(){R.b2Shape.apply(this,arguments),this.constructor===R&&this.b2Shape.apply(this,arguments)}function L(){L.b2Color.apply(this,arguments),this.constructor===L&&this.b2Color.apply(this,arguments)}function F(){F.b2Settings.apply(this,arguments)}function V(){V.b2Mat22.apply(this,arguments),this.constructor===V&&this.b2Mat22.apply(this,arguments)}function k(){k.b2Mat33.apply(this,arguments),this.constructor===k&&this.b2Mat33.apply(this,arguments)}function G(){G.b2Math.apply(this,arguments)}function N(){N.b2Sweep.apply(this,arguments)}function j(){j.b2Transform.apply(this,arguments),this.constructor===j&&this.b2Transform.apply(this,arguments)}function U(){U.b2Vec2.apply(this,arguments),this.constructor===U&&this.b2Vec2.apply(this,arguments)}function X(){X.b2Vec3.apply(this,arguments),this.constructor===X&&this.b2Vec3.apply(this,arguments)}function J(){J.b2Body.apply(this,arguments),this.constructor===J&&this.b2Body.apply(this,arguments)}function W(){W.b2BodyDef.apply(this,arguments),this.constructor===W&&this.b2BodyDef.apply(this,arguments)}function z(){z.b2ContactFilter.apply(this,arguments)}function H(){H.b2ContactImpulse.apply(this,arguments)}function q(){q.b2ContactListener.apply(this,arguments)}function Y(){Y.b2ContactManager.apply(this,arguments),this.constructor===Y&&this.b2ContactManager.apply(this,arguments)}function K(){K.b2DebugDraw.apply(this,arguments),this.constructor===K&&this.b2DebugDraw.apply(this,arguments)}function Z(){Z.b2DestructionListener.apply(this,arguments)}function Q(){Q.b2FilterData.apply(this,arguments)}function $(){$.b2Fixture.apply(this,arguments),this.constructor===$&&this.b2Fixture.apply(this,arguments)}function tt(){tt.b2FixtureDef.apply(this,arguments),this.constructor===tt&&this.b2FixtureDef.apply(this,arguments)}function et(){et.b2Island.apply(this,arguments),this.constructor===et&&this.b2Island.apply(this,arguments)}function it(){it.b2TimeStep.apply(this,arguments)}function nt(){nt.b2World.apply(this,arguments),this.constructor===nt&&this.b2World.apply(this,arguments)}function ot(){ot.b2CircleContact.apply(this,arguments)}function rt(){rt.b2Contact.apply(this,arguments),this.constructor===rt&&this.b2Contact.apply(this,arguments)}function st(){st.b2ContactConstraint.apply(this,arguments),this.constructor===st&&this.b2ContactConstraint.apply(this,arguments)}function at(){at.b2ContactConstraintPoint.apply(this,arguments)}function lt(){lt.b2ContactEdge.apply(this,arguments)}function ut(){ut.b2ContactFactory.apply(this,arguments),this.constructor===ut&&this.b2ContactFactory.apply(this,arguments)}function ht(){ht.b2ContactRegister.apply(this,arguments)}function ct(){ct.b2ContactResult.apply(this,arguments)}function pt(){pt.b2ContactSolver.apply(this,arguments),this.constructor===pt&&this.b2ContactSolver.apply(this,arguments)}function dt(){dt.b2EdgeAndCircleContact.apply(this,arguments)}function ft(){ft.b2NullContact.apply(this,arguments),this.constructor===ft&&this.b2NullContact.apply(this,arguments)}function mt(){mt.b2PolyAndCircleContact.apply(this,arguments)}function _t(){_t.b2PolyAndEdgeContact.apply(this,arguments)}function yt(){yt.b2PolygonContact.apply(this,arguments)}function xt(){xt.b2PositionSolverManifold.apply(this,arguments),this.constructor===xt&&this.b2PositionSolverManifold.apply(this,arguments)}function vt(){vt.b2BuoyancyController.apply(this,arguments)}function gt(){gt.b2ConstantAccelController.apply(this,arguments)}function bt(){bt.b2ConstantForceController.apply(this,arguments)}function wt(){wt.b2Controller.apply(this,arguments)}function St(){St.b2ControllerEdge.apply(this,arguments)}function Ct(){Ct.b2GravityController.apply(this,arguments)}function Dt(){Dt.b2TensorDampingController.apply(this,arguments)}function Tt(){Tt.b2DistanceJoint.apply(this,arguments),this.constructor===Tt&&this.b2DistanceJoint.apply(this,arguments)}function At(){At.b2DistanceJointDef.apply(this,arguments),this.constructor===At&&this.b2DistanceJointDef.apply(this,arguments)}function Bt(){Bt.b2FrictionJoint.apply(this,arguments),this.constructor===Bt&&this.b2FrictionJoint.apply(this,arguments)}function Mt(){Mt.b2FrictionJointDef.apply(this,arguments),this.constructor===Mt&&this.b2FrictionJointDef.apply(this,arguments)}function Et(){Et.b2GearJoint.apply(this,arguments),this.constructor===Et&&this.b2GearJoint.apply(this,arguments)}function Pt(){Pt.b2GearJointDef.apply(this,arguments),this.constructor===Pt&&this.b2GearJointDef.apply(this,arguments)}function It(){It.b2Jacobian.apply(this,arguments)}function Ot(){Ot.b2Joint.apply(this,arguments),this.constructor===Ot&&this.b2Joint.apply(this,arguments);
}function Rt(){Rt.b2JointDef.apply(this,arguments),this.constructor===Rt&&this.b2JointDef.apply(this,arguments)}function Lt(){Lt.b2JointEdge.apply(this,arguments)}function Ft(){Ft.b2LineJoint.apply(this,arguments),this.constructor===Ft&&this.b2LineJoint.apply(this,arguments)}function Vt(){Vt.b2LineJointDef.apply(this,arguments),this.constructor===Vt&&this.b2LineJointDef.apply(this,arguments)}function kt(){kt.b2MouseJoint.apply(this,arguments),this.constructor===kt&&this.b2MouseJoint.apply(this,arguments)}function Gt(){Gt.b2MouseJointDef.apply(this,arguments),this.constructor===Gt&&this.b2MouseJointDef.apply(this,arguments)}function Nt(){Nt.b2PrismaticJoint.apply(this,arguments),this.constructor===Nt&&this.b2PrismaticJoint.apply(this,arguments)}function jt(){jt.b2PrismaticJointDef.apply(this,arguments),this.constructor===jt&&this.b2PrismaticJointDef.apply(this,arguments)}function Ut(){Ut.b2PulleyJoint.apply(this,arguments),this.constructor===Ut&&this.b2PulleyJoint.apply(this,arguments)}function Xt(){Xt.b2PulleyJointDef.apply(this,arguments),this.constructor===Xt&&this.b2PulleyJointDef.apply(this,arguments)}function Jt(){Jt.b2RevoluteJoint.apply(this,arguments),this.constructor===Jt&&this.b2RevoluteJoint.apply(this,arguments)}function Wt(){Wt.b2RevoluteJointDef.apply(this,arguments),this.constructor===Wt&&this.b2RevoluteJointDef.apply(this,arguments)}function zt(){zt.b2WeldJoint.apply(this,arguments),this.constructor===zt&&this.b2WeldJoint.apply(this,arguments)}function Ht(){Ht.b2WeldJointDef.apply(this,arguments),this.constructor===Ht&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase",Box2D.Collision.b2AABB=t,Box2D.Collision.b2Bound=e,Box2D.Collision.b2BoundValues=i,Box2D.Collision.b2Collision=n,Box2D.Collision.b2ContactID=o,Box2D.Collision.b2ContactPoint=r,Box2D.Collision.b2Distance=s,Box2D.Collision.b2DistanceInput=a,Box2D.Collision.b2DistanceOutput=l,Box2D.Collision.b2DistanceProxy=u,Box2D.Collision.b2DynamicTree=h,Box2D.Collision.b2DynamicTreeBroadPhase=c,Box2D.Collision.b2DynamicTreeNode=p,Box2D.Collision.b2DynamicTreePair=d,Box2D.Collision.b2Manifold=f,Box2D.Collision.b2ManifoldPoint=m,Box2D.Collision.b2Point=_,Box2D.Collision.b2RayCastInput=y,Box2D.Collision.b2RayCastOutput=x,Box2D.Collision.b2Segment=v,Box2D.Collision.b2SeparationFunction=g,Box2D.Collision.b2Simplex=b,Box2D.Collision.b2SimplexCache=w,Box2D.Collision.b2SimplexVertex=S,Box2D.Collision.b2TimeOfImpact=C,Box2D.Collision.b2TOIInput=D,Box2D.Collision.b2WorldManifold=T,Box2D.Collision.ClipVertex=A,Box2D.Collision.Features=B,Box2D.Collision.Shapes.b2CircleShape=M,Box2D.Collision.Shapes.b2EdgeChainDef=E,Box2D.Collision.Shapes.b2EdgeShape=P,Box2D.Collision.Shapes.b2MassData=I,Box2D.Collision.Shapes.b2PolygonShape=O,Box2D.Collision.Shapes.b2Shape=R,Box2D.Common.b2internal="Box2D.Common.b2internal",Box2D.Common.b2Color=L,Box2D.Common.b2Settings=F,Box2D.Common.Math.b2Mat22=V,Box2D.Common.Math.b2Mat33=k,Box2D.Common.Math.b2Math=G,Box2D.Common.Math.b2Sweep=N,Box2D.Common.Math.b2Transform=j,Box2D.Common.Math.b2Vec2=U,Box2D.Common.Math.b2Vec3=X,Box2D.Dynamics.b2Body=J,Box2D.Dynamics.b2BodyDef=W,Box2D.Dynamics.b2ContactFilter=z,Box2D.Dynamics.b2ContactImpulse=H,Box2D.Dynamics.b2ContactListener=q,Box2D.Dynamics.b2ContactManager=Y,Box2D.Dynamics.b2DebugDraw=K,Box2D.Dynamics.b2DestructionListener=Z,Box2D.Dynamics.b2FilterData=Q,Box2D.Dynamics.b2Fixture=$,Box2D.Dynamics.b2FixtureDef=tt,Box2D.Dynamics.b2Island=et,Box2D.Dynamics.b2TimeStep=it,Box2D.Dynamics.b2World=nt,Box2D.Dynamics.Contacts.b2CircleContact=ot,Box2D.Dynamics.Contacts.b2Contact=rt,Box2D.Dynamics.Contacts.b2ContactConstraint=st,Box2D.Dynamics.Contacts.b2ContactConstraintPoint=at,Box2D.Dynamics.Contacts.b2ContactEdge=lt,Box2D.Dynamics.Contacts.b2ContactFactory=ut,Box2D.Dynamics.Contacts.b2ContactRegister=ht,Box2D.Dynamics.Contacts.b2ContactResult=ct,Box2D.Dynamics.Contacts.b2ContactSolver=pt,Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=dt,Box2D.Dynamics.Contacts.b2NullContact=ft,Box2D.Dynamics.Contacts.b2PolyAndCircleContact=mt,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=_t,Box2D.Dynamics.Contacts.b2PolygonContact=yt,Box2D.Dynamics.Contacts.b2PositionSolverManifold=xt,Box2D.Dynamics.Controllers.b2BuoyancyController=vt,Box2D.Dynamics.Controllers.b2ConstantAccelController=gt,Box2D.Dynamics.Controllers.b2ConstantForceController=bt,Box2D.Dynamics.Controllers.b2Controller=wt,Box2D.Dynamics.Controllers.b2ControllerEdge=St,Box2D.Dynamics.Controllers.b2GravityController=Ct,Box2D.Dynamics.Controllers.b2TensorDampingController=Dt,Box2D.Dynamics.Joints.b2DistanceJoint=Tt,Box2D.Dynamics.Joints.b2DistanceJointDef=At,Box2D.Dynamics.Joints.b2FrictionJoint=Bt,Box2D.Dynamics.Joints.b2FrictionJointDef=Mt,Box2D.Dynamics.Joints.b2GearJoint=Et,Box2D.Dynamics.Joints.b2GearJointDef=Pt,Box2D.Dynamics.Joints.b2Jacobian=It,Box2D.Dynamics.Joints.b2Joint=Ot,Box2D.Dynamics.Joints.b2JointDef=Rt,Box2D.Dynamics.Joints.b2JointEdge=Lt,Box2D.Dynamics.Joints.b2LineJoint=Ft,Box2D.Dynamics.Joints.b2LineJointDef=Vt,Box2D.Dynamics.Joints.b2MouseJoint=kt,Box2D.Dynamics.Joints.b2MouseJointDef=Gt,Box2D.Dynamics.Joints.b2PrismaticJoint=Nt,Box2D.Dynamics.Joints.b2PrismaticJointDef=jt,Box2D.Dynamics.Joints.b2PulleyJoint=Ut,Box2D.Dynamics.Joints.b2PulleyJointDef=Xt,Box2D.Dynamics.Joints.b2RevoluteJoint=Jt,Box2D.Dynamics.Joints.b2RevoluteJointDef=Wt,Box2D.Dynamics.Joints.b2WeldJoint=zt,Box2D.Dynamics.Joints.b2WeldJointDef=Ht}(),Box2D.postDefs=[],function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),i=Box2D.Collision.Shapes.b2Shape,n=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),o=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),r=Box2D.Common.Math.b2Sweep,s=Box2D.Common.Math.b2Transform,a=Box2D.Common.Math.b2Vec2,l=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB),u=Box2D.Collision.b2Bound,h=Box2D.Collision.b2BoundValues,c=Box2D.Collision.b2Collision,p=Box2D.Collision.b2ContactID,d=Box2D.Collision.b2ContactPoint,f=Box2D.Collision.b2Distance,m=Box2D.Collision.b2DistanceInput,_=Box2D.Collision.b2DistanceOutput,y=Box2D.Collision.b2DistanceProxy,x=Box2D.Collision.b2DynamicTree,v=Box2D.Collision.b2DynamicTreeBroadPhase,g=Box2D.Collision.b2DynamicTreeNode,b=Box2D.Collision.b2DynamicTreePair,w=Box2D.Collision.b2Manifold,S=Box2D.Collision.b2ManifoldPoint,C=Box2D.Collision.b2Point,D=Box2D.Collision.b2RayCastInput,T=Box2D.Collision.b2RayCastOutput,A=Box2D.Collision.b2Segment,B=Box2D.Collision.b2SeparationFunction,M=Box2D.Collision.b2Simplex,E=Box2D.Collision.b2SimplexCache,P=Box2D.Collision.b2SimplexVertex,I=Box2D.Collision.b2TimeOfImpact,O=Box2D.Collision.b2TOIInput,R=Box2D.Collision.b2WorldManifold,L=Box2D.Collision.ClipVertex,F=Box2D.Collision.Features,V=Box2D.Collision.IBroadPhase;l.b2AABB=function(){this.lowerBound=new a,this.upperBound=new a},l.prototype.IsValid=function(){var t=this.upperBound.x-this.lowerBound.x,e=this.upperBound.y-this.lowerBound.y,i=t>=0&&e>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},l.prototype.GetCenter=function(){return new a((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},l.prototype.GetExtents=function(){return new a((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},l.prototype.Contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y},l.prototype.RayCast=function(t,e){var i=-Number.MAX_VALUE,n=Number.MAX_VALUE,o=e.p1.x,r=e.p1.y,s=e.p2.x-e.p1.x,a=e.p2.y-e.p1.y,l=Math.abs(s),u=Math.abs(a),h=t.normal,c=0,p=0,d=0,f=0,m=0;if(l<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(c=1/s,p=(this.lowerBound.x-o)*c,d=(this.upperBound.x-o)*c,m=-1,p>d&&(f=p,p=d,d=f,m=1),p>i&&(h.x=m,h.y=0,i=p),n=Math.min(n,d),i>n)return!1;if(u<Number.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else if(c=1/a,p=(this.lowerBound.y-r)*c,d=(this.upperBound.y-r)*c,m=-1,p>d&&(f=p,p=d,d=f,m=1),p>i&&(h.y=m,h.x=0,i=p),n=Math.min(n,d),i>n)return!1;return t.fraction=i,!0},l.prototype.TestOverlap=function(t){var e=t.lowerBound.x-this.upperBound.x,i=t.lowerBound.y-this.upperBound.y,n=this.lowerBound.x-t.upperBound.x,o=this.lowerBound.y-t.upperBound.y;return!(e>0||i>0)&&!(n>0||o>0)},l.Combine=function(t,e){var i=new l;return i.Combine(t,e),i},l.prototype.Combine=function(t,e){this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y)},u.b2Bound=function(){},u.prototype.IsLower=function(){return 0==(1&this.value)},u.prototype.IsUpper=function(){return 1==(1&this.value)},u.prototype.Swap=function(t){var e=this.value,i=this.proxy,n=this.stabbingCount;this.value=t.value,this.proxy=t.proxy,this.stabbingCount=t.stabbingCount,t.value=e,t.proxy=i,t.stabbingCount=n},h.b2BoundValues=function(){},h.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},c.b2Collision=function(){},c.ClipSegmentToLine=function(t,e,i,n){void 0===n&&(n=0);var o,r=0;o=e[0];var s=o.v;o=e[1];var a=o.v,l=i.x*s.x+i.y*s.y-n,u=i.x*a.x+i.y*a.y-n;if(l<=0&&t[r++].Set(e[0]),u<=0&&t[r++].Set(e[1]),l*u<0){var h=l/(l-u);o=t[r];var c=o.v;c.x=s.x+h*(a.x-s.x),c.y=s.y+h*(a.y-s.y),o=t[r];var p;l>0?(p=e[0],o.id=p.id):(p=e[1],o.id=p.id),++r}return r},c.EdgeSeparation=function(t,e,i,n,o){void 0===i&&(i=0);var r,s,a=(parseInt(t.m_vertexCount),t.m_vertices),l=t.m_normals,u=parseInt(n.m_vertexCount),h=n.m_vertices;r=e.R,s=l[i];var c=r.col1.x*s.x+r.col2.x*s.y,p=r.col1.y*s.x+r.col2.y*s.y;r=o.R;for(var d=r.col1.x*c+r.col1.y*p,f=r.col2.x*c+r.col2.y*p,m=0,_=Number.MAX_VALUE,y=0;y<u;++y){s=h[y];var x=s.x*d+s.y*f;x<_&&(_=x,m=y)}s=a[i],r=e.R;var v=e.position.x+(r.col1.x*s.x+r.col2.x*s.y),g=e.position.y+(r.col1.y*s.x+r.col2.y*s.y);s=h[m],r=o.R;var b=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),w=o.position.y+(r.col1.y*s.x+r.col2.y*s.y);b-=v,w-=g;var S=b*c+w*p;return S},c.FindMaxSeparation=function(t,e,i,n,o){var r,s,a=parseInt(e.m_vertexCount),l=e.m_normals;s=o.R,r=n.m_centroid;var u=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),h=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);s=i.R,r=e.m_centroid,u-=i.position.x+(s.col1.x*r.x+s.col2.x*r.y),h-=i.position.y+(s.col1.y*r.x+s.col2.y*r.y);for(var p=u*i.R.col1.x+h*i.R.col1.y,d=u*i.R.col2.x+h*i.R.col2.y,f=0,m=-Number.MAX_VALUE,_=0;_<a;++_){r=l[_];var y=r.x*p+r.y*d;y>m&&(m=y,f=_)}var x=c.EdgeSeparation(e,i,f,n,o),v=parseInt(f-1>=0?f-1:a-1),g=c.EdgeSeparation(e,i,v,n,o),b=parseInt(f+1<a?f+1:0),w=c.EdgeSeparation(e,i,b,n,o),S=0,C=0,D=0;if(g>x&&g>w)D=-1,S=v,C=g;else{if(!(w>x))return t[0]=f,x;D=1,S=b,C=w}for(;;){if(f=D==-1?S-1>=0?S-1:a-1:S+1<a?S+1:0,x=c.EdgeSeparation(e,i,f,n,o),!(x>C))break;S=f,C=x}return t[0]=S,C},c.FindIncidentEdge=function(t,e,i,n,o,r){void 0===n&&(n=0);var s,a,l=(parseInt(e.m_vertexCount),e.m_normals),u=parseInt(o.m_vertexCount),h=o.m_vertices,c=o.m_normals;s=i.R,a=l[n];var p=s.col1.x*a.x+s.col2.x*a.y,d=s.col1.y*a.x+s.col2.y*a.y;s=r.R;var f=s.col1.x*p+s.col1.y*d;d=s.col2.x*p+s.col2.y*d,p=f;for(var m=0,_=Number.MAX_VALUE,y=0;y<u;++y){a=c[y];var x=p*a.x+d*a.y;x<_&&(_=x,m=y)}var v,g=parseInt(m),b=parseInt(g+1<u?g+1:0);v=t[0],a=h[g],s=r.R,v.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),v.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=g,v.id.features.incidentVertex=0,v=t[1],a=h[b],s=r.R,v.v.x=r.position.x+(s.col1.x*a.x+s.col2.x*a.y),v.v.y=r.position.y+(s.col1.y*a.x+s.col2.y*a.y),v.id.features.referenceEdge=n,v.id.features.incidentEdge=b,v.id.features.incidentVertex=1},c.MakeClipPointVector=function(){var t=new Vector(2);return t[0]=new L,t[1]=new L,t},c.CollidePolygons=function(t,e,i,o,r){var s;t.m_pointCount=0;var a=e.m_radius+o.m_radius,l=0;c.s_edgeAO[0]=l;var u=c.FindMaxSeparation(c.s_edgeAO,e,i,o,r);if(l=c.s_edgeAO[0],!(u>a)){var h=0;c.s_edgeBO[0]=h;var p=c.FindMaxSeparation(c.s_edgeBO,o,r,e,i);if(h=c.s_edgeBO[0],!(p>a)){var d,f,m,_,y,x=0,v=0,g=.98,b=.001;p>g*u+b?(d=o,f=e,m=r,_=i,x=h,t.m_type=w.e_faceB,v=1):(d=e,f=o,m=i,_=r,x=l,t.m_type=w.e_faceA,v=0);var S=c.s_incidentEdge;c.FindIncidentEdge(S,d,m,x,f,_);var C,D=parseInt(d.m_vertexCount),T=d.m_vertices,A=T[x];C=x+1<D?T[parseInt(x+1)]:T[0];var B=c.s_localTangent;B.Set(C.x-A.x,C.y-A.y),B.Normalize();var M=c.s_localNormal;M.x=B.y,M.y=-B.x;var E=c.s_planePoint;E.Set(.5*(A.x+C.x),.5*(A.y+C.y));var P=c.s_tangent;y=m.R,P.x=y.col1.x*B.x+y.col2.x*B.y,P.y=y.col1.y*B.x+y.col2.y*B.y;var I=c.s_tangent2;I.x=-P.x,I.y=-P.y;var O=c.s_normal;O.x=P.y,O.y=-P.x;var R=c.s_v11,L=c.s_v12;R.x=m.position.x+(y.col1.x*A.x+y.col2.x*A.y),R.y=m.position.y+(y.col1.y*A.x+y.col2.y*A.y),L.x=m.position.x+(y.col1.x*C.x+y.col2.x*C.y),L.y=m.position.y+(y.col1.y*C.x+y.col2.y*C.y);var F=O.x*R.x+O.y*R.y,V=-P.x*R.x-P.y*R.y+a,k=P.x*L.x+P.y*L.y+a,G=c.s_clipPoints1,N=c.s_clipPoints2,j=0;if(j=c.ClipSegmentToLine(G,S,I,V),!(j<2||(j=c.ClipSegmentToLine(N,G,P,k),j<2))){t.m_localPlaneNormal.SetV(M),t.m_localPoint.SetV(E);for(var U=0,X=0;X<n.b2_maxManifoldPoints;++X){s=N[X];var J=O.x*s.v.x+O.y*s.v.y-F;if(J<=a){var W=t.m_points[U];y=_.R;var z=s.v.x-_.position.x,H=s.v.y-_.position.y;W.m_localPoint.x=z*y.col1.x+H*y.col1.y,W.m_localPoint.y=z*y.col2.x+H*y.col2.y,W.m_id.Set(s.id),W.m_id.features.flip=v,++U}}t.m_pointCount=U}}}},c.CollideCircles=function(t,e,i,n,o){t.m_pointCount=0;var r,s;r=i.R,s=e.m_p;var a=i.position.x+(r.col1.x*s.x+r.col2.x*s.y),l=i.position.y+(r.col1.y*s.x+r.col2.y*s.y);r=o.R,s=n.m_p;var u=o.position.x+(r.col1.x*s.x+r.col2.x*s.y),h=o.position.y+(r.col1.y*s.x+r.col2.y*s.y),c=u-a,p=h-l,d=c*c+p*p,f=e.m_radius+n.m_radius;d>f*f||(t.m_type=w.e_circles,t.m_localPoint.SetV(e.m_p),t.m_localPlaneNormal.SetZero(),t.m_pointCount=1,t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0)},c.CollidePolygonAndCircle=function(t,e,i,n,o){t.m_pointCount=0;var r,s,a=0,l=0;s=o.R,r=n.m_p;var u=o.position.x+(s.col1.x*r.x+s.col2.x*r.y),h=o.position.y+(s.col1.y*r.x+s.col2.y*r.y);a=u-i.position.x,l=h-i.position.y,s=i.R;for(var c=a*s.col1.x+l*s.col1.y,p=a*s.col2.x+l*s.col2.y,d=0,f=-Number.MAX_VALUE,m=e.m_radius+n.m_radius,_=parseInt(e.m_vertexCount),y=e.m_vertices,x=e.m_normals,v=0;v<_;++v){r=y[v],a=c-r.x,l=p-r.y,r=x[v];var g=r.x*a+r.y*l;if(g>m)return;g>f&&(f=g,d=v)}var b=parseInt(d),S=parseInt(b+1<_?b+1:0),C=y[b],D=y[S];if(f<Number.MIN_VALUE)return t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.SetV(x[d]),t.m_localPoint.x=.5*(C.x+D.x),t.m_localPoint.y=.5*(C.y+D.y),t.m_points[0].m_localPoint.SetV(n.m_p),void(t.m_points[0].m_id.key=0);var T=(c-C.x)*(D.x-C.x)+(p-C.y)*(D.y-C.y),A=(c-D.x)*(C.x-D.x)+(p-D.y)*(C.y-D.y);if(T<=0){if((c-C.x)*(c-C.x)+(p-C.y)*(p-C.y)>m*m)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=c-C.x,t.m_localPlaneNormal.y=p-C.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(C),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else if(A<=0){if((c-D.x)*(c-D.x)+(p-D.y)*(p-D.y)>m*m)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=c-D.x,t.m_localPlaneNormal.y=p-D.y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.SetV(D),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}else{var B=.5*(C.x+D.x),M=.5*(C.y+D.y);if(f=(c-B)*x[b].x+(p-M)*x[b].y,f>m)return;t.m_pointCount=1,t.m_type=w.e_faceA,t.m_localPlaneNormal.x=x[b].x,t.m_localPlaneNormal.y=x[b].y,t.m_localPlaneNormal.Normalize(),t.m_localPoint.Set(B,M),t.m_points[0].m_localPoint.SetV(n.m_p),t.m_points[0].m_id.key=0}},c.TestOverlap=function(t,e){var i=e.lowerBound,n=t.upperBound,o=i.x-n.x,r=i.y-n.y;i=t.lowerBound,n=e.upperBound;var s=i.x-n.x,a=i.y-n.y;return!(o>0||r>0)&&!(s>0||a>0)},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=c.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=c.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=c.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new a,Box2D.Collision.b2Collision.s_localNormal=new a,Box2D.Collision.b2Collision.s_planePoint=new a,Box2D.Collision.b2Collision.s_normal=new a,Box2D.Collision.b2Collision.s_tangent=new a,Box2D.Collision.b2Collision.s_tangent2=new a,Box2D.Collision.b2Collision.s_v11=new a,Box2D.Collision.b2Collision.s_v12=new a,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new a,Box2D.Collision.b2Collision.b2_nullFeature=255}),p.b2ContactID=function(){this.features=new F},p.prototype.b2ContactID=function(){this.features._m_id=this},p.prototype.Set=function(t){this.key=t._key},p.prototype.Copy=function(){var t=new p;return t.key=this.key,t},Object.defineProperty(p.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}}),Object.defineProperty(p.prototype,"key",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._key=t,this.features._referenceEdge=255&this._key,this.features._incidentEdge=(65280&this._key)>>8&255,this.features._incidentVertex=(16711680&this._key)>>16&255,this.features._flip=(4278190080&this._key)>>24&255}}),d.b2ContactPoint=function(){this.position=new a,this.velocity=new a,this.normal=new a,this.id=new p},f.b2Distance=function(){},f.Distance=function(t,e,i){++f.b2_gjkCalls;var r=i.proxyA,s=i.proxyB,l=i.transformA,u=i.transformB,h=f.s_simplex;h.ReadCache(e,r,l,s,u);for(var c,p=h.m_vertices,d=20,m=f.s_saveA,_=f.s_saveB,y=0,x=h.GetClosestPoint(),v=x.LengthSquared(),g=v,b=0,w=0;w<d;){for(y=h.m_count,b=0;b<y;b++)m[b]=p[b].indexA,_[b]=p[b].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3();break;default:n.b2Assert(!1)}if(3==h.m_count)break;c=h.GetClosestPoint(),g=c.LengthSquared(),v=g;var S=h.GetSearchDirection();if(S.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var C=p[h.m_count];C.indexA=r.GetSupport(o.MulTMV(l.R,S.GetNegative())),C.wA=o.MulX(l,r.GetVertex(C.indexA)),C.indexB=s.GetSupport(o.MulTMV(u.R,S)),C.wB=o.MulX(u,s.GetVertex(C.indexB)),C.w=o.SubtractVV(C.wB,C.wA),++w,++f.b2_gjkIters;var D=!1;for(b=0;b<y;b++)if(C.indexA==m[b]&&C.indexB==_[b]){D=!0;break}if(D)break;++h.m_count}if(f.b2_gjkMaxIters=o.Max(f.b2_gjkMaxIters,w),h.GetWitnessPoints(t.pointA,t.pointB),t.distance=o.SubtractVV(t.pointA,t.pointB).Length(),t.iterations=w,h.WriteCache(e),i.useRadii){var T=r.m_radius,A=s.m_radius;if(t.distance>T+A&&t.distance>Number.MIN_VALUE){t.distance-=T+A;var B=o.SubtractVV(t.pointB,t.pointA);B.Normalize(),t.pointA.x+=T*B.x,t.pointA.y+=T*B.y,t.pointB.x-=A*B.x,t.pointB.y-=A*B.y}else c=new a,c.x=.5*(t.pointA.x+t.pointB.x),c.y=.5*(t.pointA.y+t.pointB.y),t.pointA.x=t.pointB.x=c.x,t.pointA.y=t.pointB.y=c.y,t.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new M,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),m.b2DistanceInput=function(){},_.b2DistanceOutput=function(){this.pointA=new a,this.pointB=new a},y.b2DistanceProxy=function(){},y.prototype.Set=function(o){switch(o.GetType()){case i.e_circleShape:var r=o instanceof t?o:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=r.m_p,this.m_count=1,this.m_radius=r.m_radius;break;case i.e_polygonShape:var s=o instanceof e?o:null;this.m_vertices=s.m_vertices,this.m_count=s.m_vertexCount,this.m_radius=s.m_radius;break;default:n.b2Assert(!1)}},y.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return e},y.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_count;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return this.m_vertices[e]},y.prototype.GetVertexCount=function(){return this.m_count},y.prototype.GetVertex=function(t){return void 0===t&&(t=0),n.b2Assert(0<=t&&t<this.m_count),this.m_vertices[t]},x.b2DynamicTree=function(){},x.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},x.prototype.CreateProxy=function(t,e){var i=this.AllocateNode(),o=n.b2_aabbExtension,r=n.b2_aabbExtension;return i.aabb.lowerBound.x=t.lowerBound.x-o,i.aabb.lowerBound.y=t.lowerBound.y-r,i.aabb.upperBound.x=t.upperBound.x+o,i.aabb.upperBound.y=t.upperBound.y+r,i.userData=e,this.InsertLeaf(i),i},x.prototype.DestroyProxy=function(t){this.RemoveLeaf(t),this.FreeNode(t)},x.prototype.MoveProxy=function(t,e,i){if(n.b2Assert(t.IsLeaf()),t.aabb.Contains(e))return!1;this.RemoveLeaf(t);var o=n.b2_aabbExtension+n.b2_aabbMultiplier*(i.x>0?i.x:-i.x),r=n.b2_aabbExtension+n.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return t.aabb.lowerBound.x=e.lowerBound.x-o,t.aabb.lowerBound.y=e.lowerBound.y-r,t.aabb.upperBound.x=e.upperBound.x+o,t.aabb.upperBound.y=e.upperBound.y+r,this.InsertLeaf(t),!0},x.prototype.Rebalance=function(t){if(void 0===t&&(t=0),null!=this.m_root)for(var e=0;e<t;e++){for(var i=this.m_root,n=0;0==i.IsLeaf();)i=this.m_path>>n&1?i.child2:i.child1,n=n+1&31;++this.m_path,this.RemoveLeaf(i),this.InsertLeaf(i)}},x.prototype.GetFatAABB=function(t){return t.aabb},x.prototype.GetUserData=function(t){return t.userData},x.prototype.Query=function(t,e){if(null!=this.m_root){var i=new Vector,n=0;for(i[n++]=this.m_root;n>0;){var o=i[--n];if(o.aabb.TestOverlap(e))if(o.IsLeaf()){var r=t(o);if(!r)return}else i[n++]=o.child1,i[n++]=o.child2}}},x.prototype.RayCast=function(t,e){if(null!=this.m_root){var i=e.p1,n=e.p2,r=o.SubtractVV(i,n);r.Normalize();var s=o.CrossFV(1,r),a=o.AbsV(s),u=e.maxFraction,h=new l,c=0,p=0;c=i.x+u*(n.x-i.x),p=i.y+u*(n.y-i.y),h.lowerBound.x=Math.min(i.x,c),h.lowerBound.y=Math.min(i.y,p),h.upperBound.x=Math.max(i.x,c),h.upperBound.y=Math.max(i.y,p);var d=new Vector,f=0;for(d[f++]=this.m_root;f>0;){var m=d[--f];if(0!=m.aabb.TestOverlap(h)){var _=m.aabb.GetCenter(),y=m.aabb.GetExtents(),x=Math.abs(s.x*(i.x-_.x)+s.y*(i.y-_.y))-a.x*y.x-a.y*y.y;if(!(x>0))if(m.IsLeaf()){var v=new D;if(v.p1=e.p1,v.p2=e.p2,v.maxFraction=e.maxFraction,u=t(v,m),0==u)return;u>0&&(c=i.x+u*(n.x-i.x),p=i.y+u*(n.y-i.y),h.lowerBound.x=Math.min(i.x,c),h.lowerBound.y=Math.min(i.y,p),h.upperBound.x=Math.max(i.x,c),h.upperBound.y=Math.max(i.y,p))}else d[f++]=m.child1,d[f++]=m.child2}}}},x.prototype.AllocateNode=function(){if(this.m_freeList){var t=this.m_freeList;return this.m_freeList=t.parent,t.parent=null,t.child1=null,t.child2=null,t}return new g},x.prototype.FreeNode=function(t){t.parent=this.m_freeList,this.m_freeList=t},x.prototype.InsertLeaf=function(t){if(++this.m_insertionCount,null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);var e=t.aabb.GetCenter(),i=this.m_root;if(0==i.IsLeaf())do{var n=i.child1,o=i.child2,r=Math.abs((n.aabb.lowerBound.x+n.aabb.upperBound.x)/2-e.x)+Math.abs((n.aabb.lowerBound.y+n.aabb.upperBound.y)/2-e.y),s=Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-e.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-e.y);i=r<s?n:o}while(0==i.IsLeaf());var a=i.parent,l=this.AllocateNode();if(l.parent=a,l.userData=null,l.aabb.Combine(t.aabb,i.aabb),a){i.parent.child1==i?a.child1=l:a.child2=l,l.child1=i,l.child2=t,i.parent=l,t.parent=l;do{if(a.aabb.Contains(l.aabb))break;a.aabb.Combine(a.child1.aabb,a.child2.aabb),l=a,a=a.parent}while(a)}else l.child1=i,l.child2=t,i.parent=l,t.parent=l,this.m_root=l},x.prototype.RemoveLeaf=function(t){if(t==this.m_root)return void(this.m_root=null);var e,i=t.parent,n=i.parent;if(e=i.child1==t?i.child2:i.child1,n)for(n.child1==i?n.child1=e:n.child2=e,e.parent=n,this.FreeNode(i);n;){var o=n.aabb;if(n.aabb=l.Combine(n.child1.aabb,n.child2.aabb),o.Contains(n.aabb))break;n=n.parent}else this.m_root=e,e.parent=null,this.FreeNode(i)},v.b2DynamicTreeBroadPhase=function(){this.m_tree=new x,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},v.prototype.CreateProxy=function(t,e){var i=this.m_tree.CreateProxy(t,e);return++this.m_proxyCount,this.BufferMove(i),i},v.prototype.DestroyProxy=function(t){this.UnBufferMove(t),--this.m_proxyCount,this.m_tree.DestroyProxy(t)},v.prototype.MoveProxy=function(t,e,i){var n=this.m_tree.MoveProxy(t,e,i);n&&this.BufferMove(t)},v.prototype.TestOverlap=function(t,e){var i=this.m_tree.GetFatAABB(t),n=this.m_tree.GetFatAABB(e);return i.TestOverlap(n)},v.prototype.GetUserData=function(t){return this.m_tree.GetUserData(t)},v.prototype.GetFatAABB=function(t){return this.m_tree.GetFatAABB(t)},v.prototype.GetProxyCount=function(){return this.m_proxyCount},v.prototype.UpdatePairs=function(t){function e(t){if(t==n)return!0;i.m_pairCount==i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new b);var e=i.m_pairBuffer[i.m_pairCount];return e.proxyA=t<n?t:n,e.proxyB=t>=n?t:n,++i.m_pairCount,!0}var i=this;i.m_pairCount=0;var n,o=0;for(o=0;o<i.m_moveBuffer.length;++o){n=i.m_moveBuffer[o];var r=i.m_tree.GetFatAABB(n);i.m_tree.Query(e,r)}i.m_moveBuffer.length=0;for(var o=0;o<i.m_pairCount;){var s=i.m_pairBuffer[o],a=i.m_tree.GetUserData(s.proxyA),l=i.m_tree.GetUserData(s.proxyB);for(t(a,l),++o;o<i.m_pairCount;){var u=i.m_pairBuffer[o];if(u.proxyA!=s.proxyA||u.proxyB!=s.proxyB)break;++o}}},v.prototype.Query=function(t,e){this.m_tree.Query(t,e)},v.prototype.RayCast=function(t,e){this.m_tree.RayCast(t,e)},v.prototype.Validate=function(){},v.prototype.Rebalance=function(t){void 0===t&&(t=0),this.m_tree.Rebalance(t)},v.prototype.BufferMove=function(t){this.m_moveBuffer[this.m_moveBuffer.length]=t},v.prototype.UnBufferMove=function(t){var e=parseInt(this.m_moveBuffer.indexOf(t));this.m_moveBuffer.splice(e,1)},v.prototype.ComparePairs=function(t,e){return 0},v.__implements={},v.__implements[V]=!0,g.b2DynamicTreeNode=function(){this.aabb=new l},g.prototype.IsLeaf=function(){return null==this.child1},b.b2DynamicTreePair=function(){},w.b2Manifold=function(){this.m_pointCount=0},w.prototype.b2Manifold=function(){this.m_points=new Vector(n.b2_maxManifoldPoints);for(var t=0;t<n.b2_maxManifoldPoints;t++)this.m_points[t]=new S;this.m_localPlaneNormal=new a,this.m_localPoint=new a},w.prototype.Reset=function(){for(var t=0;t<n.b2_maxManifoldPoints;t++)(this.m_points[t]instanceof S?this.m_points[t]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},w.prototype.Set=function(t){this.m_pointCount=t.m_pointCount;for(var e=0;e<n.b2_maxManifoldPoints;e++)(this.m_points[e]instanceof S?this.m_points[e]:null).Set(t.m_points[e]);this.m_localPlaneNormal.SetV(t.m_localPlaneNormal),this.m_localPoint.SetV(t.m_localPoint),this.m_type=t.m_type},w.prototype.Copy=function(){var t=new w;return t.Set(this),t},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),S.b2ManifoldPoint=function(){this.m_localPoint=new a,this.m_id=new p},S.prototype.b2ManifoldPoint=function(){this.Reset()},S.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},S.prototype.Set=function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)},C.b2Point=function(){this.p=new a},C.prototype.Support=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),this.p},C.prototype.GetFirstVertex=function(t){return this.p},D.b2RayCastInput=function(){this.p1=new a,this.p2=new a},D.prototype.b2RayCastInput=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=1),t&&this.p1.SetV(t),e&&this.p2.SetV(e),this.maxFraction=i},T.b2RayCastOutput=function(){this.normal=new a},A.b2Segment=function(){this.p1=new a,this.p2=new a},A.prototype.TestSegment=function(t,e,i,n){void 0===n&&(n=0);var o=i.p1,r=i.p2.x-o.x,s=i.p2.y-o.y,a=this.p2.x-this.p1.x,l=this.p2.y-this.p1.y,u=l,h=-a,c=100*Number.MIN_VALUE,p=-(r*u+s*h);if(p>c){var d=o.x-this.p1.x,f=o.y-this.p1.y,m=d*u+f*h;if(0<=m&&m<=n*p){var _=-r*f+s*d;if(-c*p<=_&&_<=p*(1+c)){m/=p;var y=Math.sqrt(u*u+h*h);return u/=y,h/=y,t[0]=m,e.Set(u,h),!0}}}return!1},A.prototype.Extend=function(t){this.ExtendForward(t),this.ExtendBackward(t)},A.prototype.ExtendForward=function(t){var e=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p1.x)/e:e<0?(t.lowerBound.x-this.p1.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p1.y)/i:i<0?(t.lowerBound.y-this.p1.y)/i:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+e*n,this.p2.y=this.p1.y+i*n},A.prototype.ExtendBackward=function(t){var e=-this.p2.x+this.p1.x,i=-this.p2.y+this.p1.y,n=Math.min(e>0?(t.upperBound.x-this.p2.x)/e:e<0?(t.lowerBound.x-this.p2.x)/e:Number.POSITIVE_INFINITY,i>0?(t.upperBound.y-this.p2.y)/i:i<0?(t.lowerBound.y-this.p2.y)/i:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+e*n,this.p1.y=this.p2.y+i*n},B.b2SeparationFunction=function(){this.m_localPoint=new a,this.m_axis=new a},B.prototype.Initialize=function(t,e,i,r,s){this.m_proxyA=e,this.m_proxyB=r;var l=parseInt(t.count);n.b2Assert(0<l&&l<3);var u,h,c,p,d,f,m,_,y=0,x=0,v=0,g=0,b=0,w=0,S=0,C=0;if(1==l)this.m_type=B.e_points,u=this.m_proxyA.GetVertex(t.indexA[0]),p=this.m_proxyB.GetVertex(t.indexB[0]),_=u,m=i.R,y=i.position.x+(m.col1.x*_.x+m.col2.x*_.y),x=i.position.y+(m.col1.y*_.x+m.col2.y*_.y),_=p,m=s.R,v=s.position.x+(m.col1.x*_.x+m.col2.x*_.y),g=s.position.y+(m.col1.y*_.x+m.col2.y*_.y),this.m_axis.x=v-y,this.m_axis.y=g-x,this.m_axis.Normalize();else if(t.indexB[0]==t.indexB[1])this.m_type=B.e_faceA,h=this.m_proxyA.GetVertex(t.indexA[0]),c=this.m_proxyA.GetVertex(t.indexA[1]),p=this.m_proxyB.GetVertex(t.indexB[0]),this.m_localPoint.x=.5*(h.x+c.x),this.m_localPoint.y=.5*(h.y+c.y),this.m_axis=o.CrossVF(o.SubtractVV(c,h),1),this.m_axis.Normalize(),_=this.m_axis,m=i.R,b=m.col1.x*_.x+m.col2.x*_.y,w=m.col1.y*_.x+m.col2.y*_.y,_=this.m_localPoint,m=i.R,y=i.position.x+(m.col1.x*_.x+m.col2.x*_.y),x=i.position.y+(m.col1.y*_.x+m.col2.y*_.y),_=p,m=s.R,v=s.position.x+(m.col1.x*_.x+m.col2.x*_.y),g=s.position.y+(m.col1.y*_.x+m.col2.y*_.y),S=(v-y)*b+(g-x)*w,S<0&&this.m_axis.NegativeSelf();else if(t.indexA[0]==t.indexA[0])this.m_type=B.e_faceB,d=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]),u=this.m_proxyA.GetVertex(t.indexA[0]),this.m_localPoint.x=.5*(d.x+f.x),this.m_localPoint.y=.5*(d.y+f.y),this.m_axis=o.CrossVF(o.SubtractVV(f,d),1),this.m_axis.Normalize(),_=this.m_axis,m=s.R,b=m.col1.x*_.x+m.col2.x*_.y,w=m.col1.y*_.x+m.col2.y*_.y,_=this.m_localPoint,m=s.R,v=s.position.x+(m.col1.x*_.x+m.col2.x*_.y),g=s.position.y+(m.col1.y*_.x+m.col2.y*_.y),_=u,m=i.R,y=i.position.x+(m.col1.x*_.x+m.col2.x*_.y),x=i.position.y+(m.col1.y*_.x+m.col2.y*_.y),S=(y-v)*b+(x-g)*w,S<0&&this.m_axis.NegativeSelf();else{h=this.m_proxyA.GetVertex(t.indexA[0]),c=this.m_proxyA.GetVertex(t.indexA[1]),d=this.m_proxyB.GetVertex(t.indexB[0]),f=this.m_proxyB.GetVertex(t.indexB[1]);var D=(o.MulX(i,u),o.MulMV(i.R,o.SubtractVV(c,h))),T=(o.MulX(s,p),o.MulMV(s.R,o.SubtractVV(f,d))),A=D.x*D.x+D.y*D.y,M=T.x*T.x+T.y*T.y,E=o.SubtractVV(T,D),P=D.x*E.x+D.y*E.y,I=T.x*E.x+T.y*E.y,O=D.x*T.x+D.y*T.y,R=A*M-O*O;S=0,0!=R&&(S=o.Clamp((O*I-P*M)/R,0,1));var L=(O*S+I)/M;L<0&&(L=0,S=o.Clamp((O-P)/A,0,1)),u=new a,u.x=h.x+S*(c.x-h.x),u.y=h.y+S*(c.y-h.y),p=new a,p.x=d.x+S*(f.x-d.x),p.y=d.y+S*(f.y-d.y),0==S||1==S?(this.m_type=B.e_faceB,this.m_axis=o.CrossVF(o.SubtractVV(f,d),1),this.m_axis.Normalize(),this.m_localPoint=p,_=this.m_axis,m=s.R,b=m.col1.x*_.x+m.col2.x*_.y,w=m.col1.y*_.x+m.col2.y*_.y,_=this.m_localPoint,m=s.R,v=s.position.x+(m.col1.x*_.x+m.col2.x*_.y),g=s.position.y+(m.col1.y*_.x+m.col2.y*_.y),_=u,m=i.R,y=i.position.x+(m.col1.x*_.x+m.col2.x*_.y),
x=i.position.y+(m.col1.y*_.x+m.col2.y*_.y),C=(y-v)*b+(x-g)*w,S<0&&this.m_axis.NegativeSelf()):(this.m_type=B.e_faceA,this.m_axis=o.CrossVF(o.SubtractVV(c,h),1),this.m_localPoint=u,_=this.m_axis,m=i.R,b=m.col1.x*_.x+m.col2.x*_.y,w=m.col1.y*_.x+m.col2.y*_.y,_=this.m_localPoint,m=i.R,y=i.position.x+(m.col1.x*_.x+m.col2.x*_.y),x=i.position.y+(m.col1.y*_.x+m.col2.y*_.y),_=p,m=s.R,v=s.position.x+(m.col1.x*_.x+m.col2.x*_.y),g=s.position.y+(m.col1.y*_.x+m.col2.y*_.y),C=(v-y)*b+(g-x)*w,S<0&&this.m_axis.NegativeSelf())}},B.prototype.Evaluate=function(t,e){var i,r,s,a,l,u,h,c=0;switch(this.m_type){case B.e_points:return i=o.MulTMV(t.R,this.m_axis),r=o.MulTMV(e.R,this.m_axis.GetNegative()),s=this.m_proxyA.GetSupportVertex(i),a=this.m_proxyB.GetSupportVertex(r),l=o.MulX(t,s),u=o.MulX(e,a),c=(u.x-l.x)*this.m_axis.x+(u.y-l.y)*this.m_axis.y;case B.e_faceA:return h=o.MulMV(t.R,this.m_axis),l=o.MulX(t,this.m_localPoint),r=o.MulTMV(e.R,h.GetNegative()),a=this.m_proxyB.GetSupportVertex(r),u=o.MulX(e,a),c=(u.x-l.x)*h.x+(u.y-l.y)*h.y;case B.e_faceB:return h=o.MulMV(e.R,this.m_axis),u=o.MulX(e,this.m_localPoint),i=o.MulTMV(t.R,h.GetNegative()),s=this.m_proxyA.GetSupportVertex(i),l=o.MulX(t,s),c=(l.x-u.x)*h.x+(l.y-u.y)*h.y;default:return n.b2Assert(!1),0}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),M.b2Simplex=function(){this.m_v1=new P,this.m_v2=new P,this.m_v3=new P,this.m_vertices=new Vector(3)},M.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},M.prototype.ReadCache=function(t,e,i,r,s){n.b2Assert(0<=t.count&&t.count<=3);var a,l;this.m_count=t.count;for(var u=this.m_vertices,h=0;h<this.m_count;h++){var c=u[h];c.indexA=t.indexA[h],c.indexB=t.indexB[h],a=e.GetVertex(c.indexA),l=r.GetVertex(c.indexB),c.wA=o.MulX(i,a),c.wB=o.MulX(s,l),c.w=o.SubtractVV(c.wB,c.wA),c.a=0}if(this.m_count>1){var p=t.metric,d=this.GetMetric();(d<.5*p||2*p<d||d<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(c=u[0],c.indexA=0,c.indexB=0,a=e.GetVertex(0),l=r.GetVertex(0),c.wA=o.MulX(i,a),c.wB=o.MulX(s,l),c.w=o.SubtractVV(c.wB,c.wA),this.m_count=1)},M.prototype.WriteCache=function(t){t.metric=this.GetMetric(),t.count=Box2D.parseUInt(this.m_count);for(var e=this.m_vertices,i=0;i<this.m_count;i++)t.indexA[i]=Box2D.parseUInt(e[i].indexA),t.indexB[i]=Box2D.parseUInt(e[i].indexB)},M.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=o.SubtractVV(this.m_v2.w,this.m_v1.w),e=o.CrossVV(t,this.m_v1.w.GetNegative());return e>0?o.CrossFV(1,t):o.CrossVF(t,1);default:return n.b2Assert(!1),new a}},M.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return n.b2Assert(!1),new a;case 1:return this.m_v1.w;case 2:return new a(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return n.b2Assert(!1),new a}},M.prototype.GetWitnessPoints=function(t,e){switch(this.m_count){case 0:n.b2Assert(!1);break;case 1:t.SetV(this.m_v1.wA),e.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:n.b2Assert(!1)}},M.prototype.GetMetric=function(){switch(this.m_count){case 0:return n.b2Assert(!1),0;case 1:return 0;case 2:return o.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return o.CrossVV(o.SubtractVV(this.m_v2.w,this.m_v1.w),o.SubtractVV(this.m_v3.w,this.m_v1.w));default:return n.b2Assert(!1),0}},M.prototype.Solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,i=o.SubtractVV(e,t),n=-(t.x*i.x+t.y*i.y);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var r=e.x*i.x+e.y*i.y;if(r<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var s=1/(r+n);this.m_v1.a=r*s,this.m_v2.a=n*s,this.m_count=2},M.prototype.Solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w,n=o.SubtractVV(e,t),r=o.Dot(t,n),s=o.Dot(e,n),a=s,l=-r,u=o.SubtractVV(i,t),h=o.Dot(t,u),c=o.Dot(i,u),p=c,d=-h,f=o.SubtractVV(i,e),m=o.Dot(e,f),_=o.Dot(i,f),y=_,x=-m,v=o.CrossVV(n,u),g=v*o.CrossVV(e,i),b=v*o.CrossVV(i,t),w=v*o.CrossVV(t,e);if(l<=0&&d<=0)return this.m_v1.a=1,void(this.m_count=1);if(a>0&&l>0&&w<=0){var S=1/(a+l);return this.m_v1.a=a*S,this.m_v2.a=l*S,void(this.m_count=2)}if(p>0&&d>0&&b<=0){var C=1/(p+d);return this.m_v1.a=p*C,this.m_v3.a=d*C,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(a<=0&&x<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(p<=0&&y<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(y>0&&x>0&&g<=0){var D=1/(y+x);return this.m_v2.a=y*D,this.m_v3.a=x*D,this.m_count=2,void this.m_v1.Set(this.m_v3)}var T=1/(g+b+w);this.m_v1.a=g*T,this.m_v2.a=b*T,this.m_v3.a=w*T,this.m_count=3},E.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},P.b2SimplexVertex=function(){},P.prototype.Set=function(t){this.wA.SetV(t.wA),this.wB.SetV(t.wB),this.w.SetV(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB},I.b2TimeOfImpact=function(){},I.TimeOfImpact=function(t){++I.b2_toiCalls;var e=t.proxyA,i=t.proxyB,r=t.sweepA,s=t.sweepB;n.b2Assert(r.t0==s.t0),n.b2Assert(1-r.t0>Number.MIN_VALUE);var a=e.m_radius+i.m_radius,l=t.tolerance,u=0,h=1e3,c=0,p=0;for(I.s_cache.count=0,I.s_distanceInput.useRadii=!1;;){if(r.GetTransform(I.s_xfA,u),s.GetTransform(I.s_xfB,u),I.s_distanceInput.proxyA=e,I.s_distanceInput.proxyB=i,I.s_distanceInput.transformA=I.s_xfA,I.s_distanceInput.transformB=I.s_xfB,f.Distance(I.s_distanceOutput,I.s_cache,I.s_distanceInput),I.s_distanceOutput.distance<=0){u=1;break}I.s_fcn.Initialize(I.s_cache,e,I.s_xfA,i,I.s_xfB);var d=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(d<=0){u=1;break}if(0==c&&(p=d>a?o.Max(a-l,.75*a):o.Max(d-l,.02*a)),d-p<.5*l){if(0==c){u=1;break}break}var m=u,_=u,y=1,x=d;r.GetTransform(I.s_xfA,y),s.GetTransform(I.s_xfB,y);var v=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(v>=p){u=1;break}for(var g=0;;){var b=0;b=1&g?_+(p-x)*(y-_)/(v-x):.5*(_+y),r.GetTransform(I.s_xfA,b),s.GetTransform(I.s_xfB,b);var w=I.s_fcn.Evaluate(I.s_xfA,I.s_xfB);if(o.Abs(w-p)<.025*l){m=b;break}if(w>p?(_=b,x=w):(y=b,v=w),++g,++I.b2_toiRootIters,50==g)break}if(I.b2_toiMaxRootIters=o.Max(I.b2_toiMaxRootIters,g),m<(1+100*Number.MIN_VALUE)*u)break;if(u=m,c++,++I.b2_toiIters,c==h)break}return I.b2_toiMaxIters=o.Max(I.b2_toiMaxIters,c),u},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new E,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new m,Box2D.Collision.b2TimeOfImpact.s_xfA=new s,Box2D.Collision.b2TimeOfImpact.s_xfB=new s,Box2D.Collision.b2TimeOfImpact.s_fcn=new B,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new _}),O.b2TOIInput=function(){this.proxyA=new y,this.proxyB=new y,this.sweepA=new r,this.sweepB=new r},R.b2WorldManifold=function(){this.m_normal=new a},R.prototype.b2WorldManifold=function(){this.m_points=new Vector(n.b2_maxManifoldPoints);for(var t=0;t<n.b2_maxManifoldPoints;t++)this.m_points[t]=new a},R.prototype.Initialize=function(t,e,i,n,o){if(void 0===i&&(i=0),void 0===o&&(o=0),0!=t.m_pointCount){var r,s,a=0,l=0,u=0,h=0,c=0,p=0,d=0;switch(t.m_type){case w.e_circles:s=e.R,r=t.m_localPoint;var f=e.position.x+s.col1.x*r.x+s.col2.x*r.y,m=e.position.y+s.col1.y*r.x+s.col2.y*r.y;s=n.R,r=t.m_points[0].m_localPoint;var _=n.position.x+s.col1.x*r.x+s.col2.x*r.y,y=n.position.y+s.col1.y*r.x+s.col2.y*r.y,x=_-f,v=y-m,g=x*x+v*v;if(g>Number.MIN_VALUE*Number.MIN_VALUE){var b=Math.sqrt(g);this.m_normal.x=x/b,this.m_normal.y=v/b}else this.m_normal.x=1,this.m_normal.y=0;var S=f+i*this.m_normal.x,C=m+i*this.m_normal.y,D=_-o*this.m_normal.x,T=y-o*this.m_normal.y;this.m_points[0].x=.5*(S+D),this.m_points[0].y=.5*(C+T);break;case w.e_faceA:for(s=e.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,u=s.col1.y*r.x+s.col2.y*r.y,s=e.R,r=t.m_localPoint,h=e.position.x+s.col1.x*r.x+s.col2.x*r.y,c=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=l,this.m_normal.y=u,a=0;a<t.m_pointCount;a++)s=n.R,r=t.m_points[a].m_localPoint,p=n.position.x+s.col1.x*r.x+s.col2.x*r.y,d=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=p+.5*(i-(p-h)*l-(d-c)*u-o)*l,this.m_points[a].y=d+.5*(i-(p-h)*l-(d-c)*u-o)*u;break;case w.e_faceB:for(s=n.R,r=t.m_localPlaneNormal,l=s.col1.x*r.x+s.col2.x*r.y,u=s.col1.y*r.x+s.col2.y*r.y,s=n.R,r=t.m_localPoint,h=n.position.x+s.col1.x*r.x+s.col2.x*r.y,c=n.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_normal.x=-l,this.m_normal.y=-u,a=0;a<t.m_pointCount;a++)s=e.R,r=t.m_points[a].m_localPoint,p=e.position.x+s.col1.x*r.x+s.col2.x*r.y,d=e.position.y+s.col1.y*r.x+s.col2.y*r.y,this.m_points[a].x=p+.5*(o-(p-h)*l-(d-c)*u-i)*l,this.m_points[a].y=d+.5*(o-(p-h)*l-(d-c)*u-i)*u}}},L.ClipVertex=function(){this.v=new a,this.id=new p},L.prototype.Set=function(t){this.v.SetV(t.v),this.id.Set(t.id)},F.Features=function(){},Object.defineProperty(F.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}}),Object.defineProperty(F.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._referenceEdge=t,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(F.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}}),Object.defineProperty(F.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentEdge=t,this._m_id._key=4294902015&this._m_id._key|this._incidentEdge<<8&65280}}),Object.defineProperty(F.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}}),Object.defineProperty(F.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._incidentVertex=t,this._m_id._key=4278255615&this._m_id._key|this._incidentVertex<<16&16711680}}),Object.defineProperty(F.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}}),Object.defineProperty(F.prototype,"flip",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._flip=t,this._m_id._key=16777215&this._m_id._key|this._flip<<24&4278190080}})}(),function(){var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Collision.Shapes.b2CircleShape,i=Box2D.Collision.Shapes.b2EdgeChainDef,n=Box2D.Collision.Shapes.b2EdgeShape,o=Box2D.Collision.Shapes.b2MassData,r=Box2D.Collision.Shapes.b2PolygonShape,s=Box2D.Collision.Shapes.b2Shape,a=Box2D.Common.Math.b2Mat22,l=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),u=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform),h=Box2D.Common.Math.b2Vec2,c=(Box2D.Common.Math.b2Vec3,Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance),p=Box2D.Collision.b2DistanceInput,d=Box2D.Collision.b2DistanceOutput,f=Box2D.Collision.b2DistanceProxy,m=(Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache);Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape),e.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,e.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new h},e.prototype.Copy=function(){var t=new e;return t.Set(this),t},e.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,e)){var i=t instanceof e?t:null;this.m_p.SetV(i.m_p)}},e.prototype.TestPoint=function(t,e){var i=t.R,n=t.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=t.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);return n=e.x-n,o=e.y-o,n*n+o*o<=this.m_radius*this.m_radius},e.prototype.RayCast=function(t,e,i){var n=i.R,o=i.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),r=i.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),s=e.p1.x-o,a=e.p1.y-r,l=s*s+a*a-this.m_radius*this.m_radius,u=e.p2.x-e.p1.x,h=e.p2.y-e.p1.y,c=s*u+a*h,p=u*u+h*h,d=c*c-p*l;if(d<0||p<Number.MIN_VALUE)return!1;var f=-(c+Math.sqrt(d));return 0<=f&&f<=e.maxFraction*p&&(f/=p,t.fraction=f,t.normal.x=s+f*u,t.normal.y=a+f*h,t.normal.Normalize(),!0)},e.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_p.x+i.col2.x*this.m_p.y),o=e.position.y+(i.col1.y*this.m_p.x+i.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)},e.prototype.ComputeMass=function(e,i){void 0===i&&(i=0),e.mass=i*t.b2_pi*this.m_radius*this.m_radius,e.center.SetV(this.m_p),e.I=e.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=l.MulX(i,this.m_p),r=-(l.Dot(t,o)-e);if(r<-this.m_radius+Number.MIN_VALUE)return 0;if(r>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var s=this.m_radius*this.m_radius,a=r*r,u=s*(Math.asin(r/this.m_radius)+Math.PI/2)+r*Math.sqrt(s-a),h=-2/3*Math.pow(s-a,1.5)/u;return n.x=o.x+t.x*h,n.y=o.y+t.y*h,u},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(t){this.m_p.SetV(t)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(t){void 0===t&&(t=0),this.m_radius=t},e.prototype.b2CircleShape=function(t){void 0===t&&(t=0),this.__super.b2Shape.call(this),this.m_type=s.e_circleShape,this.m_radius=t},i.b2EdgeChainDef=function(){},i.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(n,Box2D.Collision.Shapes.b2Shape),n.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,n.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new h,this.m_v1=new h,this.m_v2=new h,this.m_coreV1=new h,this.m_coreV2=new h,this.m_normal=new h,this.m_direction=new h,this.m_cornerDir1=new h,this.m_cornerDir2=new h},n.prototype.TestPoint=function(t,e){return!1},n.prototype.RayCast=function(t,e,i){var n,o=e.p2.x-e.p1.x,r=e.p2.y-e.p1.y;n=i.R;var s=i.position.x+(n.col1.x*this.m_v1.x+n.col2.x*this.m_v1.y),a=i.position.y+(n.col1.y*this.m_v1.x+n.col2.y*this.m_v1.y),l=i.position.y+(n.col1.y*this.m_v2.x+n.col2.y*this.m_v2.y)-a,u=-(i.position.x+(n.col1.x*this.m_v2.x+n.col2.x*this.m_v2.y)-s),h=100*Number.MIN_VALUE,c=-(o*l+r*u);if(c>h){var p=e.p1.x-s,d=e.p1.y-a,f=p*l+d*u;if(0<=f&&f<=e.maxFraction*c){var m=-o*d+r*p;if(-h*c<=m&&m<=c*(1+h)){f/=c,t.fraction=f;var _=Math.sqrt(l*l+u*u);return t.normal.x=l/_,t.normal.y=u/_,!0}}}return!1},n.prototype.ComputeAABB=function(t,e){var i=e.R,n=e.position.x+(i.col1.x*this.m_v1.x+i.col2.x*this.m_v1.y),o=e.position.y+(i.col1.y*this.m_v1.x+i.col2.y*this.m_v1.y),r=e.position.x+(i.col1.x*this.m_v2.x+i.col2.x*this.m_v2.y),s=e.position.y+(i.col1.y*this.m_v2.x+i.col2.y*this.m_v2.y);n<r?(t.lowerBound.x=n,t.upperBound.x=r):(t.lowerBound.x=r,t.upperBound.x=n),o<s?(t.lowerBound.y=o,t.upperBound.y=s):(t.lowerBound.y=s,t.upperBound.y=o)},n.prototype.ComputeMass=function(t,e){void 0===e&&(e=0),t.mass=0,t.center.SetV(this.m_v1),t.I=0},n.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var o=new h(t.x*e,t.y*e),r=l.MulX(i,this.m_v1),s=l.MulX(i,this.m_v2),a=l.Dot(t,r)-e,u=l.Dot(t,s)-e;if(a>0){if(u>0)return 0;r.x=-u/(a-u)*r.x+a/(a-u)*s.x,r.y=-u/(a-u)*r.y+a/(a-u)*s.y}else u>0&&(s.x=-u/(a-u)*r.x+a/(a-u)*s.x,s.y=-u/(a-u)*r.y+a/(a-u)*s.y);return n.x=(o.x+r.x+s.x)/3,n.y=(o.y+r.y+s.y)/3,.5*((r.x-o.x)*(s.y-o.y)-(r.y-o.y)*(s.x-o.x))},n.prototype.GetLength=function(){return this.m_length},n.prototype.GetVertex1=function(){return this.m_v1},n.prototype.GetVertex2=function(){return this.m_v2},n.prototype.GetCoreVertex1=function(){return this.m_coreV1},n.prototype.GetCoreVertex2=function(){return this.m_coreV2},n.prototype.GetNormalVector=function(){return this.m_normal},n.prototype.GetDirectionVector=function(){return this.m_direction},n.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},n.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},n.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},n.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},n.prototype.GetFirstVertex=function(t){var e=t.R;return new h(t.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),t.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y))},n.prototype.GetNextEdge=function(){return this.m_nextEdge},n.prototype.GetPrevEdge=function(){return this.m_prevEdge},n.prototype.Support=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.R,o=t.position.x+(n.col1.x*this.m_coreV1.x+n.col2.x*this.m_coreV1.y),r=t.position.y+(n.col1.y*this.m_coreV1.x+n.col2.y*this.m_coreV1.y),s=t.position.x+(n.col1.x*this.m_coreV2.x+n.col2.x*this.m_coreV2.y),a=t.position.y+(n.col1.y*this.m_coreV2.x+n.col2.y*this.m_coreV2.y);return o*e+r*i>s*e+a*i?(this.s_supportVec.x=o,this.s_supportVec.y=r):(this.s_supportVec.x=s,this.s_supportVec.y=a),this.s_supportVec},n.prototype.b2EdgeShape=function(e,i){this.__super.b2Shape.call(this),this.m_type=s.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=e,this.m_v2=i,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-t.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-t.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-t.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-t.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},n.prototype.SetPrevEdge=function(t,e,i,n){this.m_prevEdge=t,this.m_coreV1=e,this.m_cornerDir1=i,this.m_cornerConvex1=n},n.prototype.SetNextEdge=function(t,e,i,n){this.m_nextEdge=t,this.m_coreV2=e,this.m_cornerDir2=i,this.m_cornerConvex2=n},o.b2MassData=function(){this.mass=0,this.center=new h(0,0),this.I=0},Box2D.inherit(r,Box2D.Collision.Shapes.b2Shape),r.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,r.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},r.prototype.Copy=function(){var t=new r;return t.Set(this),t},r.prototype.Set=function(t){if(this.__super.Set.call(this,t),Box2D.is(t,r)){var e=t instanceof r?t:null;this.m_centroid.SetV(e.m_centroid),this.m_vertexCount=e.m_vertexCount,this.Reserve(this.m_vertexCount);for(var i=0;i<this.m_vertexCount;i++)this.m_vertices[i].SetV(e.m_vertices[i]),this.m_normals[i].SetV(e.m_normals[i])}},r.prototype.SetAsArray=function(t,e){void 0===e&&(e=0);var i,n=new Vector,o=0;for(o=0;o<t.length;++o)i=t[o],n.push(i);this.SetAsVector(n,e)},r.AsArray=function(t,e){void 0===e&&(e=0);var i=new r;return i.SetAsArray(t,e),i},r.prototype.SetAsVector=function(e,i){void 0===i&&(i=0),0==i&&(i=e.length),t.b2Assert(2<=i),this.m_vertexCount=i,this.Reserve(i);var n=0;for(n=0;n<this.m_vertexCount;n++)this.m_vertices[n].SetV(e[n]);for(n=0;n<this.m_vertexCount;++n){var o=parseInt(n),s=parseInt(n+1<this.m_vertexCount?n+1:0),a=l.SubtractVV(this.m_vertices[s],this.m_vertices[o]);t.b2Assert(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[n].SetV(l.CrossVF(a,1)),this.m_normals[n].Normalize()}this.m_centroid=r.ComputeCentroid(this.m_vertices,this.m_vertexCount)},r.AsVector=function(t,e){void 0===e&&(e=0);var i=new r;return i.SetAsVector(t,e),i},r.prototype.SetAsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},r.AsBox=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=new r;return i.SetAsBox(t,e),i},r.prototype.SetAsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=i;var o=new u;o.position=i,o.R.Set(n);for(var r=0;r<this.m_vertexCount;++r)this.m_vertices[r]=l.MulX(o,this.m_vertices[r]),this.m_normals[r]=l.MulMV(o.R,this.m_normals[r])},r.AsOrientedBox=function(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=null),void 0===n&&(n=0);var o=new r;return o.SetAsOrientedBox(t,e,i,n),o},r.prototype.SetAsEdge=function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=l.CrossVF(l.SubtractVV(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},r.AsEdge=function(t,e){var i=new r;return i.SetAsEdge(t,e),i},r.prototype.TestPoint=function(t,e){for(var i,n=t.R,o=e.x-t.position.x,r=e.y-t.position.y,s=o*n.col1.x+r*n.col1.y,a=o*n.col2.x+r*n.col2.y,l=0;l<this.m_vertexCount;++l){i=this.m_vertices[l],o=s-i.x,r=a-i.y,i=this.m_normals[l];var u=i.x*o+i.y*r;if(u>0)return!1}return!0},r.prototype.RayCast=function(t,e,i){var n,o,r=0,s=e.maxFraction,a=0,l=0;a=e.p1.x-i.position.x,l=e.p1.y-i.position.y,n=i.R;var u=a*n.col1.x+l*n.col1.y,h=a*n.col2.x+l*n.col2.y;a=e.p2.x-i.position.x,l=e.p2.y-i.position.y,n=i.R;for(var c=a*n.col1.x+l*n.col1.y,p=a*n.col2.x+l*n.col2.y,d=c-u,f=p-h,m=parseInt(-1),_=0;_<this.m_vertexCount;++_){o=this.m_vertices[_],a=o.x-u,l=o.y-h,o=this.m_normals[_];var y=o.x*a+o.y*l,x=o.x*d+o.y*f;if(0==x){if(y<0)return!1}else x<0&&y<r*x?(r=y/x,m=_):x>0&&y<s*x&&(s=y/x);if(s<r-Number.MIN_VALUE)return!1}return m>=0&&(t.fraction=r,n=i.R,o=this.m_normals[m],t.normal.x=n.col1.x*o.x+n.col2.x*o.y,t.normal.y=n.col1.y*o.x+n.col2.y*o.y,!0)},r.prototype.ComputeAABB=function(t,e){for(var i=e.R,n=this.m_vertices[0],o=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),r=e.position.y+(i.col1.y*n.x+i.col2.y*n.y),s=o,a=r,l=1;l<this.m_vertexCount;++l){n=this.m_vertices[l];var u=e.position.x+(i.col1.x*n.x+i.col2.x*n.y),h=e.position.y+(i.col1.y*n.x+i.col2.y*n.y);o=o<u?o:u,r=r<h?r:h,s=s>u?s:u,a=a>h?a:h}t.lowerBound.x=o-this.m_radius,t.lowerBound.y=r-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius},r.prototype.ComputeMass=function(t,e){if(void 0===e&&(e=0),2==this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var i=0,n=0,o=0,r=0,s=0,a=0,l=1/3,u=0;u<this.m_vertexCount;++u){var h=this.m_vertices[u],c=u+1<this.m_vertexCount?this.m_vertices[parseInt(u+1)]:this.m_vertices[0],p=h.x-s,d=h.y-a,f=c.x-s,m=c.y-a,_=p*m-d*f,y=.5*_;o+=y,i+=y*l*(s+h.x+c.x),n+=y*l*(a+h.y+c.y);var x=s,v=a,g=p,b=d,w=f,S=m,C=l*(.25*(g*g+w*g+w*w)+(x*g+x*w))+.5*x*x,D=l*(.25*(b*b+S*b+S*S)+(v*b+v*S))+.5*v*v;r+=_*(C+D)}t.mass=e*o,i*=1/o,n*=1/o,t.center.Set(i,n),t.I=e*r},r.prototype.ComputeSubmergedArea=function(t,e,i,n){void 0===e&&(e=0);var r=l.MulTMV(i.R,t),s=e-l.Dot(t,i.position),a=new Vector_a2j_Number,u=0,c=parseInt(-1),p=parseInt(-1),d=!1,f=0;for(f=0;f<this.m_vertexCount;++f){a[f]=l.Dot(r,this.m_vertices[f])-s;var m=a[f]<-Number.MIN_VALUE;f>0&&(m?d||(c=f-1,u++):d&&(p=f-1,u++)),d=m}switch(u){case 0:if(d){var _=new o;return this.ComputeMass(_,1),n.SetV(l.MulX(i,_.center)),_.mass}return 0;case 1:c==-1?c=this.m_vertexCount-1:p=this.m_vertexCount-1}var y,x=parseInt((c+1)%this.m_vertexCount),v=parseInt((p+1)%this.m_vertexCount),g=(0-a[c])/(a[x]-a[c]),b=(0-a[p])/(a[v]-a[p]),w=new h(this.m_vertices[c].x*(1-g)+this.m_vertices[x].x*g,this.m_vertices[c].y*(1-g)+this.m_vertices[x].y*g),S=new h(this.m_vertices[p].x*(1-b)+this.m_vertices[v].x*b,this.m_vertices[p].y*(1-b)+this.m_vertices[v].y*b),C=0,D=new h,T=this.m_vertices[x];for(f=x;f!=v;){f=(f+1)%this.m_vertexCount,y=f==v?S:this.m_vertices[f];var A=.5*((T.x-w.x)*(y.y-w.y)-(T.y-w.y)*(y.x-w.x));C+=A,D.x+=A*(w.x+T.x+y.x)/3,D.y+=A*(w.y+T.y+y.y)/3,T=y}return D.Multiply(1/C),n.SetV(l.MulX(i,D)),C},r.prototype.GetVertexCount=function(){return this.m_vertexCount},r.prototype.GetVertices=function(){return this.m_vertices},r.prototype.GetNormals=function(){return this.m_normals},r.prototype.GetSupport=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return e},r.prototype.GetSupportVertex=function(t){for(var e=0,i=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,n=1;n<this.m_vertexCount;++n){var o=this.m_vertices[n].x*t.x+this.m_vertices[n].y*t.y;o>i&&(e=n,i=o)}return this.m_vertices[e]},r.prototype.Validate=function(){return!1},r.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=s.e_polygonShape,this.m_centroid=new h,this.m_vertices=new Vector,this.m_normals=new Vector},r.prototype.Reserve=function(t){void 0===t&&(t=0);for(var e=parseInt(this.m_vertices.length);e<t;e++)this.m_vertices[e]=new h,this.m_normals[e]=new h},r.ComputeCentroid=function(t,e){void 0===e&&(e=0);for(var i=new h,n=0,o=0,r=0,s=1/3,a=0;a<e;++a){var l=t[a],u=a+1<e?t[parseInt(a+1)]:t[0],c=l.x-o,p=l.y-r,d=u.x-o,f=u.y-r,m=c*f-p*d,_=.5*m;n+=_,i.x+=_*s*(o+l.x+u.x),i.y+=_*s*(r+l.y+u.y)}return i.x*=1/n,i.y*=1/n,i},r.ComputeOBB=function(t,e,i){void 0===i&&(i=0);var n=0,o=new Vector(i+1);for(n=0;n<i;++n)o[n]=e[n];o[i]=o[0];var r=Number.MAX_VALUE;for(n=1;n<=i;++n){var s=o[parseInt(n-1)],a=o[n].x-s.x,l=o[n].y-s.y,u=Math.sqrt(a*a+l*l);a/=u,l/=u;for(var h=-l,c=a,p=Number.MAX_VALUE,d=Number.MAX_VALUE,f=-Number.MAX_VALUE,m=-Number.MAX_VALUE,_=0;_<i;++_){var y=o[_].x-s.x,x=o[_].y-s.y,v=a*y+l*x,g=h*y+c*x;v<p&&(p=v),g<d&&(d=g),v>f&&(f=v),g>m&&(m=g)}var b=(f-p)*(m-d);if(b<.95*r){r=b,t.R.col1.x=a,t.R.col1.y=l,t.R.col2.x=h,t.R.col2.y=c;var w=.5*(p+f),S=.5*(d+m),C=t.R;t.center.x=s.x+(C.col1.x*w+C.col2.x*S),t.center.y=s.y+(C.col1.y*w+C.col2.y*S),t.extents.x=.5*(f-p),t.extents.y=.5*(m-d)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new a}),s.b2Shape=function(){},s.prototype.Copy=function(){return null},s.prototype.Set=function(t){this.m_radius=t.m_radius},s.prototype.GetType=function(){return this.m_type},s.prototype.TestPoint=function(t,e){return!1},s.prototype.RayCast=function(t,e,i){return!1},s.prototype.ComputeAABB=function(t,e){},s.prototype.ComputeMass=function(t,e){void 0===e&&(e=0)},s.prototype.ComputeSubmergedArea=function(t,e,i,n){return void 0===e&&(e=0),0},s.TestOverlap=function(t,e,i,n){var o=new p;o.proxyA=new f,o.proxyA.Set(t),o.proxyB=new f,o.proxyB.Set(i),o.transformA=e,o.transformB=n,o.useRadii=!0;var r=new m;r.count=0;var s=new d;return c.Distance(s,r,o),s.distance<10*Number.MIN_VALUE},s.prototype.b2Shape=function(){this.m_type=s.e_unknownShape,this.m_radius=t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var t=Box2D.Common.b2Color,e=(Box2D.Common.b2internal,Box2D.Common.b2Settings),i=(Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math);Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2,Box2D.Common.Math.b2Vec3;t.b2Color=function(){this._r=0,this._g=0,this._b=0},t.prototype.b2Color=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},t.prototype.Set=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1)),this._g=Box2D.parseUInt(255*i.Clamp(e,0,1)),this._b=Box2D.parseUInt(255*i.Clamp(n,0,1))},Object.defineProperty(t.prototype,"r",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._r=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"g",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._g=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"b",{enumerable:!1,configurable:!0,set:function(t){void 0===t&&(t=0),this._b=Box2D.parseUInt(255*i.Clamp(t,0,1))}}),Object.defineProperty(t.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}}),e.b2Settings=function(){},e.b2MixFriction=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),Math.sqrt(t*e)},e.b2MixRestitution=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},e.b2Assert=function(t){if(!t)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=.005,Box2D.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=.5*e.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=.2,Box2D.Common.b2Settings.b2_timeToSleep=.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})}(),function(){var t=(Box2D.Collision.b2AABB,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Common.Math.b2Mat22),e=Box2D.Common.Math.b2Mat33,i=Box2D.Common.Math.b2Math,n=Box2D.Common.Math.b2Sweep,o=Box2D.Common.Math.b2Transform,r=Box2D.Common.Math.b2Vec2,s=Box2D.Common.Math.b2Vec3;
t.b2Mat22=function(){this.col1=new r,this.col2=new r},t.prototype.b2Mat22=function(){this.SetIdentity()},t.FromAngle=function(e){void 0===e&&(e=0);var i=new t;return i.Set(e),i},t.FromVV=function(e,i){var n=new t;return n.SetVV(e,i),n},t.prototype.Set=function(t){void 0===t&&(t=0);var e=Math.cos(t),i=Math.sin(t);this.col1.x=e,this.col2.x=-i,this.col1.y=i,this.col2.y=e},t.prototype.SetVV=function(t,e){this.col1.SetV(t),this.col2.SetV(e)},t.prototype.Copy=function(){var e=new t;return e.SetM(this),e},t.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2)},t.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y},t.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},t.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},t.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},t.prototype.GetInverse=function(t){var e=this.col1.x,i=this.col2.x,n=this.col1.y,o=this.col2.y,r=e*o-i*n;return 0!=r&&(r=1/r),t.col1.x=r*o,t.col2.x=-r*i,t.col1.y=-r*n,t.col2.y=r*e,t},t.prototype.Solve=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},t.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},e.b2Mat33=function(){this.col1=new s,this.col2=new s,this.col3=new s},e.prototype.b2Mat33=function(t,e,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=null),t||e||i?(this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},e.prototype.SetVVV=function(t,e,i){this.col1.SetV(t),this.col2.SetV(e),this.col3.SetV(i)},e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)},e.prototype.SetM=function(t){this.col1.SetV(t.col1),this.col2.SetV(t.col2),this.col3.SetV(t.col3)},e.prototype.AddM=function(t){this.col1.x+=t.col1.x,this.col1.y+=t.col1.y,this.col1.z+=t.col1.z,this.col2.x+=t.col2.x,this.col2.y+=t.col2.y,this.col2.z+=t.col2.z,this.col3.x+=t.col3.x,this.col3.y+=t.col3.y,this.col3.z+=t.col3.z},e.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},e.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},e.prototype.Solve22=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.col1.x,o=this.col2.x,r=this.col1.y,s=this.col2.y,a=n*s-o*r;return 0!=a&&(a=1/a),t.x=a*(s*e-o*i),t.y=a*(n*i-r*e),t},e.prototype.Solve33=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=this.col1.x,r=this.col1.y,s=this.col1.z,a=this.col2.x,l=this.col2.y,u=this.col2.z,h=this.col3.x,c=this.col3.y,p=this.col3.z,d=o*(l*p-u*c)+r*(u*h-a*p)+s*(a*c-l*h);return 0!=d&&(d=1/d),t.x=d*(e*(l*p-u*c)+i*(u*h-a*p)+n*(a*c-l*h)),t.y=d*(o*(i*p-n*c)+r*(n*h-e*p)+s*(e*c-i*h)),t.z=d*(o*(l*n-u*i)+r*(u*e-a*n)+s*(a*i-l*e)),t},i.b2Math=function(){},i.IsValid=function(t){return void 0===t&&(t=0),isFinite(t)},i.Dot=function(t,e){return t.x*e.x+t.y*e.y},i.CrossVV=function(t,e){return t.x*e.y-t.y*e.x},i.CrossVF=function(t,e){void 0===e&&(e=0);var i=new r(e*t.y,-e*t.x);return i},i.CrossFV=function(t,e){void 0===t&&(t=0);var i=new r(-t*e.y,t*e.x);return i},i.MulMV=function(t,e){var i=new r(t.col1.x*e.x+t.col2.x*e.y,t.col1.y*e.x+t.col2.y*e.y);return i},i.MulTMV=function(t,e){var n=new r(i.Dot(e,t.col1),i.Dot(e,t.col2));return n},i.MulX=function(t,e){var n=i.MulMV(t.R,e);return n.x+=t.position.x,n.y+=t.position.y,n},i.MulXT=function(t,e){var n=i.SubtractVV(e,t.position),o=n.x*t.R.col1.x+n.y*t.R.col1.y;return n.y=n.x*t.R.col2.x+n.y*t.R.col2.y,n.x=o,n},i.AddVV=function(t,e){var i=new r(t.x+e.x,t.y+e.y);return i},i.SubtractVV=function(t,e){var i=new r(t.x-e.x,t.y-e.y);return i},i.Distance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},i.DistanceSquared=function(t,e){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},i.MulFV=function(t,e){void 0===t&&(t=0);var i=new r(t*e.x,t*e.y);return i},i.AddMM=function(e,n){var o=t.FromVV(i.AddVV(e.col1,n.col1),i.AddVV(e.col2,n.col2));return o},i.MulMM=function(e,n){var o=t.FromVV(i.MulMV(e,n.col1),i.MulMV(e,n.col2));return o},i.MulTMM=function(e,n){var o=new r(i.Dot(e.col1,n.col1),i.Dot(e.col2,n.col1)),s=new r(i.Dot(e.col1,n.col2),i.Dot(e.col2,n.col2)),a=t.FromVV(o,s);return a},i.Abs=function(t){return void 0===t&&(t=0),t>0?t:-t},i.AbsV=function(t){var e=new r(i.Abs(t.x),i.Abs(t.y));return e},i.AbsM=function(e){var n=t.FromVV(i.AbsV(e.col1),i.AbsV(e.col2));return n},i.Min=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t<e?t:e},i.MinV=function(t,e){var n=new r(i.Min(t.x,e.x),i.Min(t.y,e.y));return n},i.Max=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),t>e?t:e},i.MaxV=function(t,e){var n=new r(i.Max(t.x,e.x),i.Max(t.y,e.y));return n},i.Clamp=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),t<e?e:t>i?i:t},i.ClampV=function(t,e,n){return i.MaxV(e,i.MinV(t,n))},i.Swap=function(t,e){var i=t[0];t[0]=e[0],e[0]=i},i.Random=function(){return 2*Math.random()-1},i.RandomRange=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.random();return i=(e-t)*i+t},i.NextPowerOfTwo=function(t){return void 0===t&&(t=0),t|=t>>1&2147483647,t|=t>>2&1073741823,t|=t>>4&268435455,t|=t>>8&16777215,t|=t>>16&65535,t+1},i.IsPowerOfTwo=function(t){void 0===t&&(t=0);var e=t>0&&0==(t&t-1);return e},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new r(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=t.FromVV(new r(1,0),new r(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new o(i.b2Vec2_zero,i.b2Mat22_identity)}),n.b2Sweep=function(){this.localCenter=new r,this.c0=new r,this.c=new r},n.prototype.Set=function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0},n.prototype.Copy=function(){var t=new n;return t.localCenter.SetV(this.localCenter),t.c0.SetV(this.c0),t.c.SetV(this.c),t.a0=this.a0,t.a=this.a,t.t0=this.t0,t},n.prototype.GetTransform=function(t,e){void 0===e&&(e=0),t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var n=t.R;t.position.x-=n.col1.x*this.localCenter.x+n.col2.x*this.localCenter.y,t.position.y-=n.col1.y*this.localCenter.x+n.col2.y*this.localCenter.y},n.prototype.Advance=function(t){if(void 0===t&&(t=0),this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}},o.b2Transform=function(){this.position=new r,this.R=new t},o.prototype.b2Transform=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),t&&(this.position.SetV(t),this.R.SetM(e))},o.prototype.Initialize=function(t,e){this.position.SetV(t),this.R.SetM(e)},o.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},o.prototype.Set=function(t){this.position.SetV(t.position),this.R.SetM(t.R)},o.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},r.b2Vec2=function(){},r.prototype.b2Vec2=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},r.prototype.SetZero=function(){this.x=0,this.y=0},r.prototype.Set=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e},r.prototype.SetV=function(t){this.x=t.x,this.y=t.y},r.prototype.GetNegative=function(){return new r(-this.x,-this.y)},r.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},r.Make=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),new r(t,e)},r.prototype.Copy=function(){return new r(this.x,this.y)},r.prototype.Add=function(t){this.x+=t.x,this.y+=t.y},r.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y},r.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t},r.prototype.MulM=function(t){var e=this.x;this.x=t.col1.x*e+t.col2.x*this.y,this.y=t.col1.y*e+t.col2.y*this.y},r.prototype.MulTM=function(t){var e=i.Dot(this,t.col1);this.y=i.Dot(this,t.col2),this.x=e},r.prototype.CrossVF=function(t){void 0===t&&(t=0);var e=this.x;this.x=t*this.y,this.y=-t*e},r.prototype.CrossFV=function(t){void 0===t&&(t=0);var e=this.x;this.x=-t*this.y,this.y=t*e},r.prototype.MinV=function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y},r.prototype.MaxV=function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y},r.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},r.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},r.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},r.prototype.Normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(t<Number.MIN_VALUE)return 0;var e=1/t;return this.x*=e,this.y*=e,t},r.prototype.IsValid=function(){return i.IsValid(this.x)&&i.IsValid(this.y)},s.b2Vec3=function(){},s.prototype.b2Vec3=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetZero=function(){this.x=this.y=this.z=0},s.prototype.Set=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i},s.prototype.SetV=function(t){this.x=t.x,this.y=t.y,this.z=t.z},s.prototype.GetNegative=function(){return new s(-this.x,-this.y,-this.z)},s.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},s.prototype.Copy=function(){return new s(this.x,this.y,this.z)},s.prototype.Add=function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},s.prototype.Subtract=function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},s.prototype.Multiply=function(t){void 0===t&&(t=0),this.x*=t,this.y*=t,this.z*=t}}(),function(){var t=(Box2D.Dynamics.Controllers.b2ControllerEdge,Box2D.Common.Math.b2Mat22,Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),e=Box2D.Common.Math.b2Sweep,i=Box2D.Common.Math.b2Transform,n=Box2D.Common.Math.b2Vec2,o=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),r=(Box2D.Common.b2internal,Box2D.Common.b2Settings),s=Box2D.Collision.b2AABB,a=(Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision,Box2D.Collision.b2ContactID,Box2D.Collision.b2ContactPoint),l=(Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase),u=(Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold,Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput),h=Box2D.Collision.b2RayCastOutput,c=(Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact,Box2D.Collision.b2TOIInput,Box2D.Collision.b2WorldManifold,Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase,Box2D.Collision.Shapes.b2CircleShape),p=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),d=Box2D.Collision.Shapes.b2MassData,f=Box2D.Collision.Shapes.b2PolygonShape,m=Box2D.Collision.Shapes.b2Shape,_=Box2D.Dynamics.b2Body,y=Box2D.Dynamics.b2BodyDef,x=Box2D.Dynamics.b2ContactFilter,v=Box2D.Dynamics.b2ContactImpulse,g=Box2D.Dynamics.b2ContactListener,b=Box2D.Dynamics.b2ContactManager,w=Box2D.Dynamics.b2DebugDraw,S=Box2D.Dynamics.b2DestructionListener,C=Box2D.Dynamics.b2FilterData,D=Box2D.Dynamics.b2Fixture,T=Box2D.Dynamics.b2FixtureDef,A=Box2D.Dynamics.b2Island,B=Box2D.Dynamics.b2TimeStep,M=Box2D.Dynamics.b2World,E=(Box2D.Dynamics.Contacts.b2CircleContact,Box2D.Dynamics.Contacts.b2Contact),P=(Box2D.Dynamics.Contacts.b2ContactConstraint,Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Box2D.Dynamics.Contacts.b2ContactEdge,Box2D.Dynamics.Contacts.b2ContactFactory),I=(Box2D.Dynamics.Contacts.b2ContactRegister,Box2D.Dynamics.Contacts.b2ContactResult,Box2D.Dynamics.Contacts.b2ContactSolver),O=(Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Box2D.Dynamics.Contacts.b2NullContact,Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,Box2D.Dynamics.Contacts.b2PolygonContact,Box2D.Dynamics.Contacts.b2PositionSolverManifold,Box2D.Dynamics.Controllers.b2Controller,Box2D.Dynamics.Joints.b2DistanceJoint,Box2D.Dynamics.Joints.b2DistanceJointDef,Box2D.Dynamics.Joints.b2FrictionJoint,Box2D.Dynamics.Joints.b2FrictionJointDef,Box2D.Dynamics.Joints.b2GearJoint,Box2D.Dynamics.Joints.b2GearJointDef,Box2D.Dynamics.Joints.b2Jacobian,Box2D.Dynamics.Joints.b2Joint),R=(Box2D.Dynamics.Joints.b2JointDef,Box2D.Dynamics.Joints.b2JointEdge,Box2D.Dynamics.Joints.b2LineJoint,Box2D.Dynamics.Joints.b2LineJointDef,Box2D.Dynamics.Joints.b2MouseJoint,Box2D.Dynamics.Joints.b2MouseJointDef,Box2D.Dynamics.Joints.b2PrismaticJoint,Box2D.Dynamics.Joints.b2PrismaticJointDef,Box2D.Dynamics.Joints.b2PulleyJoint);Box2D.Dynamics.Joints.b2PulleyJointDef,Box2D.Dynamics.Joints.b2RevoluteJoint,Box2D.Dynamics.Joints.b2RevoluteJointDef,Box2D.Dynamics.Joints.b2WeldJoint,Box2D.Dynamics.Joints.b2WeldJointDef;_.b2Body=function(){this.m_xf=new i,this.m_sweep=new e,this.m_linearVelocity=new n,this.m_force=new n},_.prototype.connectEdges=function(e,i,n){void 0===n&&(n=0);var o=Math.atan2(i.GetDirectionVector().y,i.GetDirectionVector().x),s=Math.tan(.5*(o-n)),a=t.MulFV(s,i.GetDirectionVector());a=t.SubtractVV(a,i.GetNormalVector()),a=t.MulFV(r.b2_toiSlop,a),a=t.AddVV(a,i.GetVertex1());var l=t.AddVV(e.GetDirectionVector(),i.GetDirectionVector());l.Normalize();var u=t.Dot(e.GetDirectionVector(),i.GetNormalVector())>0;return e.SetNextEdge(i,a,l,u),i.SetPrevEdge(e,a,l,u),o},_.prototype.CreateFixture=function(t){if(1==this.m_world.IsLocked())return null;var e=new D;if(e.Create(this,this.m_xf,t),this.m_flags&_.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;e.CreateProxy(i,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_body=this,e.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=M.e_newFixture,e},_.prototype.CreateFixture2=function(t,e){void 0===e&&(e=0);var i=new T;return i.shape=t,i.density=e,this.CreateFixture(i)},_.prototype.DestroyFixture=function(t){if(1!=this.m_world.IsLocked()){for(var e=this.m_fixtureList,i=null,n=!1;null!=e;){if(e==t){i?i.m_next=t.m_next:this.m_fixtureList=t.m_next,n=!0;break}i=e,e=e.m_next}for(var o=this.m_contactList;o;){var r=o.contact;o=o.next;var s=r.GetFixtureA(),a=r.GetFixtureB();t!=s&&t!=a||this.m_world.m_contactManager.Destroy(r)}if(this.m_flags&_.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxy(l)}t.Destroy(),t.m_body=null,t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},_.prototype.SetPositionAndAngle=function(t,e){void 0===e&&(e=0);var i;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var n=this.m_xf.R,o=this.m_sweep.localCenter;this.m_sweep.c.x=n.col1.x*o.x+n.col2.x*o.y,this.m_sweep.c.y=n.col1.y*o.x+n.col2.y*o.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;var r=this.m_world.m_contactManager.m_broadPhase;for(i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(r,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},_.prototype.SetTransform=function(t){this.SetPositionAndAngle(t.position,t.GetAngle())},_.prototype.GetTransform=function(){return this.m_xf},_.prototype.GetPosition=function(){return this.m_xf.position},_.prototype.SetPosition=function(t){this.SetPositionAndAngle(t,this.GetAngle())},_.prototype.GetAngle=function(){return this.m_sweep.a},_.prototype.SetAngle=function(t){void 0===t&&(t=0),this.SetPositionAndAngle(this.GetPosition(),t)},_.prototype.GetWorldCenter=function(){return this.m_sweep.c},_.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},_.prototype.SetLinearVelocity=function(t){this.m_type!=_.b2_staticBody&&this.m_linearVelocity.SetV(t)},_.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},_.prototype.SetAngularVelocity=function(t){void 0===t&&(t=0),this.m_type!=_.b2_staticBody&&(this.m_angularVelocity=t)},_.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},_.prototype.GetDefinition=function(){var t=new y;return t.type=this.GetType(),t.allowSleep=(this.m_flags&_.e_allowSleepFlag)==_.e_allowSleepFlag,t.angle=this.GetAngle(),t.angularDamping=this.m_angularDamping,t.angularVelocity=this.m_angularVelocity,t.fixedRotation=(this.m_flags&_.e_fixedRotationFlag)==_.e_fixedRotationFlag,t.bullet=(this.m_flags&_.e_bulletFlag)==_.e_bulletFlag,t.awake=(this.m_flags&_.e_awakeFlag)==_.e_awakeFlag,t.linearDamping=this.m_linearDamping,t.linearVelocity.SetV(this.GetLinearVelocity()),t.position=this.GetPosition(),t.userData=this.GetUserData(),t},_.prototype.ApplyForce=function(t,e){this.m_type==_.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)},_.prototype.ApplyTorque=function(t){void 0===t&&(t=0),this.m_type==_.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=t)},_.prototype.ApplyImpulse=function(t,e){this.m_type==_.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))},_.prototype.Split=function(e){for(var i,n=this.GetLinearVelocity().Copy(),o=this.GetAngularVelocity(),r=this.GetWorldCenter(),s=this,a=this.m_world.CreateBody(this.GetDefinition()),l=s.m_fixtureList;l;)if(e(l)){var u=l.m_next;i?i.m_next=u:s.m_fixtureList=u,s.m_fixtureCount--,l.m_next=a.m_fixtureList,a.m_fixtureList=l,a.m_fixtureCount++,l.m_body=a,l=u}else i=l,l=l.m_next;s.ResetMassData(),a.ResetMassData();var h=s.GetWorldCenter(),c=a.GetWorldCenter(),p=t.AddVV(n,t.CrossFV(o,t.SubtractVV(h,r))),d=t.AddVV(n,t.CrossFV(o,t.SubtractVV(c,r)));return s.SetLinearVelocity(p),a.SetLinearVelocity(d),s.SetAngularVelocity(o),a.SetAngularVelocity(o),s.SynchronizeFixtures(),a.SynchronizeFixtures(),a},_.prototype.Merge=function(t){var e;for(e=t.m_fixtureList;e;){var i=e.m_next;t.m_fixtureCount--,e.m_next=this.m_fixtureList,this.m_fixtureList=e,this.m_fixtureCount++,e.m_body=o,e=i}n.m_fixtureCount=0;var n=this,o=t;n.GetWorldCenter(),o.GetWorldCenter(),n.GetLinearVelocity().Copy(),o.GetLinearVelocity().Copy(),n.GetAngularVelocity(),o.GetAngularVelocity();n.ResetMassData(),this.SynchronizeFixtures()},_.prototype.GetMass=function(){return this.m_mass},_.prototype.GetInertia=function(){return this.m_I},_.prototype.GetMassData=function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)},_.prototype.SetMassData=function(e){if(r.b2Assert(0==this.m_world.IsLocked()),1!=this.m_world.IsLocked()&&this.m_type==_.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&_.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}},_.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=_.b2_staticBody&&this.m_type!=_.b2_kinematicBody){for(var e=n.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!=i.m_density){var o=i.GetMassData();this.m_mass+=o.mass,e.x+=o.center.x*o.mass,e.y+=o.center.y*o.mass,this.m_I+=o.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&_.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,r.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(t.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-s.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-s.x)}},_.prototype.GetWorldPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i},_.prototype.GetWorldVector=function(e){return t.MulMV(this.m_xf.R,e)},_.prototype.GetLocalPoint=function(e){return t.MulXT(this.m_xf,e)},_.prototype.GetLocalVector=function(e){return t.MulTMV(this.m_xf.R,e)},_.prototype.GetLinearVelocityFromWorldPoint=function(t){return new n(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))},_.prototype.GetLinearVelocityFromLocalPoint=function(t){var e=this.m_xf.R,i=new n(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new n(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))},_.prototype.GetLinearDamping=function(){return this.m_linearDamping},_.prototype.SetLinearDamping=function(t){void 0===t&&(t=0),this.m_linearDamping=t},_.prototype.GetAngularDamping=function(){return this.m_angularDamping},_.prototype.SetAngularDamping=function(t){void 0===t&&(t=0),this.m_angularDamping=t},_.prototype.SetType=function(t){if(void 0===t&&(t=0),this.m_type!=t){this.m_type=t,this.ResetMassData(),this.m_type==_.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var e=this.m_contactList;e;e=e.next)e.contact.FlagForFiltering()}},_.prototype.GetType=function(){return this.m_type},_.prototype.SetBullet=function(t){t?this.m_flags|=_.e_bulletFlag:this.m_flags&=~_.e_bulletFlag},_.prototype.IsBullet=function(){return(this.m_flags&_.e_bulletFlag)==_.e_bulletFlag},_.prototype.SetSleepingAllowed=function(t){t?this.m_flags|=_.e_allowSleepFlag:(this.m_flags&=~_.e_allowSleepFlag,this.SetAwake(!0))},_.prototype.SetAwake=function(t){t?(this.m_flags|=_.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~_.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},_.prototype.IsAwake=function(){return(this.m_flags&_.e_awakeFlag)==_.e_awakeFlag},_.prototype.SetFixedRotation=function(t){t?this.m_flags|=_.e_fixedRotationFlag:this.m_flags&=~_.e_fixedRotationFlag,this.ResetMassData()},_.prototype.IsFixedRotation=function(){return(this.m_flags&_.e_fixedRotationFlag)==_.e_fixedRotationFlag},_.prototype.SetActive=function(t){if(t!=this.IsActive()){var e,i;if(t)for(this.m_flags|=_.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxy(e,this.m_xf);else{for(this.m_flags&=~_.e_activeFlag,e=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxy(e);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}},_.prototype.IsActive=function(){return(this.m_flags&_.e_activeFlag)==_.e_activeFlag},_.prototype.IsSleepingAllowed=function(){return(this.m_flags&_.e_allowSleepFlag)==_.e_allowSleepFlag},_.prototype.GetFixtureList=function(){return this.m_fixtureList},_.prototype.GetJointList=function(){return this.m_jointList},_.prototype.GetControllerList=function(){return this.m_controllerList},_.prototype.GetContactList=function(){return this.m_contactList},_.prototype.GetNext=function(){return this.m_next},_.prototype.GetUserData=function(){return this.m_userData},_.prototype.SetUserData=function(t){this.m_userData=t},_.prototype.GetWorld=function(){return this.m_world},_.prototype.b2Body=function(t,e){this.m_flags=0,t.bullet&&(this.m_flags|=_.e_bulletFlag),t.fixedRotation&&(this.m_flags|=_.e_fixedRotationFlag),t.allowSleep&&(this.m_flags|=_.e_allowSleepFlag),t.awake&&(this.m_flags|=_.e_awakeFlag),t.active&&(this.m_flags|=_.e_activeFlag),this.m_world=e,this.m_xf.position.SetV(t.position),this.m_xf.R.Set(t.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=t.angle;var i=this.m_xf.R,n=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*n.x+i.col2.x*n.y,this.m_sweep.c.y=i.col1.y*n.x+i.col2.y*n.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(t.linearVelocity),this.m_angularVelocity=t.angularVelocity,this.m_linearDamping=t.linearDamping,this.m_angularDamping=t.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=t.type,this.m_type==_.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=t.inertiaScale,this.m_userData=t.userData,this.m_fixtureList=null,this.m_fixtureCount=0},_.prototype.SynchronizeFixtures=function(){var t=_.s_xf1;t.R.Set(this.m_sweep.a0);var e=t.R,i=this.m_sweep.localCenter;t.position.x=this.m_sweep.c0.x-(e.col1.x*i.x+e.col2.x*i.y),t.position.y=this.m_sweep.c0.y-(e.col1.y*i.x+e.col2.y*i.y);var n,o=this.m_world.m_contactManager.m_broadPhase;for(n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(o,t,this.m_xf)},_.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)},_.prototype.ShouldCollide=function(t){if(this.m_type!=_.b2_dynamicBody&&t.m_type!=_.b2_dynamicBody)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},_.prototype.Advance=function(t){void 0===t&&(t=0),this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new i,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),y.b2BodyDef=function(){this.position=new n,this.linearVelocity=new n},y.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=_.b2_staticBody,this.active=!0,this.inertiaScale=1},x.b2ContactFilter=function(){},x.prototype.ShouldCollide=function(t,e){var i=t.GetFilterData(),n=e.GetFilterData();if(i.groupIndex==n.groupIndex&&0!=i.groupIndex)return i.groupIndex>0;var o=0!=(i.maskBits&n.categoryBits)&&0!=(i.categoryBits&n.maskBits);return o},x.prototype.RayCollide=function(t,e){return!t||this.ShouldCollide(t instanceof D?t:null,e)},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new x}),v.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(r.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(r.b2_maxManifoldPoints)},g.b2ContactListener=function(){},g.prototype.BeginContact=function(t){},g.prototype.EndContact=function(t){},g.prototype.PreSolve=function(t,e){},g.prototype.PostSolve=function(t,e){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new g}),b.b2ContactManager=function(){},b.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=x.b2_defaultFilter,this.m_contactListener=g.b2_defaultListener,this.m_contactFactory=new P(this.m_allocator),this.m_broadPhase=new l},b.prototype.AddPair=function(t,e){var i=t instanceof D?t:null,n=e instanceof D?e:null,o=i.GetBody(),r=n.GetBody();if(o!=r){for(var s=r.GetContactList();s;){if(s.other==o){var a=s.contact.GetFixtureA(),l=s.contact.GetFixtureB();if(a==i&&l==n)return;if(a==n&&l==i)return}s=s.next}if(0!=r.ShouldCollide(o)&&0!=this.m_contactFilter.ShouldCollide(i,n)){var u=this.m_contactFactory.Create(i,n);i=u.GetFixtureA(),n=u.GetFixtureB(),o=i.m_body,r=n.m_body,u.m_prev=null,u.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=u),this.m_world.m_contactList=u,u.m_nodeA.contact=u,u.m_nodeA.other=r,u.m_nodeA.prev=null,u.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=u.m_nodeA),o.m_contactList=u.m_nodeA,u.m_nodeB.contact=u,u.m_nodeB.other=o,u.m_nodeB.prev=null,u.m_nodeB.next=r.m_contactList,null!=r.m_contactList&&(r.m_contactList.prev=u.m_nodeB),r.m_contactList=u.m_nodeB,++this.m_world.m_contactCount}}},b.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},b.prototype.Destroy=function(t){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount},b.prototype.Collide=function(){for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),i=t.GetFixtureB(),n=e.GetBody(),o=i.GetBody();if(0!=n.IsAwake()||0!=o.IsAwake()){if(t.m_flags&E.e_filterFlag){if(0==o.ShouldCollide(n)){var r=t;t=r.GetNext(),this.Destroy(r);continue}if(0==this.m_contactFilter.ShouldCollide(e,i)){r=t,t=r.GetNext(),this.Destroy(r);continue}t.m_flags&=~E.e_filterFlag}var s=e.m_proxy,a=i.m_proxy,l=this.m_broadPhase.TestOverlap(s,a);0!=l?(t.Update(this.m_contactListener),t=t.GetNext()):(r=t,t=r.GetNext(),this.Destroy(r))}else t=t.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new a}),w.b2DebugDraw=function(){},w.prototype.b2DebugDraw=function(){},w.prototype.SetFlags=function(t){void 0===t&&(t=0)},w.prototype.GetFlags=function(){},w.prototype.AppendFlags=function(t){void 0===t&&(t=0)},w.prototype.ClearFlags=function(t){void 0===t&&(t=0)},w.prototype.SetSprite=function(t){},w.prototype.GetSprite=function(){},w.prototype.SetDrawScale=function(t){void 0===t&&(t=0)},w.prototype.GetDrawScale=function(){},w.prototype.SetLineThickness=function(t){void 0===t&&(t=0)},w.prototype.GetLineThickness=function(){},w.prototype.SetAlpha=function(t){void 0===t&&(t=0)},w.prototype.GetAlpha=function(){},w.prototype.SetFillAlpha=function(t){void 0===t&&(t=0)},w.prototype.GetFillAlpha=function(){},w.prototype.SetXFormScale=function(t){void 0===t&&(t=0)},w.prototype.GetXFormScale=function(){},w.prototype.DrawPolygon=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawSolidPolygon=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawCircle=function(t,e,i){void 0===e&&(e=0)},w.prototype.DrawSolidCircle=function(t,e,i,n){void 0===e&&(e=0)},w.prototype.DrawSegment=function(t,e,i){},
w.prototype.DrawTransform=function(t){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),S.b2DestructionListener=function(){},S.prototype.SayGoodbyeJoint=function(t){},S.prototype.SayGoodbyeFixture=function(t){},C.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},C.prototype.Copy=function(){var t=new C;return t.categoryBits=this.categoryBits,t.maskBits=this.maskBits,t.groupIndex=this.groupIndex,t},D.b2Fixture=function(){this.m_filter=new C},D.prototype.GetType=function(){return this.m_shape.GetType()},D.prototype.GetShape=function(){return this.m_shape},D.prototype.SetSensor=function(t){if(this.m_isSensor!=t&&(this.m_isSensor=t,null!=this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.SetSensor(n.IsSensor()||o.IsSensor()),e=e.next}},D.prototype.IsSensor=function(){return this.m_isSensor},D.prototype.SetFilterData=function(t){if(this.m_filter=t.Copy(),!this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,n=i.GetFixtureA(),o=i.GetFixtureB();n!=this&&o!=this||i.FlagForFiltering(),e=e.next}},D.prototype.GetFilterData=function(){return this.m_filter.Copy()},D.prototype.GetBody=function(){return this.m_body},D.prototype.GetNext=function(){return this.m_next},D.prototype.GetUserData=function(){return this.m_userData},D.prototype.SetUserData=function(t){this.m_userData=t},D.prototype.TestPoint=function(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)},D.prototype.RayCast=function(t,e){return this.m_shape.RayCast(t,e,this.m_body.GetTransform())},D.prototype.GetMassData=function(t){return void 0===t&&(t=null),null==t&&(t=new d),this.m_shape.ComputeMass(t,this.m_density),t},D.prototype.SetDensity=function(t){void 0===t&&(t=0),this.m_density=t},D.prototype.GetDensity=function(){return this.m_density},D.prototype.GetFriction=function(){return this.m_friction},D.prototype.SetFriction=function(t){void 0===t&&(t=0),this.m_friction=t},D.prototype.GetRestitution=function(){return this.m_restitution},D.prototype.SetRestitution=function(t){void 0===t&&(t=0),this.m_restitution=t},D.prototype.GetAABB=function(){return this.m_aabb},D.prototype.b2Fixture=function(){this.m_aabb=new s,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},D.prototype.Create=function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=null,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density},D.prototype.Destroy=function(){this.m_shape=null},D.prototype.CreateProxy=function(t,e){this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)},D.prototype.DestroyProxy=function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=null)},D.prototype.Synchronize=function(e,i,n){if(this.m_proxy){var o=new s,r=new s;this.m_shape.ComputeAABB(o,i),this.m_shape.ComputeAABB(r,n),this.m_aabb.Combine(o,r);var a=t.SubtractVV(n.position,i.position);e.MoveProxy(this.m_proxy,this.m_aabb,a)}},T.b2FixtureDef=function(){this.filter=new C},T.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},A.b2Island=function(){},A.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},A.prototype.Initialize=function(t,e,i,n,o,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0);var s=0;for(this.m_bodyCapacity=t,this.m_contactCapacity=e,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=n,this.m_listener=o,this.m_contactSolver=r,s=this.m_bodies.length;s<t;s++)this.m_bodies[s]=null;for(s=this.m_contacts.length;s<e;s++)this.m_contacts[s]=null;for(s=this.m_joints.length;s<i;s++)this.m_joints[s]=null},A.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},A.prototype.Solve=function(e,i,n){var o,s,a=0,l=0;for(a=0;a<this.m_bodyCount;++a)o=this.m_bodies[a],o.GetType()==_.b2_dynamicBody&&(o.m_linearVelocity.x+=e.dt*(i.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=e.dt*(i.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=e.dt*o.m_invI*o.m_torque,o.m_linearVelocity.Multiply(t.Clamp(1-e.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=t.Clamp(1-e.dt*o.m_angularDamping,0,1));this.m_contactSolver.Initialize(e,this.m_contacts,this.m_contactCount,this.m_allocator);var u=this.m_contactSolver;for(u.InitVelocityConstraints(e),a=0;a<this.m_jointCount;++a)s=this.m_joints[a],s.InitVelocityConstraints(e);for(a=0;a<e.velocityIterations;++a){for(l=0;l<this.m_jointCount;++l)s=this.m_joints[l],s.SolveVelocityConstraints(e);u.SolveVelocityConstraints()}for(a=0;a<this.m_jointCount;++a)s=this.m_joints[a],s.FinalizeVelocityConstraints();for(u.FinalizeVelocityConstraints(),a=0;a<this.m_bodyCount;++a)if(o=this.m_bodies[a],o.GetType()!=_.b2_staticBody){var h=e.dt*o.m_linearVelocity.x,c=e.dt*o.m_linearVelocity.y;h*h+c*c>r.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=r.b2_maxTranslation*e.inv_dt,o.m_linearVelocity.y*=r.b2_maxTranslation*e.inv_dt);var p=e.dt*o.m_angularVelocity;p*p>r.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-r.b2_maxRotation*e.inv_dt:o.m_angularVelocity=r.b2_maxRotation*e.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=e.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=e.dt*o.m_linearVelocity.y,o.m_sweep.a+=e.dt*o.m_angularVelocity,o.SynchronizeTransform()}for(a=0;a<e.positionIterations;++a){var d=u.SolvePositionConstraints(r.b2_contactBaumgarte),f=!0;for(l=0;l<this.m_jointCount;++l){s=this.m_joints[l];var m=s.SolvePositionConstraints(r.b2_contactBaumgarte);f=f&&m}if(d&&f)break}if(this.Report(u.m_constraints),n){var y=Number.MAX_VALUE,x=r.b2_linearSleepTolerance*r.b2_linearSleepTolerance,v=r.b2_angularSleepTolerance*r.b2_angularSleepTolerance;for(a=0;a<this.m_bodyCount;++a)o=this.m_bodies[a],o.GetType()!=_.b2_staticBody&&(0==(o.m_flags&_.e_allowSleepFlag)&&(o.m_sleepTime=0,y=0),0==(o.m_flags&_.e_allowSleepFlag)||o.m_angularVelocity*o.m_angularVelocity>v||t.Dot(o.m_linearVelocity,o.m_linearVelocity)>x?(o.m_sleepTime=0,y=0):(o.m_sleepTime+=e.dt,y=t.Min(y,o.m_sleepTime)));if(y>=r.b2_timeToSleep)for(a=0;a<this.m_bodyCount;++a)o=this.m_bodies[a],o.SetAwake(!1)}},A.prototype.SolveTOI=function(t){var e=0,i=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var n=this.m_contactSolver;for(e=0;e<this.m_jointCount;++e)this.m_joints[e].InitVelocityConstraints(t);for(e=0;e<t.velocityIterations;++e)for(n.SolveVelocityConstraints(),i=0;i<this.m_jointCount;++i)this.m_joints[i].SolveVelocityConstraints(t);for(e=0;e<this.m_bodyCount;++e){var o=this.m_bodies[e];if(o.GetType()!=_.b2_staticBody){var s=t.dt*o.m_linearVelocity.x,a=t.dt*o.m_linearVelocity.y;s*s+a*a>r.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=r.b2_maxTranslation*t.inv_dt,o.m_linearVelocity.y*=r.b2_maxTranslation*t.inv_dt);var l=t.dt*o.m_angularVelocity;l*l>r.b2_maxRotationSquared&&(o.m_angularVelocity<0?o.m_angularVelocity=-r.b2_maxRotation*t.inv_dt:o.m_angularVelocity=r.b2_maxRotation*t.inv_dt),o.m_sweep.c0.SetV(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_sweep.c.x+=t.dt*o.m_linearVelocity.x,o.m_sweep.c.y+=t.dt*o.m_linearVelocity.y,o.m_sweep.a+=t.dt*o.m_angularVelocity,o.SynchronizeTransform()}}var u=.75;for(e=0;e<t.positionIterations;++e){var h=n.SolvePositionConstraints(u),c=!0;for(i=0;i<this.m_jointCount;++i){var p=this.m_joints[i].SolvePositionConstraints(r.b2_contactBaumgarte);c=c&&p}if(h&&c)break}this.Report(n.m_constraints)},A.prototype.Report=function(t){if(null!=this.m_listener)for(var e=0;e<this.m_contactCount;++e){for(var i=this.m_contacts[e],n=t[e],o=0;o<n.pointCount;++o)A.s_impulse.normalImpulses[o]=n.points[o].normalImpulse,A.s_impulse.tangentImpulses[o]=n.points[o].tangentImpulse;this.m_listener.PostSolve(i,A.s_impulse)}},A.prototype.AddBody=function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t},A.prototype.AddContact=function(t){this.m_contacts[this.m_contactCount++]=t},A.prototype.AddJoint=function(t){this.m_joints[this.m_jointCount++]=t},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new v}),B.b2TimeStep=function(){},B.prototype.Set=function(t){this.dt=t.dt,this.inv_dt=t.inv_dt,this.positionIterations=t.positionIterations,this.velocityIterations=t.velocityIterations,this.warmStarting=t.warmStarting},M.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new b,this.m_contactSolver=new I,this.m_island=new A},M.prototype.b2World=function(t,e){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,M.m_warmStarting=!0,M.m_continuousPhysics=!0,this.m_allowSleep=e,this.m_gravity=t,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var i=new y;this.m_groundBody=this.CreateBody(i)},M.prototype.SetDestructionListener=function(t){this.m_destructionListener=t},M.prototype.SetContactFilter=function(t){this.m_contactManager.m_contactFilter=t},M.prototype.SetContactListener=function(t){this.m_contactManager.m_contactListener=t},M.prototype.SetDebugDraw=function(t){this.m_debugDraw=t},M.prototype.SetBroadPhase=function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var i=this.m_bodyList;i;i=i.m_next)for(var n=i.m_fixtureList;n;n=n.m_next)n.m_proxy=t.CreateProxy(e.GetFatAABB(n.m_proxy),n)},M.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},M.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},M.prototype.CreateBody=function(t){if(1==this.IsLocked())return null;var e=new _(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e},M.prototype.DestroyBody=function(t){if(1!=this.IsLocked()){for(var e=t.m_jointList;e;){var i=e;e=e.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint)}for(var n=t.m_controllerList;n;){var o=n;n=n.nextController,o.controller.RemoveBody(t)}for(var r=t.m_contactList;r;){var s=r;r=r.next,this.m_contactManager.Destroy(s.contact)}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var l=a;a=a.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxy(this.m_contactManager.m_broadPhase),l.Destroy()}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}},M.prototype.CreateJoint=function(t){var e=O.Create(t,null);e.m_prev=null,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=null,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=null,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var i=t.bodyA,n=t.bodyB;if(0==t.collideConnected)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next;return e},M.prototype.DestroyJoint=function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var i=t.m_bodyA,n=t.m_bodyB;if(i.SetAwake(!0),n.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==i.m_jointList&&(i.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==n.m_jointList&&(n.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,O.Destroy(t,null),--this.m_jointCount,0==e)for(var o=n.GetContactList();o;)o.other==i&&o.contact.FlagForFiltering(),o=o.next},M.prototype.AddController=function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t},M.prototype.RemoveController=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList==t&&(this.m_controllerList=t.m_next),this.m_controllerCount--},M.prototype.CreateController=function(t){if(t.m_world!=this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t},M.prototype.DestroyController=function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t==this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount},M.prototype.SetWarmStarting=function(t){M.m_warmStarting=t},M.prototype.SetContinuousPhysics=function(t){M.m_continuousPhysics=t},M.prototype.GetBodyCount=function(){return this.m_bodyCount},M.prototype.GetJointCount=function(){return this.m_jointCount},M.prototype.GetContactCount=function(){return this.m_contactCount},M.prototype.SetGravity=function(t){this.m_gravity=t},M.prototype.GetGravity=function(){return this.m_gravity},M.prototype.GetGroundBody=function(){return this.m_groundBody},M.prototype.Step=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.m_flags&M.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~M.e_newFixture),this.m_flags|=M.e_locked;var n=M.s_timestep2;n.dt=t,n.velocityIterations=e,n.positionIterations=i,t>0?n.inv_dt=1/t:n.inv_dt=0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=M.m_warmStarting,this.m_contactManager.Collide(),n.dt>0&&this.Solve(n),M.m_continuousPhysics&&n.dt>0&&this.SolveTOI(n),n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_flags&=~M.e_locked},M.prototype.ClearForces=function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0},M.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var t,e,i,r,a,l,u=this.m_debugDraw.GetFlags(),h=(new n,new n,new n,new s,new s,[new n,new n,new n,new n]),c=new o(0,0,0);if(u&w.e_shapeBit)for(t=this.m_bodyList;t;t=t.m_next)for(l=t.m_xf,e=t.GetFixtureList();e;e=e.m_next)i=e.GetShape(),0==t.IsActive()?(c.Set(.5,.5,.3),this.DrawShape(i,l,c)):t.GetType()==_.b2_staticBody?(c.Set(.5,.9,.5),this.DrawShape(i,l,c)):t.GetType()==_.b2_kinematicBody?(c.Set(.5,.5,.9),this.DrawShape(i,l,c)):0==t.IsAwake()?(c.Set(.6,.6,.6),this.DrawShape(i,l,c)):(c.Set(.9,.7,.7),this.DrawShape(i,l,c));if(u&w.e_jointBit)for(r=this.m_jointList;r;r=r.m_next)this.DrawJoint(r);if(u&w.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw);if(u&w.e_pairBit){c.Set(.3,.9,.9);for(var d=this.m_contactManager.m_contactList;d;d=d.GetNext()){var f=d.GetFixtureA(),m=d.GetFixtureB(),y=f.GetAABB().GetCenter(),x=m.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(y,x,c)}}if(u&w.e_aabbBit)for(a=this.m_contactManager.m_broadPhase,h=[new n,new n,new n,new n],t=this.m_bodyList;t;t=t.GetNext())if(0!=t.IsActive())for(e=t.GetFixtureList();e;e=e.GetNext()){var v=a.GetFatAABB(e.m_proxy);h[0].Set(v.lowerBound.x,v.lowerBound.y),h[1].Set(v.upperBound.x,v.lowerBound.y),h[2].Set(v.upperBound.x,v.upperBound.y),h[3].Set(v.lowerBound.x,v.upperBound.y),this.m_debugDraw.DrawPolygon(h,4,c)}if(u&w.e_centerOfMassBit)for(t=this.m_bodyList;t;t=t.m_next)l=M.s_xf,l.R=t.m_xf.R,l.position=t.GetWorldCenter(),this.m_debugDraw.DrawTransform(l)}},M.prototype.QueryAABB=function(t,e){function i(e){return t(o.GetUserData(e))}var n=this,o=n.m_contactManager.m_broadPhase;o.Query(i,e)},M.prototype.QueryShape=function(t,e,n){function o(i){var o=a.GetUserData(i)instanceof D?a.GetUserData(i):null;return!m.TestOverlap(e,n,o.GetShape(),o.GetBody().GetTransform())||t(o)}var r=this;void 0===n&&(n=null),null==n&&(n=new i,n.SetIdentity());var a=r.m_contactManager.m_broadPhase,l=new s;e.ComputeAABB(l,n),a.Query(o,l)},M.prototype.QueryPoint=function(t,e){function i(i){var n=o.GetUserData(i)instanceof D?o.GetUserData(i):null;return!n.TestPoint(e)||t(n)}var n=this,o=n.m_contactManager.m_broadPhase,a=new s;a.lowerBound.Set(e.x-r.b2_linearSlop,e.y-r.b2_linearSlop),a.upperBound.Set(e.x+r.b2_linearSlop,e.y+r.b2_linearSlop),o.Query(i,a)},M.prototype.RayCast=function(t,e,i){function o(o,r){var l=s.GetUserData(r),u=l instanceof D?l:null,h=u.RayCast(a,o);if(h){var c=a.fraction,p=new n((1-c)*e.x+c*i.x,(1-c)*e.y+c*i.y);return t(u,p,a.normal,c)}return o.maxFraction}var r=this,s=r.m_contactManager.m_broadPhase,a=new h,l=new u(e,i);s.RayCast(o,l)},M.prototype.RayCastOne=function(t,e){function i(t,e,i,o){return void 0===o&&(o=0),n=t,o}var n,o=this;return o.RayCast(i,t,e),n},M.prototype.RayCastAll=function(t,e){function i(t,e,i,n){return void 0===n&&(n=0),o[o.length]=t,1}var n=this,o=new Vector;return n.RayCast(i,t,e),o},M.prototype.GetBodyList=function(){return this.m_bodyList},M.prototype.GetJointList=function(){return this.m_jointList},M.prototype.GetContactList=function(){return this.m_contactList},M.prototype.IsLocked=function(){return(this.m_flags&M.e_locked)>0},M.prototype.Solve=function(t){for(var e,i=this.m_controllerList;i;i=i.m_next)i.Step(t);var n=this.m_island;for(n.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~_.e_islandFlag;for(var o=this.m_contactList;o;o=o.m_next)o.m_flags&=~E.e_islandFlag;for(var r=this.m_jointList;r;r=r.m_next)r.m_islandFlag=!1;for(var s=(parseInt(this.m_bodyCount),this.s_stack),a=this.m_bodyList;a;a=a.m_next)if(!(a.m_flags&_.e_islandFlag)&&0!=a.IsAwake()&&0!=a.IsActive()&&a.GetType()!=_.b2_staticBody){n.Clear();var l=0;for(s[l++]=a,a.m_flags|=_.e_islandFlag;l>0;)if(e=s[--l],n.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()!=_.b2_staticBody){for(var u,h=e.m_contactList;h;h=h.next)h.contact.m_flags&E.e_islandFlag||1!=h.contact.IsSensor()&&0!=h.contact.IsEnabled()&&0!=h.contact.IsTouching()&&(n.AddContact(h.contact),h.contact.m_flags|=E.e_islandFlag,u=h.other,u.m_flags&_.e_islandFlag||(s[l++]=u,u.m_flags|=_.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)1!=c.joint.m_islandFlag&&(u=c.other,0!=u.IsActive()&&(n.AddJoint(c.joint),c.joint.m_islandFlag=!0,u.m_flags&_.e_islandFlag||(s[l++]=u,u.m_flags|=_.e_islandFlag)))}n.Solve(t,this.m_gravity,this.m_allowSleep);for(var p=0;p<n.m_bodyCount;++p)e=n.m_bodies[p],e.GetType()==_.b2_staticBody&&(e.m_flags&=~_.e_islandFlag)}for(p=0;p<s.length&&s[p];++p)s[p]=null;for(e=this.m_bodyList;e;e=e.m_next)0!=e.IsAwake()&&0!=e.IsActive()&&e.GetType()!=_.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},M.prototype.SolveTOI=function(t){var e,i,n,o,s,a,l,u=this.m_island;u.Initialize(this.m_bodyCount,r.b2_maxTOIContactsPerIsland,r.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var h=M.s_queue;for(e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~_.e_islandFlag,e.m_sweep.t0=0;var c;for(c=this.m_contactList;c;c=c.m_next)c.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(l=this.m_jointList;l;l=l.m_next)l.m_islandFlag=!1;for(;;){var p=null,d=1;for(c=this.m_contactList;c;c=c.m_next)if(1!=c.IsSensor()&&0!=c.IsEnabled()&&0!=c.IsContinuous()){var f=1;if(c.m_flags&E.e_toiFlag)f=c.m_toi;else{if(i=c.m_fixtureA,n=c.m_fixtureB,o=i.m_body,s=n.m_body,!(o.GetType()==_.b2_dynamicBody&&0!=o.IsAwake()||s.GetType()==_.b2_dynamicBody&&0!=s.IsAwake()))continue;var m=o.m_sweep.t0;o.m_sweep.t0<s.m_sweep.t0?(m=s.m_sweep.t0,o.m_sweep.Advance(m)):s.m_sweep.t0<o.m_sweep.t0&&(m=o.m_sweep.t0,s.m_sweep.Advance(m)),f=c.ComputeTOI(o.m_sweep,s.m_sweep),r.b2Assert(0<=f&&f<=1),f>0&&f<1&&(f=(1-f)*m+f,f>1&&(f=1)),c.m_toi=f,c.m_flags|=E.e_toiFlag}Number.MIN_VALUE<f&&f<d&&(p=c,d=f)}if(null==p||1-100*Number.MIN_VALUE<d)break;if(i=p.m_fixtureA,n=p.m_fixtureB,o=i.m_body,s=n.m_body,M.s_backupA.Set(o.m_sweep),M.s_backupB.Set(s.m_sweep),o.Advance(d),s.Advance(d),p.Update(this.m_contactManager.m_contactListener),p.m_flags&=~E.e_toiFlag,1!=p.IsSensor()&&0!=p.IsEnabled()){if(0!=p.IsTouching()){var y=o;y.GetType()!=_.b2_dynamicBody&&(y=s),u.Clear();var x=0,v=0;for(h[x+v++]=y,y.m_flags|=_.e_islandFlag;v>0;)if(e=h[x++],--v,u.AddBody(e),0==e.IsAwake()&&e.SetAwake(!0),e.GetType()==_.b2_dynamicBody){for(a=e.m_contactList;a&&u.m_contactCount!=u.m_contactCapacity;a=a.next)if(!(a.contact.m_flags&E.e_islandFlag)&&1!=a.contact.IsSensor()&&0!=a.contact.IsEnabled()&&0!=a.contact.IsTouching()){u.AddContact(a.contact),a.contact.m_flags|=E.e_islandFlag;var g=a.other;g.m_flags&_.e_islandFlag||(g.GetType()!=_.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),h[x+v]=g,++v,g.m_flags|=_.e_islandFlag)}for(var b=e.m_jointList;b;b=b.next)u.m_jointCount!=u.m_jointCapacity&&1!=b.joint.m_islandFlag&&(g=b.other,0!=g.IsActive()&&(u.AddJoint(b.joint),b.joint.m_islandFlag=!0,g.m_flags&_.e_islandFlag||(g.GetType()!=_.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),h[x+v]=g,++v,g.m_flags|=_.e_islandFlag)))}var w=M.s_timestep;w.warmStarting=!1,w.dt=(1-d)*t.dt,w.inv_dt=1/w.dt,w.dtRatio=0,w.velocityIterations=t.velocityIterations,w.positionIterations=t.positionIterations,u.SolveTOI(w);var S=0;for(S=0;S<u.m_bodyCount;++S)if(e=u.m_bodies[S],e.m_flags&=~_.e_islandFlag,0!=e.IsAwake()&&e.GetType()==_.b2_dynamicBody)for(e.SynchronizeFixtures(),a=e.m_contactList;a;a=a.next)a.contact.m_flags&=~E.e_toiFlag;for(S=0;S<u.m_contactCount;++S)c=u.m_contacts[S],c.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(S=0;S<u.m_jointCount;++S)l=u.m_joints[S],l.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else o.m_sweep.Set(M.s_backupA),s.m_sweep.Set(M.s_backupB),o.SynchronizeTransform(),s.SynchronizeTransform()}},M.prototype.DrawJoint=function(t){var e=t.GetBodyA(),i=t.GetBodyB(),n=e.m_xf,o=i.m_xf,r=n.position,s=o.position,a=t.GetAnchorA(),l=t.GetAnchorB(),u=M.s_jointColor;switch(t.m_type){case O.e_distanceJoint:this.m_debugDraw.DrawSegment(a,l,u);break;case O.e_pulleyJoint:var h=t instanceof R?t:null,c=h.GetGroundAnchorA(),p=h.GetGroundAnchorB();this.m_debugDraw.DrawSegment(c,a,u),this.m_debugDraw.DrawSegment(p,l,u),this.m_debugDraw.DrawSegment(c,p,u);break;case O.e_mouseJoint:this.m_debugDraw.DrawSegment(a,l,u);break;default:e!=this.m_groundBody&&this.m_debugDraw.DrawSegment(r,a,u),this.m_debugDraw.DrawSegment(a,l,u),i!=this.m_groundBody&&this.m_debugDraw.DrawSegment(s,l,u)}},M.prototype.DrawShape=function(e,i,n){switch(e.m_type){case m.e_circleShape:var o=e instanceof c?e:null,r=t.MulX(i,o.m_p),s=o.m_radius,a=i.R.col1;this.m_debugDraw.DrawSolidCircle(r,s,a,n);break;case m.e_polygonShape:var l=0,u=e instanceof f?e:null,h=parseInt(u.GetVertexCount()),d=u.GetVertices(),_=new Vector(h);for(l=0;l<h;++l)_[l]=t.MulX(i,d[l]);this.m_debugDraw.DrawSolidPolygon(_,h,n);break;case m.e_edgeShape:var y=e instanceof p?e:null;this.m_debugDraw.DrawSegment(t.MulX(i,y.GetVertex1()),t.MulX(i,y.GetVertex2()),n)}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new B,Box2D.Dynamics.b2World.s_xf=new i,Box2D.Dynamics.b2World.s_backupA=new e,Box2D.Dynamics.b2World.s_backupB=new e,Box2D.Dynamics.b2World.s_timestep=new B,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new o(.5,.8,.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var t=Box2D.Collision.Shapes.b2CircleShape,e=(Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape),i=(Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape),n=Box2D.Collision.Shapes.b2Shape,o=Box2D.Dynamics.Contacts.b2CircleContact,r=Box2D.Dynamics.Contacts.b2Contact,s=Box2D.Dynamics.Contacts.b2ContactConstraint,a=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,u=Box2D.Dynamics.Contacts.b2ContactFactory,h=Box2D.Dynamics.Contacts.b2ContactRegister,c=Box2D.Dynamics.Contacts.b2ContactResult,p=Box2D.Dynamics.Contacts.b2ContactSolver,d=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,f=Box2D.Dynamics.Contacts.b2NullContact,m=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,_=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,y=Box2D.Dynamics.Contacts.b2PolygonContact,x=Box2D.Dynamics.Contacts.b2PositionSolverManifold,v=Box2D.Dynamics.b2Body,g=(Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep),b=(Box2D.Dynamics.b2World,Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),w=Box2D.Common.Math.b2Mat22,S=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),C=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),D=(Box2D.Common.Math.b2Vec3,Box2D.Collision.b2AABB,Box2D.Collision.b2Bound,Box2D.Collision.b2BoundValues,Box2D.Collision.b2Collision),T=Box2D.Collision.b2ContactID,A=(Box2D.Collision.b2ContactPoint,Box2D.Collision.b2Distance,Box2D.Collision.b2DistanceInput,Box2D.Collision.b2DistanceOutput,Box2D.Collision.b2DistanceProxy,Box2D.Collision.b2DynamicTree,Box2D.Collision.b2DynamicTreeBroadPhase,Box2D.Collision.b2DynamicTreeNode,Box2D.Collision.b2DynamicTreePair,Box2D.Collision.b2Manifold),B=(Box2D.Collision.b2ManifoldPoint,Box2D.Collision.b2Point,Box2D.Collision.b2RayCastInput,Box2D.Collision.b2RayCastOutput,Box2D.Collision.b2Segment,Box2D.Collision.b2SeparationFunction,Box2D.Collision.b2Simplex,Box2D.Collision.b2SimplexCache,Box2D.Collision.b2SimplexVertex,Box2D.Collision.b2TimeOfImpact),M=Box2D.Collision.b2TOIInput,E=Box2D.Collision.b2WorldManifold;Box2D.Collision.ClipVertex,Box2D.Collision.Features,Box2D.Collision.IBroadPhase;Box2D.inherit(o,Box2D.Dynamics.Contacts.b2Contact),o.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,o.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},o.Create=function(t){return new o},o.Destroy=function(t,e){},o.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},o.prototype.Evaluate=function(){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody();D.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof t?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,i.m_xf)},r.b2Contact=function(){this.m_nodeA=new l,this.m_nodeB=new l,this.m_manifold=new A,this.m_oldManifold=new A},r.prototype.GetManifold=function(){return this.m_manifold},r.prototype.GetWorldManifold=function(t){var e=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t.Initialize(this.m_manifold,e.GetTransform(),n.m_radius,i.GetTransform(),o.m_radius)},r.prototype.IsTouching=function(){return(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag},r.prototype.IsContinuous=function(){return(this.m_flags&r.e_continuousFlag)==r.e_continuousFlag},r.prototype.SetSensor=function(t){t?this.m_flags|=r.e_sensorFlag:this.m_flags&=~r.e_sensorFlag},r.prototype.IsSensor=function(){return(this.m_flags&r.e_sensorFlag)==r.e_sensorFlag},r.prototype.SetEnabled=function(t){t?this.m_flags|=r.e_enabledFlag:this.m_flags&=~r.e_enabledFlag},r.prototype.IsEnabled=function(){return(this.m_flags&r.e_enabledFlag)==r.e_enabledFlag},r.prototype.GetNext=function(){return this.m_next},r.prototype.GetFixtureA=function(){return this.m_fixtureA},r.prototype.GetFixtureB=function(){return this.m_fixtureB},r.prototype.FlagForFiltering=function(){this.m_flags|=r.e_filterFlag},r.prototype.b2Contact=function(){},r.prototype.Reset=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),this.m_flags=r.e_enabledFlag,!t||!e)return this.m_fixtureA=null,void(this.m_fixtureB=null);(t.IsSensor()||e.IsSensor())&&(this.m_flags|=r.e_sensorFlag);var i=t.GetBody(),n=e.GetBody();(i.GetType()!=v.b2_dynamicBody||i.IsBullet()||n.GetType()!=v.b2_dynamicBody||n.IsBullet())&&(this.m_flags|=r.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=e,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},r.prototype.Update=function(t){var e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_flags|=r.e_enabledFlag;var i=!1,o=(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag,s=this.m_fixtureA.m_body,a=this.m_fixtureB.m_body,l=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&r.e_sensorFlag){if(l){var u=this.m_fixtureA.GetShape(),h=this.m_fixtureB.GetShape(),c=s.GetTransform(),p=a.GetTransform();i=n.TestOverlap(u,c,h,p)}this.m_manifold.m_pointCount=0}else{if(s.GetType()!=v.b2_dynamicBody||s.IsBullet()||a.GetType()!=v.b2_dynamicBody||a.IsBullet()?this.m_flags|=r.e_continuousFlag:this.m_flags&=~r.e_continuousFlag,l){this.Evaluate(),i=this.m_manifold.m_pointCount>0;for(var d=0;d<this.m_manifold.m_pointCount;++d){var f=this.m_manifold.m_points[d];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var m=f.m_id,_=0;_<this.m_oldManifold.m_pointCount;++_){var y=this.m_oldManifold.m_points[_];if(y.m_id.key==m.key){f.m_normalImpulse=y.m_normalImpulse,f.m_tangentImpulse=y.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;i!=o&&(s.SetAwake(!0),a.SetAwake(!0))}i?this.m_flags|=r.e_touchingFlag:this.m_flags&=~r.e_touchingFlag,0==o&&1==i&&t.BeginContact(this),1==o&&0==i&&t.EndContact(this),0==(this.m_flags&r.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)},r.prototype.Evaluate=function(){},r.prototype.ComputeTOI=function(t,e){return r.s_input.proxyA.Set(this.m_fixtureA.GetShape()),r.s_input.proxyB.Set(this.m_fixtureB.GetShape()),r.s_input.sweepA=t,r.s_input.sweepB=e,r.s_input.tolerance=b.b2_linearSlop,B.TimeOfImpact(r.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new M}),s.b2ContactConstraint=function(){this.localPlaneNormal=new C,this.localPoint=new C,this.normal=new C,this.normalMass=new w,this.K=new w},s.prototype.b2ContactConstraint=function(){this.points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.points[t]=new a},a.b2ContactConstraintPoint=function(){this.localPoint=new C,this.rA=new C,this.rB=new C},l.b2ContactEdge=function(){},u.b2ContactFactory=function(){},u.prototype.b2ContactFactory=function(t){this.m_allocator=t,this.InitializeRegisters()},u.prototype.AddType=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),this.m_registers[i][n].createFcn=t,this.m_registers[i][n].destroyFcn=e,this.m_registers[i][n].primary=!0,i!=n&&(this.m_registers[n][i].createFcn=t,this.m_registers[n][i].destroyFcn=e,this.m_registers[n][i].primary=!1)},u.prototype.InitializeRegisters=function(){
this.m_registers=new Vector(n.e_shapeTypeCount);for(var t=0;t<n.e_shapeTypeCount;t++){this.m_registers[t]=new Vector(n.e_shapeTypeCount);for(var e=0;e<n.e_shapeTypeCount;e++)this.m_registers[t][e]=new h}this.AddType(o.Create,o.Destroy,n.e_circleShape,n.e_circleShape),this.AddType(m.Create,m.Destroy,n.e_polygonShape,n.e_circleShape),this.AddType(y.Create,y.Destroy,n.e_polygonShape,n.e_polygonShape),this.AddType(d.Create,d.Destroy,n.e_edgeShape,n.e_circleShape),this.AddType(_.Create,_.Destroy,n.e_polygonShape,n.e_edgeShape)},u.prototype.Create=function(t,e){var i,n=parseInt(t.GetType()),o=parseInt(e.GetType()),r=this.m_registers[n][o];if(r.pool)return i=r.pool,r.pool=i.m_next,r.poolCount--,i.Reset(t,e),i;var s=r.createFcn;return null!=s?r.primary?(i=s(this.m_allocator),i.Reset(t,e),i):(i=s(this.m_allocator),i.Reset(e,t),i):null},u.prototype.Destroy=function(t){t.m_manifold.m_pointCount>0&&(t.m_fixtureA.m_body.SetAwake(!0),t.m_fixtureB.m_body.SetAwake(!0));var e=parseInt(t.m_fixtureA.GetType()),i=parseInt(t.m_fixtureB.GetType()),n=this.m_registers[e][i];n.poolCount++,t.m_next=n.pool,n.pool=t;var o=n.destroyFcn;o(t,this.m_allocator)},h.b2ContactRegister=function(){},c.b2ContactResult=function(){this.position=new C,this.normal=new C,this.id=new T},p.b2ContactSolver=function(){this.m_step=new g,this.m_constraints=new Vector},p.prototype.b2ContactSolver=function(){},p.prototype.Initialize=function(t,e,i,n){void 0===i&&(i=0);var o;this.m_step.Set(t),this.m_allocator=n;var r=0;for(this.m_constraintCount=i;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new s;for(r=0;r<i;++r){o=e[r];var a=o.m_fixtureA,l=o.m_fixtureB,u=a.m_shape,h=l.m_shape,c=u.m_radius,d=h.m_radius,f=a.m_body,m=l.m_body,_=o.GetManifold(),y=b.b2MixFriction(a.GetFriction(),l.GetFriction()),x=b.b2MixRestitution(a.GetRestitution(),l.GetRestitution()),v=f.m_linearVelocity.x,g=f.m_linearVelocity.y,w=m.m_linearVelocity.x,S=m.m_linearVelocity.y,C=f.m_angularVelocity,D=m.m_angularVelocity;b.b2Assert(_.m_pointCount>0),p.s_worldManifold.Initialize(_,f.m_xf,c,m.m_xf,d);var T=p.s_worldManifold.m_normal.x,A=p.s_worldManifold.m_normal.y,B=this.m_constraints[r];B.bodyA=f,B.bodyB=m,B.manifold=_,B.normal.x=T,B.normal.y=A,B.pointCount=_.m_pointCount,B.friction=y,B.restitution=x,B.localPlaneNormal.x=_.m_localPlaneNormal.x,B.localPlaneNormal.y=_.m_localPlaneNormal.y,B.localPoint.x=_.m_localPoint.x,B.localPoint.y=_.m_localPoint.y,B.radius=c+d,B.type=_.m_type;for(var M=0;M<B.pointCount;++M){var E=_.m_points[M],P=B.points[M];P.normalImpulse=E.m_normalImpulse,P.tangentImpulse=E.m_tangentImpulse,P.localPoint.SetV(E.m_localPoint);var I=P.rA.x=p.s_worldManifold.m_points[M].x-f.m_sweep.c.x,O=P.rA.y=p.s_worldManifold.m_points[M].y-f.m_sweep.c.y,R=P.rB.x=p.s_worldManifold.m_points[M].x-m.m_sweep.c.x,L=P.rB.y=p.s_worldManifold.m_points[M].y-m.m_sweep.c.y,F=I*A-O*T,V=R*A-L*T;F*=F,V*=V;var k=f.m_invMass+m.m_invMass+f.m_invI*F+m.m_invI*V;P.normalMass=1/k;var G=f.m_mass*f.m_invMass+m.m_mass*m.m_invMass;G+=f.m_mass*f.m_invI*F+m.m_mass*m.m_invI*V,P.equalizedMass=1/G;var N=A,j=-T,U=I*j-O*N,X=R*j-L*N;U*=U,X*=X;var J=f.m_invMass+m.m_invMass+f.m_invI*U+m.m_invI*X;P.tangentMass=1/J,P.velocityBias=0;var W=w+-D*L-v- -C*O,z=S+D*R-g-C*I,H=B.normal.x*W+B.normal.y*z;H<-b.b2_velocityThreshold&&(P.velocityBias+=-B.restitution*H)}if(2==B.pointCount){var q=B.points[0],Y=B.points[1],K=f.m_invMass,Z=f.m_invI,Q=m.m_invMass,$=m.m_invI,tt=q.rA.x*A-q.rA.y*T,et=q.rB.x*A-q.rB.y*T,it=Y.rA.x*A-Y.rA.y*T,nt=Y.rB.x*A-Y.rB.y*T,ot=K+Q+Z*tt*tt+$*et*et,rt=K+Q+Z*it*it+$*nt*nt,st=K+Q+Z*tt*it+$*et*nt,at=100;ot*ot<at*(ot*rt-st*st)?(B.K.col1.Set(ot,st),B.K.col2.Set(st,rt),B.K.GetInverse(B.normalMass)):B.pointCount=1}}},p.prototype.InitVelocityConstraints=function(t){for(var e=0;e<this.m_constraintCount;++e){var i=this.m_constraints[e],n=i.bodyA,o=i.bodyB,r=n.m_invMass,s=n.m_invI,a=o.m_invMass,l=o.m_invI,u=i.normal.x,h=i.normal.y,c=h,p=-u,d=0,f=0;if(t.warmStarting)for(f=i.pointCount,d=0;d<f;++d){var m=i.points[d];m.normalImpulse*=t.dtRatio,m.tangentImpulse*=t.dtRatio;var _=m.normalImpulse*u+m.tangentImpulse*c,y=m.normalImpulse*h+m.tangentImpulse*p;n.m_angularVelocity-=s*(m.rA.x*y-m.rA.y*_),n.m_linearVelocity.x-=r*_,n.m_linearVelocity.y-=r*y,o.m_angularVelocity+=l*(m.rB.x*y-m.rB.y*_),o.m_linearVelocity.x+=a*_,o.m_linearVelocity.y+=a*y}else for(f=i.pointCount,d=0;d<f;++d){var x=i.points[d];x.normalImpulse=0,x.tangentImpulse=0}}},p.prototype.SolveVelocityConstraints=function(){for(var t,e,i=0,n=0,o=0,r=0,s=0,a=0,l=0,u=0,h=0,c=0,p=0,d=0,f=0,m=0,_=0,y=0,x=0;x<this.m_constraintCount;++x){var v=this.m_constraints[x],g=v.bodyA,b=v.bodyB,w=g.m_angularVelocity,C=b.m_angularVelocity,D=g.m_linearVelocity,T=b.m_linearVelocity,A=g.m_invMass,B=g.m_invI,M=b.m_invMass,E=b.m_invI,P=v.normal.x,I=v.normal.y,O=I,R=-P,L=v.friction;for(i=0;i<v.pointCount;i++)t=v.points[i],n=T.x-C*t.rB.y-D.x+w*t.rA.y,o=T.y+C*t.rB.x-D.y-w*t.rA.x,s=n*O+o*R,a=t.tangentMass*-s,l=L*t.normalImpulse,u=S.Clamp(t.tangentImpulse+a,-l,l),a=u-t.tangentImpulse,h=a*O,c=a*R,D.x-=A*h,D.y-=A*c,w-=B*(t.rA.x*c-t.rA.y*h),T.x+=M*h,T.y+=M*c,C+=E*(t.rB.x*c-t.rB.y*h),t.tangentImpulse=u;parseInt(v.pointCount);if(1==v.pointCount)t=v.points[0],n=T.x+-C*t.rB.y-D.x- -w*t.rA.y,o=T.y+C*t.rB.x-D.y-w*t.rA.x,r=n*P+o*I,a=-t.normalMass*(r-t.velocityBias),u=t.normalImpulse+a,u=u>0?u:0,a=u-t.normalImpulse,h=a*P,c=a*I,D.x-=A*h,D.y-=A*c,w-=B*(t.rA.x*c-t.rA.y*h),T.x+=M*h,T.y+=M*c,C+=E*(t.rB.x*c-t.rB.y*h),t.normalImpulse=u;else{var F=v.points[0],V=v.points[1],k=F.normalImpulse,G=V.normalImpulse,N=T.x-C*F.rB.y-D.x+w*F.rA.y,j=T.y+C*F.rB.x-D.y-w*F.rA.x,U=T.x-C*V.rB.y-D.x+w*V.rA.y,X=T.y+C*V.rB.x-D.y-w*V.rA.x,J=N*P+j*I,W=U*P+X*I,z=J-F.velocityBias,H=W-V.velocityBias;e=v.K,z-=e.col1.x*k+e.col2.x*G,H-=e.col1.y*k+e.col2.y*G;for(;;){e=v.normalMass;var q=-(e.col1.x*z+e.col2.x*H),Y=-(e.col1.y*z+e.col2.y*H);if(q>=0&&Y>=0){p=q-k,d=Y-G,f=p*P,m=p*I,_=d*P,y=d*I,D.x-=A*(f+_),D.y-=A*(m+y),w-=B*(F.rA.x*m-F.rA.y*f+V.rA.x*y-V.rA.y*_),T.x+=M*(f+_),T.y+=M*(m+y),C+=E*(F.rB.x*m-F.rB.y*f+V.rB.x*y-V.rB.y*_),F.normalImpulse=q,V.normalImpulse=Y;break}if(q=-F.normalMass*z,Y=0,J=0,W=v.K.col1.y*q+H,q>=0&&W>=0){p=q-k,d=Y-G,f=p*P,m=p*I,_=d*P,y=d*I,D.x-=A*(f+_),D.y-=A*(m+y),w-=B*(F.rA.x*m-F.rA.y*f+V.rA.x*y-V.rA.y*_),T.x+=M*(f+_),T.y+=M*(m+y),C+=E*(F.rB.x*m-F.rB.y*f+V.rB.x*y-V.rB.y*_),F.normalImpulse=q,V.normalImpulse=Y;break}if(q=0,Y=-V.normalMass*H,J=v.K.col2.x*Y+z,W=0,Y>=0&&J>=0){p=q-k,d=Y-G,f=p*P,m=p*I,_=d*P,y=d*I,D.x-=A*(f+_),D.y-=A*(m+y),w-=B*(F.rA.x*m-F.rA.y*f+V.rA.x*y-V.rA.y*_),T.x+=M*(f+_),T.y+=M*(m+y),C+=E*(F.rB.x*m-F.rB.y*f+V.rB.x*y-V.rB.y*_),F.normalImpulse=q,V.normalImpulse=Y;break}if(q=0,Y=0,J=z,W=H,J>=0&&W>=0){p=q-k,d=Y-G,f=p*P,m=p*I,_=d*P,y=d*I,D.x-=A*(f+_),D.y-=A*(m+y),w-=B*(F.rA.x*m-F.rA.y*f+V.rA.x*y-V.rA.y*_),T.x+=M*(f+_),T.y+=M*(m+y),C+=E*(F.rB.x*m-F.rB.y*f+V.rB.x*y-V.rB.y*_),F.normalImpulse=q,V.normalImpulse=Y;break}break}}g.m_angularVelocity=w,b.m_angularVelocity=C}},p.prototype.FinalizeVelocityConstraints=function(){for(var t=0;t<this.m_constraintCount;++t)for(var e=this.m_constraints[t],i=e.manifold,n=0;n<e.pointCount;++n){var o=i.m_points[n],r=e.points[n];o.m_normalImpulse=r.normalImpulse,o.m_tangentImpulse=r.tangentImpulse}},p.prototype.SolvePositionConstraints=function(t){void 0===t&&(t=0);for(var e=0,i=0;i<this.m_constraintCount;i++){var n=this.m_constraints[i],o=n.bodyA,r=n.bodyB,s=o.m_mass*o.m_invMass,a=o.m_mass*o.m_invI,l=r.m_mass*r.m_invMass,u=r.m_mass*r.m_invI;p.s_psm.Initialize(n);for(var h=p.s_psm.m_normal,c=0;c<n.pointCount;c++){var d=n.points[c],f=p.s_psm.m_points[c],m=p.s_psm.m_separations[c],_=f.x-o.m_sweep.c.x,y=f.y-o.m_sweep.c.y,x=f.x-r.m_sweep.c.x,v=f.y-r.m_sweep.c.y;e=e<m?e:m;var g=S.Clamp(t*(m+b.b2_linearSlop),-b.b2_maxLinearCorrection,0),w=-d.equalizedMass*g,C=w*h.x,D=w*h.y;o.m_sweep.c.x-=s*C,o.m_sweep.c.y-=s*D,o.m_sweep.a-=a*(_*D-y*C),o.SynchronizeTransform(),r.m_sweep.c.x+=l*C,r.m_sweep.c.y+=l*D,r.m_sweep.a+=u*(x*D-v*C),r.SynchronizeTransform()}}return e>-1.5*b.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new E,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new x}),Box2D.inherit(d,Box2D.Dynamics.Contacts.b2Contact),d.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,d.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},d.Create=function(t){return new d},d.Destroy=function(t,e){},d.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},d.prototype.Evaluate=function(){var i=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,i.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},d.prototype.b2CollideEdgeAndCircle=function(t,e,i,n,o){},Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact),f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,f.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},f.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},f.prototype.Evaluate=function(){},Box2D.inherit(m,Box2D.Dynamics.Contacts.b2Contact),m.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,m.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},m.Create=function(t){return new m},m.Destroy=function(t,e){},m.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),b.b2Assert(t.GetType()==n.e_polygonShape),b.b2Assert(e.GetType()==n.e_circleShape)},m.prototype.Evaluate=function(){var e=this.m_fixtureA.m_body,n=this.m_fixtureB.m_body;D.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,e.m_xf,this.m_fixtureB.GetShape()instanceof t?this.m_fixtureB.GetShape():null,n.m_xf)},Box2D.inherit(_,Box2D.Dynamics.Contacts.b2Contact),_.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,_.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},_.Create=function(t){return new _},_.Destroy=function(t,e){},_.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e),b.b2Assert(t.GetType()==n.e_polygonShape),b.b2Assert(e.GetType()==n.e_edgeShape)},_.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),n=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,n.m_xf)},_.prototype.b2CollidePolyAndEdge=function(t,e,i,n,o){},Box2D.inherit(y,Box2D.Dynamics.Contacts.b2Contact),y.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,y.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},y.Create=function(t){return new y},y.Destroy=function(t,e){},y.prototype.Reset=function(t,e){this.__super.Reset.call(this,t,e)},y.prototype.Evaluate=function(){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();D.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof i?this.m_fixtureA.GetShape():null,t.m_xf,this.m_fixtureB.GetShape()instanceof i?this.m_fixtureB.GetShape():null,e.m_xf)},x.b2PositionSolverManifold=function(){},x.prototype.b2PositionSolverManifold=function(){this.m_normal=new C,this.m_separations=new Vector_a2j_Number(b.b2_maxManifoldPoints),this.m_points=new Vector(b.b2_maxManifoldPoints);for(var t=0;t<b.b2_maxManifoldPoints;t++)this.m_points[t]=new C},x.prototype.Initialize=function(t){b.b2Assert(t.pointCount>0);var e,i,n=0,o=0,r=0,s=0,a=0;switch(t.type){case A.e_circles:e=t.bodyA.m_xf.R,i=t.localPoint;var l=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),u=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y);e=t.bodyB.m_xf.R,i=t.points[0].localPoint;var h=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),c=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),p=h-l,d=c-u,f=p*p+d*d;if(f>Number.MIN_VALUE*Number.MIN_VALUE){var m=Math.sqrt(f);this.m_normal.x=p/m,this.m_normal.y=d/m}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(l+h),this.m_points[0].y=.5*(u+c),this.m_separations[0]=p*this.m_normal.x+d*this.m_normal.y-t.radius;break;case A.e_faceA:for(e=t.bodyA.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyA.m_xf.R,i=t.localPoint,s=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyB.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].x=o,this.m_points[n].y=r;break;case A.e_faceB:for(e=t.bodyB.m_xf.R,i=t.localPlaneNormal,this.m_normal.x=e.col1.x*i.x+e.col2.x*i.y,this.m_normal.y=e.col1.y*i.x+e.col2.y*i.y,e=t.bodyB.m_xf.R,i=t.localPoint,s=t.bodyB.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),a=t.bodyB.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),e=t.bodyA.m_xf.R,n=0;n<t.pointCount;++n)i=t.points[n].localPoint,o=t.bodyA.m_xf.position.x+(e.col1.x*i.x+e.col2.x*i.y),r=t.bodyA.m_xf.position.y+(e.col1.y*i.x+e.col2.y*i.y),this.m_separations[n]=(o-s)*this.m_normal.x+(r-a)*this.m_normal.y-t.radius,this.m_points[n].Set(o,r);this.m_normal.x*=-1,this.m_normal.y*=-1}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new C,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new C})}(),function(){var t=(Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World,Box2D.Common.Math.b2Mat22),e=(Box2D.Common.Math.b2Mat33,Box2D.Common.Math.b2Math),i=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),n=(Box2D.Common.Math.b2Vec3,Box2D.Common.b2Color),o=(Box2D.Common.b2internal,Box2D.Common.b2Settings,Box2D.Collision.Shapes.b2CircleShape,Box2D.Collision.Shapes.b2EdgeChainDef,Box2D.Collision.Shapes.b2EdgeShape,Box2D.Collision.Shapes.b2MassData,Box2D.Collision.Shapes.b2PolygonShape,Box2D.Collision.Shapes.b2Shape,Box2D.Dynamics.Controllers.b2BuoyancyController),r=Box2D.Dynamics.Controllers.b2ConstantAccelController,s=Box2D.Dynamics.Controllers.b2ConstantForceController,a=Box2D.Dynamics.Controllers.b2Controller,l=Box2D.Dynamics.Controllers.b2ControllerEdge,u=Box2D.Dynamics.Controllers.b2GravityController,h=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(o,Box2D.Dynamics.Controllers.b2Controller),o.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,o.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new i(0,-1),this.offset=0,this.density=0,this.velocity=new i(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},o.prototype.Step=function(t){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var e=this.m_bodyList;e;e=e.nextBody){var n=e.body;if(0!=n.IsAwake()){for(var o=new i,r=new i,s=0,a=0,l=n.GetFixtureList();l;l=l.GetNext()){var u=new i,h=l.GetShape().ComputeSubmergedArea(this.normal,this.offset,n.GetTransform(),u);s+=h,o.x+=h*u.x,o.y+=h*u.y;var c=0;c=(this.useDensity,1),a+=h*c,r.x+=h*u.x*c,r.y+=h*u.y*c}if(o.x/=s,o.y/=s,r.x/=a,r.y/=a,!(s<Number.MIN_VALUE)){var p=this.gravity.GetNegative();p.Multiply(this.density*s),n.ApplyForce(p,r);var d=n.GetLinearVelocityFromWorldPoint(o);d.Subtract(this.velocity),d.Multiply(-this.linearDrag*s),n.ApplyForce(d,o),n.ApplyTorque(-n.GetInertia()/n.GetMass()*s*n.GetAngularVelocity()*this.angularDrag)}}}}},o.prototype.Draw=function(t){var e=1e3,o=new i,r=new i;o.x=this.normal.x*this.offset+this.normal.y*e,o.y=this.normal.y*this.offset-this.normal.x*e,r.x=this.normal.x*this.offset-this.normal.y*e,r.y=this.normal.y*this.offset+this.normal.x*e;var s=new n(0,0,1);t.DrawSegment(o,r,s)},Box2D.inherit(r,Box2D.Dynamics.Controllers.b2Controller),r.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,r.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new i(0,0)},r.prototype.Step=function(t){for(var e=new i(this.A.x*t.dt,this.A.y*t.dt),n=this.m_bodyList;n;n=n.nextBody){var o=n.body;o.IsAwake()&&o.SetLinearVelocity(new i(o.GetLinearVelocity().x+e.x,o.GetLinearVelocity().y+e.y))}},Box2D.inherit(s,Box2D.Dynamics.Controllers.b2Controller),s.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,s.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new i(0,0)},s.prototype.Step=function(t){for(var e=this.m_bodyList;e;e=e.nextBody){var i=e.body;i.IsAwake()&&i.ApplyForce(this.F,i.GetWorldCenter())}},a.b2Controller=function(){},a.prototype.Step=function(t){},a.prototype.Draw=function(t){},a.prototype.AddBody=function(t){var e=new l;e.controller=this,e.body=t,e.nextBody=this.m_bodyList,e.prevBody=null,this.m_bodyList=e,e.nextBody&&(e.nextBody.prevBody=e),this.m_bodyCount++,e.nextController=t.m_controllerList,e.prevController=null,t.m_controllerList=e,e.nextController&&(e.nextController.prevController=e),t.m_controllerCount++},a.prototype.RemoveBody=function(t){for(var e=t.m_controllerList;e&&e.controller!=this;)e=e.nextController;e.prevBody&&(e.prevBody.nextBody=e.nextBody),e.nextBody&&(e.nextBody.prevBody=e.prevBody),e.nextController&&(e.nextController.prevController=e.prevController),e.prevController&&(e.prevController.nextController=e.nextController),this.m_bodyList==e&&(this.m_bodyList=e.nextBody),t.m_controllerList==e&&(t.m_controllerList=e.nextController),t.m_controllerCount--,this.m_bodyCount--},a.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},a.prototype.GetNext=function(){return this.m_next},a.prototype.GetWorld=function(){return this.m_world},a.prototype.GetBodyList=function(){return this.m_bodyList},l.b2ControllerEdge=function(){},Box2D.inherit(u,Box2D.Dynamics.Controllers.b2Controller),u.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,u.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},u.prototype.Step=function(t){var e=null,n=null,o=null,r=0,s=null,a=null,l=null,u=0,h=0,c=0,p=null;if(this.invSqr)for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,o=n.GetWorldCenter(),r=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),u=l.x-o.x,h=l.y-o.y,c=u*u+h*h,c<Number.MIN_VALUE||(p=new i(u,h),p.Multiply(this.G/c/Math.sqrt(c)*r*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,o),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l));else for(e=this.m_bodyList;e;e=e.nextBody)for(n=e.body,o=n.GetWorldCenter(),r=n.GetMass(),s=this.m_bodyList;s!=e;s=s.nextBody)a=s.body,l=a.GetWorldCenter(),u=l.x-o.x,h=l.y-o.y,c=u*u+h*h,c<Number.MIN_VALUE||(p=new i(u,h),p.Multiply(this.G/c*r*a.GetMass()),n.IsAwake()&&n.ApplyForce(p,o),p.Multiply(-1),a.IsAwake()&&a.ApplyForce(p,l))},Box2D.inherit(h,Box2D.Dynamics.Controllers.b2Controller),h.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,h.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new t,this.maxTimestep=0},h.prototype.SetAxisAligned=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.T.col1.x=-t,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-e,t>0||e>0?this.maxTimestep=1/Math.max(t,e):this.maxTimestep=0},h.prototype.Step=function(t){var n=t.dt;if(!(n<=Number.MIN_VALUE)){n>this.maxTimestep&&this.maxTimestep>0&&(n=this.maxTimestep);for(var o=this.m_bodyList;o;o=o.nextBody){var r=o.body;if(r.IsAwake()){var s=r.GetWorldVector(e.MulMV(this.T,r.GetLocalVector(r.GetLinearVelocity())));r.SetLinearVelocity(new i(r.GetLinearVelocity().x+s.x*n,r.GetLinearVelocity().y+s.y*n))}}}}}(),function(){var t=(Box2D.Common.b2Color,Box2D.Common.b2internal,Box2D.Common.b2Settings),e=Box2D.Common.Math.b2Mat22,i=Box2D.Common.Math.b2Mat33,n=Box2D.Common.Math.b2Math,o=(Box2D.Common.Math.b2Sweep,Box2D.Common.Math.b2Transform,Box2D.Common.Math.b2Vec2),r=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,a=Box2D.Dynamics.Joints.b2DistanceJointDef,l=Box2D.Dynamics.Joints.b2FrictionJoint,u=Box2D.Dynamics.Joints.b2FrictionJointDef,h=Box2D.Dynamics.Joints.b2GearJoint,c=Box2D.Dynamics.Joints.b2GearJointDef,p=Box2D.Dynamics.Joints.b2Jacobian,d=Box2D.Dynamics.Joints.b2Joint,f=Box2D.Dynamics.Joints.b2JointDef,m=Box2D.Dynamics.Joints.b2JointEdge,_=Box2D.Dynamics.Joints.b2LineJoint,y=Box2D.Dynamics.Joints.b2LineJointDef,x=Box2D.Dynamics.Joints.b2MouseJoint,v=Box2D.Dynamics.Joints.b2MouseJointDef,g=Box2D.Dynamics.Joints.b2PrismaticJoint,b=Box2D.Dynamics.Joints.b2PrismaticJointDef,w=Box2D.Dynamics.Joints.b2PulleyJoint,S=Box2D.Dynamics.Joints.b2PulleyJointDef,C=Box2D.Dynamics.Joints.b2RevoluteJoint,D=Box2D.Dynamics.Joints.b2RevoluteJointDef,T=Box2D.Dynamics.Joints.b2WeldJoint,A=Box2D.Dynamics.Joints.b2WeldJointDef;Box2D.Dynamics.b2Body,Box2D.Dynamics.b2BodyDef,Box2D.Dynamics.b2ContactFilter,Box2D.Dynamics.b2ContactImpulse,Box2D.Dynamics.b2ContactListener,Box2D.Dynamics.b2ContactManager,Box2D.Dynamics.b2DebugDraw,Box2D.Dynamics.b2DestructionListener,Box2D.Dynamics.b2FilterData,Box2D.Dynamics.b2Fixture,Box2D.Dynamics.b2FixtureDef,Box2D.Dynamics.b2Island,Box2D.Dynamics.b2TimeStep,Box2D.Dynamics.b2World;Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint),s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_u=new o},s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},s.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_u.x,t*this.m_impulse*this.m_u.y)},s.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},s.prototype.GetLength=function(){return this.m_length},s.prototype.SetLength=function(t){void 0===t&&(t=0),this.m_length=t},s.prototype.GetFrequency=function(){return this.m_frequencyHz},s.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},s.prototype.GetDampingRatio=function(){return this.m_dampingRatio},s.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},s.prototype.b2DistanceJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_length=t.length,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},s.prototype.InitVelocityConstraints=function(e){var i,n=0,o=this.m_bodyA,r=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchor1.x-o.m_sweep.localCenter.x,a=this.m_localAnchor1.y-o.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=r.m_xf.R;var l=this.m_localAnchor2.x-r.m_sweep.localCenter.x,u=this.m_localAnchor2.y-r.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=n,this.m_u.x=r.m_sweep.c.x+l-o.m_sweep.c.x-s,this.m_u.y=r.m_sweep.c.y+u-o.m_sweep.c.y-a;var h=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);h>t.b2_linearSlop?this.m_u.Multiply(1/h):this.m_u.SetZero();var c=s*this.m_u.y-a*this.m_u.x,p=l*this.m_u.y-u*this.m_u.x,d=o.m_invMass+o.m_invI*c*c+r.m_invMass+r.m_invI*p*p;if(this.m_mass=0!=d?1/d:0,this.m_frequencyHz>0){var f=h-this.m_length,m=2*Math.PI*this.m_frequencyHz,_=2*this.m_mass*this.m_dampingRatio*m,y=this.m_mass*m*m;this.m_gamma=e.dt*(_+e.dt*y),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=f*e.dt*y*this.m_gamma,this.m_mass=d+this.m_gamma,this.m_mass=0!=this.m_mass?1/this.m_mass:0}if(e.warmStarting){this.m_impulse*=e.dtRatio;var x=this.m_impulse*this.m_u.x,v=this.m_impulse*this.m_u.y;o.m_linearVelocity.x-=o.m_invMass*x,o.m_linearVelocity.y-=o.m_invMass*v,o.m_angularVelocity-=o.m_invI*(s*v-a*x),r.m_linearVelocity.x+=r.m_invMass*x,r.m_linearVelocity.y+=r.m_invMass*v,r.m_angularVelocity+=r.m_invI*(l*v-u*x)}else this.m_impulse=0},s.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,n=this.m_bodyB;e=i.m_xf.R;var o=this.m_localAnchor1.x-i.m_sweep.localCenter.x,r=this.m_localAnchor1.y-i.m_sweep.localCenter.y,s=e.col1.x*o+e.col2.x*r;r=e.col1.y*o+e.col2.y*r,o=s,e=n.m_xf.R;var a=this.m_localAnchor2.x-n.m_sweep.localCenter.x,l=this.m_localAnchor2.y-n.m_sweep.localCenter.y;s=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=s;var u=i.m_linearVelocity.x+-i.m_angularVelocity*r,h=i.m_linearVelocity.y+i.m_angularVelocity*o,c=n.m_linearVelocity.x+-n.m_angularVelocity*l,p=n.m_linearVelocity.y+n.m_angularVelocity*a,d=this.m_u.x*(c-u)+this.m_u.y*(p-h),f=-this.m_mass*(d+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;var m=f*this.m_u.x,_=f*this.m_u.y;i.m_linearVelocity.x-=i.m_invMass*m,i.m_linearVelocity.y-=i.m_invMass*_,i.m_angularVelocity-=i.m_invI*(o*_-r*m),n.m_linearVelocity.x+=n.m_invMass*m,n.m_linearVelocity.y+=n.m_invMass*_,n.m_angularVelocity+=n.m_invI*(a*_-l*m)},s.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i;if(this.m_frequencyHz>0)return!0;var o=this.m_bodyA,r=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchor1.x-o.m_sweep.localCenter.x,a=this.m_localAnchor1.y-o.m_sweep.localCenter.y,l=i.col1.x*s+i.col2.x*a;a=i.col1.y*s+i.col2.y*a,s=l,i=r.m_xf.R;var u=this.m_localAnchor2.x-r.m_sweep.localCenter.x,h=this.m_localAnchor2.y-r.m_sweep.localCenter.y;l=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=l;var c=r.m_sweep.c.x+u-o.m_sweep.c.x-s,p=r.m_sweep.c.y+h-o.m_sweep.c.y-a,d=Math.sqrt(c*c+p*p);c/=d,p/=d;var f=d-this.m_length;f=n.Clamp(f,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection);var m=-this.m_mass*f;this.m_u.Set(c,p);var _=m*this.m_u.x,y=m*this.m_u.y;return o.m_sweep.c.x-=o.m_invMass*_,o.m_sweep.c.y-=o.m_invMass*y,o.m_sweep.a-=o.m_invI*(s*y-a*_),r.m_sweep.c.x+=r.m_invMass*_,r.m_sweep.c.y+=r.m_invMass*y,r.m_sweep.a+=r.m_invI*(u*y-h*_),o.SynchronizeTransform(),r.SynchronizeTransform(),n.Abs(f)<t.b2_linearSlop},Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef),a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,a.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},a.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},a.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(n));var o=n.x-i.x,r=n.y-i.y;this.length=Math.sqrt(o*o+r*r),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint),l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,l.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new o,this.m_localAnchorB=new o,this.m_linearMass=new e,this.m_linearImpulse=new o},l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},l.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_linearImpulse.x,t*this.m_linearImpulse.y)},l.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_angularImpulse},l.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},l.prototype.GetMaxForce=function(){return this.m_maxForce},l.prototype.SetMaxTorque=function(t){void 0===t&&(t=0),this.m_maxTorque=t},l.prototype.GetMaxTorque=function(){return this.m_maxTorque},l.prototype.b2FrictionJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque},l.prototype.InitVelocityConstraints=function(t){var i,n=0,o=this.m_bodyA,r=this.m_bodyB;i=o.m_xf.R;var s=this.m_localAnchorA.x-o.m_sweep.localCenter.x,a=this.m_localAnchorA.y-o.m_sweep.localCenter.y;n=i.col1.x*s+i.col2.x*a,a=i.col1.y*s+i.col2.y*a,s=n,i=r.m_xf.R;var l=this.m_localAnchorB.x-r.m_sweep.localCenter.x,u=this.m_localAnchorB.y-r.m_sweep.localCenter.y;n=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=n;var h=o.m_invMass,c=r.m_invMass,p=o.m_invI,d=r.m_invI,f=new e;if(f.col1.x=h+c,f.col2.x=0,f.col1.y=0,f.col2.y=h+c,f.col1.x+=p*a*a,f.col2.x+=-p*s*a,f.col1.y+=-p*s*a,f.col2.y+=p*s*s,f.col1.x+=d*u*u,f.col2.x+=-d*l*u,f.col1.y+=-d*l*u,f.col2.y+=d*l*l,f.GetInverse(this.m_linearMass),this.m_angularMass=p+d,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.x*=t.dtRatio,this.m_linearImpulse.y*=t.dtRatio,this.m_angularImpulse*=t.dtRatio;var m=this.m_linearImpulse;o.m_linearVelocity.x-=h*m.x,o.m_linearVelocity.y-=h*m.y,o.m_angularVelocity-=p*(s*m.y-a*m.x+this.m_angularImpulse),r.m_linearVelocity.x+=c*m.x,r.m_linearVelocity.y+=c*m.y,r.m_angularVelocity+=d*(l*m.y-u*m.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},l.prototype.SolveVelocityConstraints=function(t){var e,i=0,r=this.m_bodyA,s=this.m_bodyB,a=r.m_linearVelocity,l=r.m_angularVelocity,u=s.m_linearVelocity,h=s.m_angularVelocity,c=r.m_invMass,p=s.m_invMass,d=r.m_invI,f=s.m_invI;e=r.m_xf.R;var m=this.m_localAnchorA.x-r.m_sweep.localCenter.x,_=this.m_localAnchorA.y-r.m_sweep.localCenter.y;i=e.col1.x*m+e.col2.x*_,_=e.col1.y*m+e.col2.y*_,m=i,e=s.m_xf.R;var y=this.m_localAnchorB.x-s.m_sweep.localCenter.x,x=this.m_localAnchorB.y-s.m_sweep.localCenter.y;i=e.col1.x*y+e.col2.x*x,x=e.col1.y*y+e.col2.y*x,y=i;var v=0,g=h-l,b=-this.m_angularMass*g,w=this.m_angularImpulse;v=t.dt*this.m_maxTorque,this.m_angularImpulse=n.Clamp(this.m_angularImpulse+b,-v,v),b=this.m_angularImpulse-w,l-=d*b,h+=f*b;var S=u.x-h*x-a.x+l*_,C=u.y+h*y-a.y-l*m,D=n.MulMV(this.m_linearMass,new o(-S,-C)),T=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(D),v=t.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>v*v&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(v)),D=n.SubtractVV(this.m_linearImpulse,T),a.x-=c*D.x,a.y-=c*D.y,l-=d*(m*D.y-_*D.x),u.x+=p*D.x,u.y+=p*D.y,h+=f*(y*D.y-x*D.x),r.m_angularVelocity=l,s.m_angularVelocity=h},l.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(u,Box2D.Dynamics.Joints.b2JointDef),u.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,u.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},u.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_frictionJoint,this.maxForce=0,this.maxTorque=0},u.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i))},Box2D.inherit(h,Box2D.Dynamics.Joints.b2Joint),h.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,h.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new o,this.m_groundAnchor2=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_J=new p},h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},h.prototype.GetAnchorB=function(){
return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},h.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_J.linearB.x,t*this.m_impulse*this.m_J.linearB.y)},h.prototype.GetReactionTorque=function(t){void 0===t&&(t=0);var e=this.m_bodyB.m_xf.R,i=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,n=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,o=e.col1.x*i+e.col2.x*n;n=e.col1.y*i+e.col2.y*n,i=o;var r=this.m_impulse*this.m_J.linearB.x,s=this.m_impulse*this.m_J.linearB.y;return t*(this.m_impulse*this.m_J.angularB-i*s+n*r)},h.prototype.GetRatio=function(){return this.m_ratio},h.prototype.SetRatio=function(t){void 0===t&&(t=0),this.m_ratio=t},h.prototype.b2GearJoint=function(t){this.__super.b2Joint.call(this,t);var e=parseInt(t.joint1.m_type),i=parseInt(t.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var n=0,o=0;this.m_ground1=t.joint1.GetBodyA(),this.m_bodyA=t.joint1.GetBodyB(),e==d.e_revoluteJoint?(this.m_revolute1=t.joint1 instanceof C?t.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),n=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=t.joint1 instanceof g?t.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),n=this.m_prismatic1.GetJointTranslation()),this.m_ground2=t.joint2.GetBodyA(),this.m_bodyB=t.joint2.GetBodyB(),i==d.e_revoluteJoint?(this.m_revolute2=t.joint2 instanceof C?t.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),o=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=t.joint2 instanceof g?t.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),o=this.m_prismatic2.GetJointTranslation()),this.m_ratio=t.ratio,this.m_constant=n+this.m_ratio*o,this.m_impulse=0},h.prototype.InitVelocityConstraints=function(t){var e,i,n=this.m_ground1,o=this.m_ground2,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,u=0,h=0,c=0,p=0,d=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,d+=r.m_invI):(e=n.m_xf.R,i=this.m_prismatic1.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=r.m_xf.R,u=this.m_localAnchor1.x-r.m_sweep.localCenter.x,h=this.m_localAnchor1.y-r.m_sweep.localCenter.y,p=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=p,c=u*l-h*a,this.m_J.linearA.Set(-a,-l),this.m_J.angularA=-c,d+=r.m_invMass+r.m_invI*c*c),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,d+=this.m_ratio*this.m_ratio*s.m_invI):(e=o.m_xf.R,i=this.m_prismatic2.m_localXAxis1,a=e.col1.x*i.x+e.col2.x*i.y,l=e.col1.y*i.x+e.col2.y*i.y,e=s.m_xf.R,u=this.m_localAnchor2.x-s.m_sweep.localCenter.x,h=this.m_localAnchor2.y-s.m_sweep.localCenter.y,p=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=p,c=u*l-h*a,this.m_J.linearB.Set(-this.m_ratio*a,-this.m_ratio*l),this.m_J.angularB=-this.m_ratio*c,d+=this.m_ratio*this.m_ratio*(s.m_invMass+s.m_invI*c*c)),this.m_mass=d>0?1/d:0,t.warmStarting?(r.m_linearVelocity.x+=r.m_invMass*this.m_impulse*this.m_J.linearA.x,r.m_linearVelocity.y+=r.m_invMass*this.m_impulse*this.m_J.linearA.y,r.m_angularVelocity+=r.m_invI*this.m_impulse*this.m_J.angularA,s.m_linearVelocity.x+=s.m_invMass*this.m_impulse*this.m_J.linearB.x,s.m_linearVelocity.y+=s.m_invMass*this.m_impulse*this.m_J.linearB.y,s.m_angularVelocity+=s.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},h.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,n=this.m_J.Compute(e.m_linearVelocity,e.m_angularVelocity,i.m_linearVelocity,i.m_angularVelocity),o=-this.m_mass*n;this.m_impulse+=o,e.m_linearVelocity.x+=e.m_invMass*o*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*o*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*o*this.m_J.angularA,i.m_linearVelocity.x+=i.m_invMass*o*this.m_J.linearB.x,i.m_linearVelocity.y+=i.m_invMass*o*this.m_J.linearB.y,i.m_angularVelocity+=i.m_invI*o*this.m_J.angularB},h.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i=0,n=this.m_bodyA,o=this.m_bodyB,r=0,s=0;r=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),s=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var a=this.m_constant-(r+this.m_ratio*s),l=-this.m_mass*a;return n.m_sweep.c.x+=n.m_invMass*l*this.m_J.linearA.x,n.m_sweep.c.y+=n.m_invMass*l*this.m_J.linearA.y,n.m_sweep.a+=n.m_invI*l*this.m_J.angularA,o.m_sweep.c.x+=o.m_invMass*l*this.m_J.linearB.x,o.m_sweep.c.y+=o.m_invMass*l*this.m_J.linearB.y,o.m_sweep.a+=o.m_invI*l*this.m_J.angularB,n.SynchronizeTransform(),o.SynchronizeTransform(),i<t.b2_linearSlop},Box2D.inherit(c,Box2D.Dynamics.Joints.b2JointDef),c.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,c.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},c.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},p.b2Jacobian=function(){this.linearA=new o,this.linearB=new o},p.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},p.prototype.Set=function(t,e,i,n){void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.SetV(t),this.angularA=e,this.linearB.SetV(i),this.angularB=n},p.prototype.Compute=function(t,e,i,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.linearA.x*t.x+this.linearA.y*t.y+this.angularA*e+(this.linearB.x*i.x+this.linearB.y*i.y)+this.angularB*n},d.b2Joint=function(){this.m_edgeA=new m,this.m_edgeB=new m,this.m_localCenterA=new o,this.m_localCenterB=new o},d.prototype.GetType=function(){return this.m_type},d.prototype.GetAnchorA=function(){return null},d.prototype.GetAnchorB=function(){return null},d.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),null},d.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},d.prototype.GetBodyA=function(){return this.m_bodyA},d.prototype.GetBodyB=function(){return this.m_bodyB},d.prototype.GetNext=function(){return this.m_next},d.prototype.GetUserData=function(){return this.m_userData},d.prototype.SetUserData=function(t){this.m_userData=t},d.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},d.Create=function(t,e){var i=null;switch(t.type){case d.e_distanceJoint:i=new s(t instanceof a?t:null);break;case d.e_mouseJoint:i=new x(t instanceof v?t:null);break;case d.e_prismaticJoint:i=new g(t instanceof b?t:null);break;case d.e_revoluteJoint:i=new C(t instanceof D?t:null);break;case d.e_pulleyJoint:i=new w(t instanceof S?t:null);break;case d.e_gearJoint:i=new h(t instanceof c?t:null);break;case d.e_lineJoint:i=new _(t instanceof y?t:null);break;case d.e_weldJoint:i=new T(t instanceof A?t:null);break;case d.e_frictionJoint:i=new l(t instanceof u?t:null)}return i},d.Destroy=function(t,e){},d.prototype.b2Joint=function(e){t.b2Assert(e.bodyA!=e.bodyB),this.m_type=e.type,this.m_prev=null,this.m_next=null,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_islandFlag=!1,this.m_userData=e.userData},d.prototype.InitVelocityConstraints=function(t){},d.prototype.SolveVelocityConstraints=function(t){},d.prototype.FinalizeVelocityConstraints=function(){},d.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),f.b2JointDef=function(){},f.prototype.b2JointDef=function(){this.type=d.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},m.b2JointEdge=function(){},Box2D.inherit(_,Box2D.Dynamics.Joints.b2Joint),_.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,_.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_localXAxis1=new o,this.m_localYAxis1=new o,this.m_axis=new o,this.m_perp=new o,this.m_K=new e,this.m_impulse=new o},_.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},_.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},_.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},_.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},_.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1),a=s.x*o+s.y*r;return a},_.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,u=e.m_sweep.c.y+o,h=i.m_sweep.c.x+s,c=i.m_sweep.c.y+a,p=h-l,d=c-u,f=e.GetWorldVector(this.m_localXAxis1),m=e.m_linearVelocity,_=i.m_linearVelocity,y=e.m_angularVelocity,x=i.m_angularVelocity,v=p*(-y*f.y)+d*(y*f.x)+(f.x*(_.x+-x*a-m.x- -y*o)+f.y*(_.y+x*s-m.y-y*n));return v},_.prototype.IsLimitEnabled=function(){return this.m_enableLimit},_.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},_.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},_.prototype.GetUpperLimit=function(){return this.m_upperTranslation},_.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},_.prototype.IsMotorEnabled=function(){return this.m_enableMotor},_.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},_.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},_.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},_.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},_.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},_.prototype.GetMotorForce=function(){return this.m_motorImpulse},_.prototype.b2LineJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},_.prototype.InitVelocityConstraints=function(e){var i,o=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(o.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var a=o.GetTransform();r.GetTransform();i=o.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=s,i=r.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,c=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*h+i.col2.x*c,c=i.col1.y*h+i.col2.y*c,h=s;var p=r.m_sweep.c.x+h-o.m_sweep.c.x-l,f=r.m_sweep.c.y+c-o.m_sweep.c.y-u;this.m_invMassA=o.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=o.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(n.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(f+u)*this.m_axis.x,this.m_a2=h*this.m_axis.y-c*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0,this.m_perp.SetV(n.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(f+u)*this.m_perp.x,this.m_s2=h*this.m_perp.y-c*this.m_perp.x;var m=this.m_invMassA,_=this.m_invMassB,y=this.m_invIA,x=this.m_invIB;if(this.m_K.col1.x=m+_+y*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+_+y*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*p+this.m_axis.y*f;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=d.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=d.e_atLowerLimit&&(this.m_limitState=d.e_atLowerLimit,this.m_impulse.y=0):v>=this.m_upperTranslation?this.m_limitState!=d.e_atUpperLimit&&(this.m_limitState=d.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=d.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var g=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,S=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;o.m_linearVelocity.x-=this.m_invMassA*g,o.m_linearVelocity.y-=this.m_invMassA*b,o.m_angularVelocity-=this.m_invIA*w,r.m_linearVelocity.x+=this.m_invMassB*g,r.m_linearVelocity.y+=this.m_invMassB*b,r.m_angularVelocity+=this.m_invIB*S}else this.m_impulse.SetZero(),this.m_motorImpulse=0},_.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,r=e.m_linearVelocity,s=e.m_angularVelocity,a=i.m_linearVelocity,l=i.m_angularVelocity,u=0,h=0,c=0,p=0;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var f=this.m_axis.x*(a.x-r.x)+this.m_axis.y*(a.y-r.y)+this.m_a2*l-this.m_a1*s,m=this.m_motorMass*(this.m_motorSpeed-f),_=this.m_motorImpulse,y=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+m,-y,y),m=this.m_motorImpulse-_,u=m*this.m_axis.x,h=m*this.m_axis.y,c=m*this.m_a1,p=m*this.m_a2,r.x-=this.m_invMassA*u,r.y-=this.m_invMassA*h,s-=this.m_invIA*c,a.x+=this.m_invMassB*u,a.y+=this.m_invMassB*h,l+=this.m_invIB*p}var x=this.m_perp.x*(a.x-r.x)+this.m_perp.y*(a.y-r.y)+this.m_s2*l-this.m_s1*s;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var v=this.m_axis.x*(a.x-r.x)+this.m_axis.y*(a.y-r.y)+this.m_a2*l-this.m_a1*s,g=this.m_impulse.Copy(),b=this.m_K.Solve(new o,-x,-v);this.m_impulse.Add(b),this.m_limitState==d.e_atLowerLimit?this.m_impulse.y=n.Max(this.m_impulse.y,0):this.m_limitState==d.e_atUpperLimit&&(this.m_impulse.y=n.Min(this.m_impulse.y,0));var w=-x-(this.m_impulse.y-g.y)*this.m_K.col2.x,S=0;S=0!=this.m_K.col1.x?w/this.m_K.col1.x+g.x:g.x,this.m_impulse.x=S,b.x=this.m_impulse.x-g.x,b.y=this.m_impulse.y-g.y,u=b.x*this.m_perp.x+b.y*this.m_axis.x,h=b.x*this.m_perp.y+b.y*this.m_axis.y,c=b.x*this.m_s1+b.y*this.m_a1,p=b.x*this.m_s2+b.y*this.m_a2,r.x-=this.m_invMassA*u,r.y-=this.m_invMassA*h,s-=this.m_invIA*c,a.x+=this.m_invMassB*u,a.y+=this.m_invMassB*h,l+=this.m_invIB*p}else{var C=0;C=0!=this.m_K.col1.x?-x/this.m_K.col1.x:0,this.m_impulse.x+=C,u=C*this.m_perp.x,h=C*this.m_perp.y,c=C*this.m_s1,p=C*this.m_s2,r.x-=this.m_invMassA*u,r.y-=this.m_invMassA*h,s-=this.m_invIA*c,a.x+=this.m_invMassB*u,a.y+=this.m_invMassB*h,l+=this.m_invIB*p}e.m_linearVelocity.SetV(r),e.m_angularVelocity=s,i.m_linearVelocity.SetV(a),i.m_angularVelocity=l},_.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var r,s=this.m_bodyA,a=this.m_bodyB,l=s.m_sweep.c,u=s.m_sweep.a,h=a.m_sweep.c,c=a.m_sweep.a,p=0,d=0,f=0,m=0,_=0,y=0,x=0,v=!1,g=0,b=e.FromAngle(u),w=e.FromAngle(c);r=b;var S=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y;p=r.col1.x*S+r.col2.x*C,C=r.col1.y*S+r.col2.y*C,S=p,r=w;var D=this.m_localAnchor2.x-this.m_localCenterB.x,T=this.m_localAnchor2.y-this.m_localCenterB.y;p=r.col1.x*D+r.col2.x*T,T=r.col1.y*D+r.col2.y*T,D=p;var A=h.x+D-l.x-S,B=h.y+T-l.y-C;if(this.m_enableLimit){this.m_axis=n.MulMV(b,this.m_localXAxis1),this.m_a1=(A+S)*this.m_axis.y-(B+C)*this.m_axis.x,this.m_a2=D*this.m_axis.y-T*this.m_axis.x;var M=this.m_axis.x*A+this.m_axis.y*B;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(g=n.Clamp(M,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),y=n.Abs(M),v=!0):M<=this.m_lowerTranslation?(g=n.Clamp(M-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),y=this.m_lowerTranslation-M,v=!0):M>=this.m_upperTranslation&&(g=n.Clamp(M-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),y=M-this.m_upperTranslation,v=!0)}this.m_perp=n.MulMV(b,this.m_localYAxis1),this.m_s1=(A+S)*this.m_perp.y-(B+C)*this.m_perp.x,this.m_s2=D*this.m_perp.y-T*this.m_perp.x;var E=new o,P=this.m_perp.x*A+this.m_perp.y*B;if(y=n.Max(y,n.Abs(P)),x=0,v)d=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,_=this.m_invIB,this.m_K.col1.x=d+f+m*this.m_s1*this.m_s1+_*this.m_s2*this.m_s2,this.m_K.col1.y=m*this.m_s1*this.m_a1+_*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=d+f+m*this.m_a1*this.m_a1+_*this.m_a2*this.m_a2,this.m_K.Solve(E,-P,-g);else{d=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,_=this.m_invIB;var I=d+f+m*this.m_s1*this.m_s1+_*this.m_s2*this.m_s2,O=0;O=0!=I?-P/I:0,E.x=O,E.y=0}var R=E.x*this.m_perp.x+E.y*this.m_axis.x,L=E.x*this.m_perp.y+E.y*this.m_axis.y,F=E.x*this.m_s1+E.y*this.m_a1,V=E.x*this.m_s2+E.y*this.m_a2;return l.x-=this.m_invMassA*R,l.y-=this.m_invMassA*L,u-=this.m_invIA*F,h.x+=this.m_invMassB*R,h.y+=this.m_invMassB*L,c+=this.m_invIB*V,s.m_sweep.a=u,a.m_sweep.a=c,s.SynchronizeTransform(),a.SynchronizeTransform(),y<=t.b2_linearSlop&&x<=t.b2_angularSlop},Box2D.inherit(y,Box2D.Dynamics.Joints.b2JointDef),y.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,y.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o,this.localAxisA=new o},y.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},y.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n)},Box2D.inherit(x,Box2D.Dynamics.Joints.b2Joint),x.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,x.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.m_localAnchor=new o,this.m_target=new o,this.m_impulse=new o,this.m_mass=new e,this.m_C=new o},x.prototype.GetAnchorA=function(){return this.m_target},x.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},x.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},x.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},x.prototype.GetTarget=function(){return this.m_target},x.prototype.SetTarget=function(t){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t},x.prototype.GetMaxForce=function(){return this.m_maxForce},x.prototype.SetMaxForce=function(t){void 0===t&&(t=0),this.m_maxForce=t},x.prototype.GetFrequency=function(){return this.m_frequencyHz},x.prototype.SetFrequency=function(t){void 0===t&&(t=0),this.m_frequencyHz=t},x.prototype.GetDampingRatio=function(){return this.m_dampingRatio},x.prototype.SetDampingRatio=function(t){void 0===t&&(t=0),this.m_dampingRatio=t},x.prototype.b2MouseJoint=function(t){this.__super.b2Joint.call(this,t),this.m_target.SetV(t.target);var e=this.m_target.x-this.m_bodyB.m_xf.position.x,i=this.m_target.y-this.m_bodyB.m_xf.position.y,n=this.m_bodyB.m_xf.R;this.m_localAnchor.x=e*n.col1.x+i*n.col1.y,this.m_localAnchor.y=e*n.col2.x+i*n.col2.y,this.m_maxForce=t.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0},x.prototype.InitVelocityConstraints=function(t){var e=this.m_bodyB,i=e.GetMass(),n=2*Math.PI*this.m_frequencyHz,o=2*i*this.m_dampingRatio*n,r=i*n*n;this.m_gamma=t.dt*(o+t.dt*r),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*r*this.m_gamma;var s;s=e.m_xf.R;var a=this.m_localAnchor.x-e.m_sweep.localCenter.x,l=this.m_localAnchor.y-e.m_sweep.localCenter.y,u=s.col1.x*a+s.col2.x*l;l=s.col1.y*a+s.col2.y*l,a=u;var h=e.m_invMass,c=e.m_invI;this.K1.col1.x=h,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=h,this.K2.col1.x=c*l*l,this.K2.col2.x=-c*a*l,this.K2.col1.y=-c*a*l,this.K2.col2.y=c*a*a,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+a-this.m_target.x,this.m_C.y=e.m_sweep.c.y+l-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=h*this.m_impulse.x,e.m_linearVelocity.y+=h*this.m_impulse.y,e.m_angularVelocity+=c*(a*this.m_impulse.y-l*this.m_impulse.x)},x.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyB,n=0,o=0;e=i.m_xf.R;var r=this.m_localAnchor.x-i.m_sweep.localCenter.x,s=this.m_localAnchor.y-i.m_sweep.localCenter.y;n=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=n;var a=i.m_linearVelocity.x+-i.m_angularVelocity*s,l=i.m_linearVelocity.y+i.m_angularVelocity*r;e=this.m_mass,n=a+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,o=l+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var u=-(e.col1.x*n+e.col2.x*o),h=-(e.col1.y*n+e.col2.y*o),c=this.m_impulse.x,p=this.m_impulse.y;this.m_impulse.x+=u,this.m_impulse.y+=h;var d=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>d*d&&this.m_impulse.Multiply(d/this.m_impulse.Length()),u=this.m_impulse.x-c,h=this.m_impulse.y-p,i.m_linearVelocity.x+=i.m_invMass*u,i.m_linearVelocity.y+=i.m_invMass*h,i.m_angularVelocity+=i.m_invI*(r*h-s*u)},x.prototype.SolvePositionConstraints=function(t){return void 0===t&&(t=0),!0},Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef),v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,v.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new o},v.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=.7},Box2D.inherit(g,Box2D.Dynamics.Joints.b2Joint),g.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,g.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_localXAxis1=new o,this.m_localYAxis1=new o,this.m_axis=new o,this.m_perp=new o,this.m_K=new i,this.m_impulse=new r},g.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},g.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},g.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),t*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},g.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.y},g.prototype.GetJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.GetWorldPoint(this.m_localAnchor1),n=e.GetWorldPoint(this.m_localAnchor2),o=n.x-i.x,r=n.y-i.y,s=t.GetWorldVector(this.m_localXAxis1),a=s.x*o+s.y*r;return a},g.prototype.GetJointSpeed=function(){var t,e=this.m_bodyA,i=this.m_bodyB;t=e.m_xf.R;var n=this.m_localAnchor1.x-e.m_sweep.localCenter.x,o=this.m_localAnchor1.y-e.m_sweep.localCenter.y,r=t.col1.x*n+t.col2.x*o;o=t.col1.y*n+t.col2.y*o,n=r,t=i.m_xf.R;var s=this.m_localAnchor2.x-i.m_sweep.localCenter.x,a=this.m_localAnchor2.y-i.m_sweep.localCenter.y;r=t.col1.x*s+t.col2.x*a,a=t.col1.y*s+t.col2.y*a,s=r;var l=e.m_sweep.c.x+n,u=e.m_sweep.c.y+o,h=i.m_sweep.c.x+s,c=i.m_sweep.c.y+a,p=h-l,d=c-u,f=e.GetWorldVector(this.m_localXAxis1),m=e.m_linearVelocity,_=i.m_linearVelocity,y=e.m_angularVelocity,x=i.m_angularVelocity,v=p*(-y*f.y)+d*(y*f.x)+(f.x*(_.x+-x*a-m.x- -y*o)+f.y*(_.y+x*s-m.y-y*n));return v},g.prototype.IsLimitEnabled=function(){return this.m_enableLimit},g.prototype.EnableLimit=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t},g.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},g.prototype.GetUpperLimit=function(){return this.m_upperTranslation},g.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e},g.prototype.IsMotorEnabled=function(){return this.m_enableMotor},g.prototype.EnableMotor=function(t){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t},g.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},g.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},g.prototype.SetMaxMotorForce=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t},g.prototype.GetMotorForce=function(){return this.m_motorImpulse},g.prototype.b2PrismaticJoint=function(t){this.__super.b2Joint.call(this,t);this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_localXAxis1.SetV(t.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},g.prototype.InitVelocityConstraints=function(e){var i,o=this.m_bodyA,r=this.m_bodyB,s=0;this.m_localCenterA.SetV(o.GetLocalCenter()),this.m_localCenterB.SetV(r.GetLocalCenter());var a=o.GetTransform();r.GetTransform();i=o.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y;s=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=s,i=r.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,c=this.m_localAnchor2.y-this.m_localCenterB.y;s=i.col1.x*h+i.col2.x*c,c=i.col1.y*h+i.col2.y*c,h=s;var p=r.m_sweep.c.x+h-o.m_sweep.c.x-l,f=r.m_sweep.c.y+c-o.m_sweep.c.y-u;this.m_invMassA=o.m_invMass,this.m_invMassB=r.m_invMass,this.m_invIA=o.m_invI,this.m_invIB=r.m_invI,this.m_axis.SetV(n.MulMV(a.R,this.m_localXAxis1)),this.m_a1=(p+l)*this.m_axis.y-(f+u)*this.m_axis.x,this.m_a2=h*this.m_axis.y-c*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass),this.m_perp.SetV(n.MulMV(a.R,this.m_localYAxis1)),this.m_s1=(p+l)*this.m_perp.y-(f+u)*this.m_perp.x,this.m_s2=h*this.m_perp.y-c*this.m_perp.x;var m=this.m_invMassA,_=this.m_invMassB,y=this.m_invIA,x=this.m_invIB;if(this.m_K.col1.x=m+_+y*this.m_s1*this.m_s1+x*this.m_s2*this.m_s2,this.m_K.col1.y=y*this.m_s1+x*this.m_s2,this.m_K.col1.z=y*this.m_s1*this.m_a1+x*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=y+x,this.m_K.col2.z=y*this.m_a1+x*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+_+y*this.m_a1*this.m_a1+x*this.m_a2*this.m_a2,this.m_enableLimit){var v=this.m_axis.x*p+this.m_axis.y*f;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?this.m_limitState=d.e_equalLimits:v<=this.m_lowerTranslation?this.m_limitState!=d.e_atLowerLimit&&(this.m_limitState=d.e_atLowerLimit,this.m_impulse.z=0):v>=this.m_upperTranslation?this.m_limitState!=d.e_atUpperLimit&&(this.m_limitState=d.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=d.e_inactiveLimit;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var g=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,b=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,w=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,S=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;o.m_linearVelocity.x-=this.m_invMassA*g,o.m_linearVelocity.y-=this.m_invMassA*b,o.m_angularVelocity-=this.m_invIA*w,r.m_linearVelocity.x+=this.m_invMassB*g,r.m_linearVelocity.y+=this.m_invMassB*b,r.m_angularVelocity+=this.m_invIB*S}else this.m_impulse.SetZero(),this.m_motorImpulse=0},g.prototype.SolveVelocityConstraints=function(t){var e=this.m_bodyA,i=this.m_bodyB,s=e.m_linearVelocity,a=e.m_angularVelocity,l=i.m_linearVelocity,u=i.m_angularVelocity,h=0,c=0,p=0,f=0;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var m=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*u-this.m_a1*a,_=this.m_motorMass*(this.m_motorSpeed-m),y=this.m_motorImpulse,x=t.dt*this.m_maxMotorForce;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+_,-x,x),_=this.m_motorImpulse-y,h=_*this.m_axis.x,c=_*this.m_axis.y,p=_*this.m_a1,f=_*this.m_a2,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*c,a-=this.m_invIA*p,l.x+=this.m_invMassB*h,l.y+=this.m_invMassB*c,u+=this.m_invIB*f}var v=this.m_perp.x*(l.x-s.x)+this.m_perp.y*(l.y-s.y)+this.m_s2*u-this.m_s1*a,g=u-a;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var b=this.m_axis.x*(l.x-s.x)+this.m_axis.y*(l.y-s.y)+this.m_a2*u-this.m_a1*a,w=this.m_impulse.Copy(),S=this.m_K.Solve33(new r,-v,-g,-b);this.m_impulse.Add(S),this.m_limitState==d.e_atLowerLimit?this.m_impulse.z=n.Max(this.m_impulse.z,0):this.m_limitState==d.e_atUpperLimit&&(this.m_impulse.z=n.Min(this.m_impulse.z,0));var C=-v-(this.m_impulse.z-w.z)*this.m_K.col3.x,D=-g-(this.m_impulse.z-w.z)*this.m_K.col3.y,T=this.m_K.Solve22(new o,C,D);T.x+=w.x,T.y+=w.y,this.m_impulse.x=T.x,this.m_impulse.y=T.y,S.x=this.m_impulse.x-w.x,S.y=this.m_impulse.y-w.y,S.z=this.m_impulse.z-w.z,h=S.x*this.m_perp.x+S.z*this.m_axis.x,c=S.x*this.m_perp.y+S.z*this.m_axis.y,p=S.x*this.m_s1+S.y+S.z*this.m_a1,f=S.x*this.m_s2+S.y+S.z*this.m_a2,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*c,a-=this.m_invIA*p,l.x+=this.m_invMassB*h,l.y+=this.m_invMassB*c,u+=this.m_invIB*f}else{var A=this.m_K.Solve22(new o,-v,-g);this.m_impulse.x+=A.x,this.m_impulse.y+=A.y,h=A.x*this.m_perp.x,
c=A.x*this.m_perp.y,p=A.x*this.m_s1+A.y,f=A.x*this.m_s2+A.y,s.x-=this.m_invMassA*h,s.y-=this.m_invMassA*c,a-=this.m_invIA*p,l.x+=this.m_invMassB*h,l.y+=this.m_invMassB*c,u+=this.m_invIB*f}e.m_linearVelocity.SetV(s),e.m_angularVelocity=a,i.m_linearVelocity.SetV(l),i.m_angularVelocity=u},g.prototype.SolvePositionConstraints=function(i){void 0===i&&(i=0);var s,a=this.m_bodyA,l=this.m_bodyB,u=a.m_sweep.c,h=a.m_sweep.a,c=l.m_sweep.c,p=l.m_sweep.a,d=0,f=0,m=0,_=0,y=0,x=0,v=0,g=!1,b=0,w=e.FromAngle(h),S=e.FromAngle(p);s=w;var C=this.m_localAnchor1.x-this.m_localCenterA.x,D=this.m_localAnchor1.y-this.m_localCenterA.y;d=s.col1.x*C+s.col2.x*D,D=s.col1.y*C+s.col2.y*D,C=d,s=S;var T=this.m_localAnchor2.x-this.m_localCenterB.x,A=this.m_localAnchor2.y-this.m_localCenterB.y;d=s.col1.x*T+s.col2.x*A,A=s.col1.y*T+s.col2.y*A,T=d;var B=c.x+T-u.x-C,M=c.y+A-u.y-D;if(this.m_enableLimit){this.m_axis=n.MulMV(w,this.m_localXAxis1),this.m_a1=(B+C)*this.m_axis.y-(M+D)*this.m_axis.x,this.m_a2=T*this.m_axis.y-A*this.m_axis.x;var E=this.m_axis.x*B+this.m_axis.y*M;n.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(b=n.Clamp(E,-t.b2_maxLinearCorrection,t.b2_maxLinearCorrection),x=n.Abs(E),g=!0):E<=this.m_lowerTranslation?(b=n.Clamp(E-this.m_lowerTranslation+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),x=this.m_lowerTranslation-E,g=!0):E>=this.m_upperTranslation&&(b=n.Clamp(E-this.m_upperTranslation+t.b2_linearSlop,0,t.b2_maxLinearCorrection),x=E-this.m_upperTranslation,g=!0)}this.m_perp=n.MulMV(w,this.m_localYAxis1),this.m_s1=(B+C)*this.m_perp.y-(M+D)*this.m_perp.x,this.m_s2=T*this.m_perp.y-A*this.m_perp.x;var P=new r,I=this.m_perp.x*B+this.m_perp.y*M,O=p-h-this.m_refAngle;if(x=n.Max(x,n.Abs(I)),v=n.Abs(O),g)f=this.m_invMassA,m=this.m_invMassB,_=this.m_invIA,y=this.m_invIB,this.m_K.col1.x=f+m+_*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,this.m_K.col1.y=_*this.m_s1+y*this.m_s2,this.m_K.col1.z=_*this.m_s1*this.m_a1+y*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=_+y,this.m_K.col2.z=_*this.m_a1+y*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=f+m+_*this.m_a1*this.m_a1+y*this.m_a2*this.m_a2,this.m_K.Solve33(P,-I,-O,-b);else{f=this.m_invMassA,m=this.m_invMassB,_=this.m_invIA,y=this.m_invIB;var R=f+m+_*this.m_s1*this.m_s1+y*this.m_s2*this.m_s2,L=_*this.m_s1+y*this.m_s2,F=_+y;this.m_K.col1.Set(R,L,0),this.m_K.col2.Set(L,F,0);var V=this.m_K.Solve22(new o,-I,-O);P.x=V.x,P.y=V.y,P.z=0}var k=P.x*this.m_perp.x+P.z*this.m_axis.x,G=P.x*this.m_perp.y+P.z*this.m_axis.y,N=P.x*this.m_s1+P.y+P.z*this.m_a1,j=P.x*this.m_s2+P.y+P.z*this.m_a2;return u.x-=this.m_invMassA*k,u.y-=this.m_invMassA*G,h-=this.m_invIA*N,c.x+=this.m_invMassB*k,c.y+=this.m_invMassB*G,p+=this.m_invIB*j,a.m_sweep.a=h,l.m_sweep.a=p,a.SynchronizeTransform(),l.SynchronizeTransform(),x<=t.b2_linearSlop&&v<=t.b2_angularSlop},Box2D.inherit(b,Box2D.Dynamics.Joints.b2JointDef),b.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,b.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o,this.localAxisA=new o},b.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},b.prototype.Initialize=function(t,e,i,n){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.localAxisA=this.bodyA.GetLocalVector(n),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(w,Box2D.Dynamics.Joints.b2Joint),w.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,w.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new o,this.m_groundAnchor2=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_u1=new o,this.m_u2=new o},w.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},w.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},w.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse*this.m_u2.x,t*this.m_impulse*this.m_u2.y)},w.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),0},w.prototype.GetGroundAnchorA=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor1),t},w.prototype.GetGroundAnchorB=function(){var t=this.m_ground.m_xf.position.Copy();return t.Add(this.m_groundAnchor2),t},w.prototype.GetLength1=function(){var t=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},w.prototype.GetLength2=function(){var t=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),e=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,i=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=t.x-e,o=t.y-i;return Math.sqrt(n*n+o*o)},w.prototype.GetRatio=function(){return this.m_ratio},w.prototype.b2PulleyJoint=function(t){this.__super.b2Joint.call(this,t);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=t.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=t.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=t.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=t.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_ratio=t.ratio,this.m_constant=t.lengthA+this.m_ratio*t.lengthB,this.m_maxLength1=n.Min(t.maxLengthA,this.m_constant-this.m_ratio*w.b2_minPulleyLength),this.m_maxLength2=n.Min(t.maxLengthB,(this.m_constant-w.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},w.prototype.InitVelocityConstraints=function(e){var i,n=this.m_bodyA,o=this.m_bodyB;i=n.m_xf.R;var r=this.m_localAnchor1.x-n.m_sweep.localCenter.x,s=this.m_localAnchor1.y-n.m_sweep.localCenter.y,a=i.col1.x*r+i.col2.x*s;s=i.col1.y*r+i.col2.y*s,r=a,i=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;a=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=a;var h=n.m_sweep.c.x+r,c=n.m_sweep.c.y+s,p=o.m_sweep.c.x+l,f=o.m_sweep.c.y+u,m=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,_=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,y=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,x=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(h-m,c-_),this.m_u2.Set(p-y,f-x);var v=this.m_u1.Length(),g=this.m_u2.Length();v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),g>t.b2_linearSlop?this.m_u2.Multiply(1/g):this.m_u2.SetZero();var b=this.m_constant-v-this.m_ratio*g;b>0?(this.m_state=d.e_inactiveLimit,this.m_impulse=0):this.m_state=d.e_atUpperLimit,v<this.m_maxLength1?(this.m_limitState1=d.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=d.e_atUpperLimit,g<this.m_maxLength2?(this.m_limitState2=d.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=d.e_atUpperLimit;var w=r*this.m_u1.y-s*this.m_u1.x,S=l*this.m_u2.y-u*this.m_u2.x;if(this.m_limitMass1=n.m_invMass+n.m_invI*w*w,this.m_limitMass2=o.m_invMass+o.m_invI*S*S,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,e.warmStarting){this.m_impulse*=e.dtRatio,this.m_limitImpulse1*=e.dtRatio,this.m_limitImpulse2*=e.dtRatio;var C=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,D=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,T=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,A=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;n.m_linearVelocity.x+=n.m_invMass*C,n.m_linearVelocity.y+=n.m_invMass*D,n.m_angularVelocity+=n.m_invI*(r*D-s*C),o.m_linearVelocity.x+=o.m_invMass*T,o.m_linearVelocity.y+=o.m_invMass*A,o.m_angularVelocity+=o.m_invI*(l*A-u*T)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},w.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,o=this.m_bodyB;e=i.m_xf.R;var r=this.m_localAnchor1.x-i.m_sweep.localCenter.x,s=this.m_localAnchor1.y-i.m_sweep.localCenter.y,a=e.col1.x*r+e.col2.x*s;s=e.col1.y*r+e.col2.y*s,r=a,e=o.m_xf.R;var l=this.m_localAnchor2.x-o.m_sweep.localCenter.x,u=this.m_localAnchor2.y-o.m_sweep.localCenter.y;a=e.col1.x*l+e.col2.x*u,u=e.col1.y*l+e.col2.y*u,l=a;var h=0,c=0,p=0,f=0,m=0,_=0,y=0,x=0,v=0,g=0,b=0;this.m_state==d.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*s,c=i.m_linearVelocity.y+i.m_angularVelocity*r,p=o.m_linearVelocity.x+-o.m_angularVelocity*u,f=o.m_linearVelocity.y+o.m_angularVelocity*l,v=-(this.m_u1.x*h+this.m_u1.y*c)-this.m_ratio*(this.m_u2.x*p+this.m_u2.y*f),g=this.m_pulleyMass*-v,b=this.m_impulse,this.m_impulse=n.Max(0,this.m_impulse+g),g=this.m_impulse-b,m=-g*this.m_u1.x,_=-g*this.m_u1.y,y=-this.m_ratio*g*this.m_u2.x,x=-this.m_ratio*g*this.m_u2.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*_,i.m_angularVelocity+=i.m_invI*(r*_-s*m),o.m_linearVelocity.x+=o.m_invMass*y,o.m_linearVelocity.y+=o.m_invMass*x,o.m_angularVelocity+=o.m_invI*(l*x-u*y)),this.m_limitState1==d.e_atUpperLimit&&(h=i.m_linearVelocity.x+-i.m_angularVelocity*s,c=i.m_linearVelocity.y+i.m_angularVelocity*r,v=-(this.m_u1.x*h+this.m_u1.y*c),g=-this.m_limitMass1*v,b=this.m_limitImpulse1,this.m_limitImpulse1=n.Max(0,this.m_limitImpulse1+g),g=this.m_limitImpulse1-b,m=-g*this.m_u1.x,_=-g*this.m_u1.y,i.m_linearVelocity.x+=i.m_invMass*m,i.m_linearVelocity.y+=i.m_invMass*_,i.m_angularVelocity+=i.m_invI*(r*_-s*m)),this.m_limitState2==d.e_atUpperLimit&&(p=o.m_linearVelocity.x+-o.m_angularVelocity*u,f=o.m_linearVelocity.y+o.m_angularVelocity*l,v=-(this.m_u2.x*p+this.m_u2.y*f),g=-this.m_limitMass2*v,b=this.m_limitImpulse2,this.m_limitImpulse2=n.Max(0,this.m_limitImpulse2+g),g=this.m_limitImpulse2-b,y=-g*this.m_u2.x,x=-g*this.m_u2.y,o.m_linearVelocity.x+=o.m_invMass*y,o.m_linearVelocity.y+=o.m_invMass*x,o.m_angularVelocity+=o.m_invI*(l*x-u*y))},w.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,o=this.m_bodyA,r=this.m_bodyB,s=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,a=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,l=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,u=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,h=0,c=0,p=0,f=0,m=0,_=0,y=0,x=0,v=0,g=0,b=0,w=0,S=0,C=0;return this.m_state==d.e_atUpperLimit&&(i=o.m_xf.R,h=this.m_localAnchor1.x-o.m_sweep.localCenter.x,c=this.m_localAnchor1.y-o.m_sweep.localCenter.y,S=i.col1.x*h+i.col2.x*c,c=i.col1.y*h+i.col2.y*c,h=S,i=r.m_xf.R,p=this.m_localAnchor2.x-r.m_sweep.localCenter.x,f=this.m_localAnchor2.y-r.m_sweep.localCenter.y,S=i.col1.x*p+i.col2.x*f,f=i.col1.y*p+i.col2.y*f,p=S,m=o.m_sweep.c.x+h,_=o.m_sweep.c.y+c,y=r.m_sweep.c.x+p,x=r.m_sweep.c.y+f,this.m_u1.Set(m-s,_-a),this.m_u2.Set(y-l,x-u),v=this.m_u1.Length(),g=this.m_u2.Length(),v>t.b2_linearSlop?this.m_u1.Multiply(1/v):this.m_u1.SetZero(),g>t.b2_linearSlop?this.m_u2.Multiply(1/g):this.m_u2.SetZero(),b=this.m_constant-v-this.m_ratio*g,C=n.Max(C,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_pulleyMass*b,m=-w*this.m_u1.x,_=-w*this.m_u1.y,y=-this.m_ratio*w*this.m_u2.x,x=-this.m_ratio*w*this.m_u2.y,o.m_sweep.c.x+=o.m_invMass*m,o.m_sweep.c.y+=o.m_invMass*_,o.m_sweep.a+=o.m_invI*(h*_-c*m),r.m_sweep.c.x+=r.m_invMass*y,r.m_sweep.c.y+=r.m_invMass*x,r.m_sweep.a+=r.m_invI*(p*x-f*y),o.SynchronizeTransform(),r.SynchronizeTransform()),this.m_limitState1==d.e_atUpperLimit&&(i=o.m_xf.R,h=this.m_localAnchor1.x-o.m_sweep.localCenter.x,c=this.m_localAnchor1.y-o.m_sweep.localCenter.y,S=i.col1.x*h+i.col2.x*c,c=i.col1.y*h+i.col2.y*c,h=S,m=o.m_sweep.c.x+h,_=o.m_sweep.c.y+c,this.m_u1.Set(m-s,_-a),v=this.m_u1.Length(),v>t.b2_linearSlop?(this.m_u1.x*=1/v,this.m_u1.y*=1/v):this.m_u1.SetZero(),b=this.m_maxLength1-v,C=n.Max(C,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_limitMass1*b,m=-w*this.m_u1.x,_=-w*this.m_u1.y,o.m_sweep.c.x+=o.m_invMass*m,o.m_sweep.c.y+=o.m_invMass*_,o.m_sweep.a+=o.m_invI*(h*_-c*m),o.SynchronizeTransform()),this.m_limitState2==d.e_atUpperLimit&&(i=r.m_xf.R,p=this.m_localAnchor2.x-r.m_sweep.localCenter.x,f=this.m_localAnchor2.y-r.m_sweep.localCenter.y,S=i.col1.x*p+i.col2.x*f,f=i.col1.y*p+i.col2.y*f,p=S,y=r.m_sweep.c.x+p,x=r.m_sweep.c.y+f,this.m_u2.Set(y-l,x-u),g=this.m_u2.Length(),g>t.b2_linearSlop?(this.m_u2.x*=1/g,this.m_u2.y*=1/g):this.m_u2.SetZero(),b=this.m_maxLength2-g,C=n.Max(C,-b),b=n.Clamp(b+t.b2_linearSlop,-t.b2_maxLinearCorrection,0),w=-this.m_limitMass2*b,y=-w*this.m_u2.x,x=-w*this.m_u2.y,r.m_sweep.c.x+=r.m_invMass*y,r.m_sweep.c.y+=r.m_invMass*x,r.m_sweep.a+=r.m_invI*(p*x-f*y),r.SynchronizeTransform()),C<t.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(S,Box2D.Dynamics.Joints.b2JointDef),S.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,S.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new o,this.groundAnchorB=new o,this.localAnchorA=new o,this.localAnchorB=new o},S.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},S.prototype.Initialize=function(t,e,i,n,o,r,s){void 0===s&&(s=0),this.bodyA=t,this.bodyB=e,this.groundAnchorA.SetV(i),this.groundAnchorB.SetV(n),this.localAnchorA=this.bodyA.GetLocalPoint(o),this.localAnchorB=this.bodyB.GetLocalPoint(r);var a=o.x-i.x,l=o.y-i.y;this.lengthA=Math.sqrt(a*a+l*l);var u=r.x-n.x,h=r.y-n.y;this.lengthB=Math.sqrt(u*u+h*h),this.ratio=s;var c=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=c-this.ratio*w.b2_minPulleyLength,this.maxLengthB=(c-w.b2_minPulleyLength)/this.ratio},Box2D.inherit(C,Box2D.Dynamics.Joints.b2Joint),C.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,C.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new e,this.K1=new e,this.K2=new e,this.K3=new e,this.impulse3=new r,this.impulse2=new o,this.reduced=new o,this.m_localAnchor1=new o,this.m_localAnchor2=new o,this.m_impulse=new r,this.m_mass=new i},C.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},C.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},C.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},C.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},C.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},C.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},C.prototype.IsLimitEnabled=function(){return this.m_enableLimit};C.prototype.EnableLimit=function(t){this.m_enableLimit=t};C.prototype.GetLowerLimit=function(){return this.m_lowerAngle},C.prototype.GetUpperLimit=function(){return this.m_upperAngle},C.prototype.SetLimits=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.m_lowerAngle=t,this.m_upperAngle=e},C.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},C.prototype.EnableMotor=function(t){this.m_enableMotor=t},C.prototype.SetMotorSpeed=function(t){void 0===t&&(t=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t},C.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},C.prototype.SetMaxMotorTorque=function(t){void 0===t&&(t=0),this.m_maxMotorTorque=t},C.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},C.prototype.b2RevoluteJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchor1.SetV(t.localAnchorA),this.m_localAnchor2.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=d.e_inactiveLimit},C.prototype.InitVelocityConstraints=function(e){var i,o=this.m_bodyA,r=this.m_bodyB,s=0;this.m_enableMotor||this.m_enableLimit,i=o.m_xf.R;var a=this.m_localAnchor1.x-o.m_sweep.localCenter.x,l=this.m_localAnchor1.y-o.m_sweep.localCenter.y;s=i.col1.x*a+i.col2.x*l,l=i.col1.y*a+i.col2.y*l,a=s,i=r.m_xf.R;var u=this.m_localAnchor2.x-r.m_sweep.localCenter.x,h=this.m_localAnchor2.y-r.m_sweep.localCenter.y;s=i.col1.x*u+i.col2.x*h,h=i.col1.y*u+i.col2.y*h,u=s;var c=o.m_invMass,p=r.m_invMass,f=o.m_invI,m=r.m_invI;if(this.m_mass.col1.x=c+p+l*l*f+h*h*m,this.m_mass.col2.x=-l*a*f-h*u*m,this.m_mass.col3.x=-l*f-h*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=c+p+a*a*f+u*u*m,this.m_mass.col3.y=a*f+u*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+m,this.m_motorMass=1/(f+m),0==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var _=r.m_sweep.a-o.m_sweep.a-this.m_referenceAngle;n.Abs(this.m_upperAngle-this.m_lowerAngle)<2*t.b2_angularSlop?this.m_limitState=d.e_equalLimits:_<=this.m_lowerAngle?(this.m_limitState!=d.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=d.e_atLowerLimit):_>=this.m_upperAngle?(this.m_limitState!=d.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=d.e_atUpperLimit):(this.m_limitState=d.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=d.e_inactiveLimit;if(e.warmStarting){this.m_impulse.x*=e.dtRatio,this.m_impulse.y*=e.dtRatio,this.m_motorImpulse*=e.dtRatio;var y=this.m_impulse.x,x=this.m_impulse.y;o.m_linearVelocity.x-=c*y,o.m_linearVelocity.y-=c*x,o.m_angularVelocity-=f*(a*x-l*y+this.m_motorImpulse+this.m_impulse.z),r.m_linearVelocity.x+=p*y,r.m_linearVelocity.y+=p*x,r.m_angularVelocity+=m*(u*x-h*y+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},C.prototype.SolveVelocityConstraints=function(t){var e,i=this.m_bodyA,o=this.m_bodyB,r=0,s=0,a=0,l=0,u=0,h=0,c=i.m_linearVelocity,p=i.m_angularVelocity,f=o.m_linearVelocity,m=o.m_angularVelocity,_=i.m_invMass,y=o.m_invMass,x=i.m_invI,v=o.m_invI;if(this.m_enableMotor&&this.m_limitState!=d.e_equalLimits){var g=m-p-this.m_motorSpeed,b=this.m_motorMass*-g,w=this.m_motorImpulse,S=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=n.Clamp(this.m_motorImpulse+b,-S,S),b=this.m_motorImpulse-w,p-=x*b,m+=v*b}if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){e=i.m_xf.R,a=this.m_localAnchor1.x-i.m_sweep.localCenter.x,l=this.m_localAnchor1.y-i.m_sweep.localCenter.y,r=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=r,e=o.m_xf.R,u=this.m_localAnchor2.x-o.m_sweep.localCenter.x,h=this.m_localAnchor2.y-o.m_sweep.localCenter.y,r=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=r;var C=f.x+-m*h-c.x- -p*l,D=f.y+m*u-c.y-p*a,T=m-p;this.m_mass.Solve33(this.impulse3,-C,-D,-T),this.m_limitState==d.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==d.e_atLowerLimit?(s=this.m_impulse.z+this.impulse3.z,s<0&&(this.m_mass.Solve22(this.reduced,-C,-D),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==d.e_atUpperLimit&&(s=this.m_impulse.z+this.impulse3.z,s>0&&(this.m_mass.Solve22(this.reduced,-C,-D),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),c.x-=_*this.impulse3.x,c.y-=_*this.impulse3.y,p-=x*(a*this.impulse3.y-l*this.impulse3.x+this.impulse3.z),f.x+=y*this.impulse3.x,f.y+=y*this.impulse3.y,m+=v*(u*this.impulse3.y-h*this.impulse3.x+this.impulse3.z)}else{e=i.m_xf.R,a=this.m_localAnchor1.x-i.m_sweep.localCenter.x,l=this.m_localAnchor1.y-i.m_sweep.localCenter.y,r=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=r,e=o.m_xf.R,u=this.m_localAnchor2.x-o.m_sweep.localCenter.x,h=this.m_localAnchor2.y-o.m_sweep.localCenter.y,r=e.col1.x*u+e.col2.x*h,h=e.col1.y*u+e.col2.y*h,u=r;var A=f.x+-m*h-c.x- -p*l,B=f.y+m*u-c.y-p*a;this.m_mass.Solve22(this.impulse2,-A,-B),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,c.x-=_*this.impulse2.x,c.y-=_*this.impulse2.y,p-=x*(a*this.impulse2.y-l*this.impulse2.x),f.x+=y*this.impulse2.x,f.y+=y*this.impulse2.y,m+=v*(u*this.impulse2.y-h*this.impulse2.x)}i.m_linearVelocity.SetV(c),i.m_angularVelocity=p,o.m_linearVelocity.SetV(f),o.m_angularVelocity=m},C.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,o=0,r=this.m_bodyA,s=this.m_bodyB,a=0,l=0,u=0,h=0,c=0;if(this.m_enableLimit&&this.m_limitState!=d.e_inactiveLimit){var p=s.m_sweep.a-r.m_sweep.a-this.m_referenceAngle,f=0;this.m_limitState==d.e_equalLimits?(o=n.Clamp(p-this.m_lowerAngle,-t.b2_maxAngularCorrection,t.b2_maxAngularCorrection),f=-this.m_motorMass*o,a=n.Abs(o)):this.m_limitState==d.e_atLowerLimit?(o=p-this.m_lowerAngle,a=-o,o=n.Clamp(o+t.b2_angularSlop,-t.b2_maxAngularCorrection,0),f=-this.m_motorMass*o):this.m_limitState==d.e_atUpperLimit&&(o=p-this.m_upperAngle,a=o,o=n.Clamp(o-t.b2_angularSlop,0,t.b2_maxAngularCorrection),f=-this.m_motorMass*o),r.m_sweep.a-=r.m_invI*f,s.m_sweep.a+=s.m_invI*f,r.SynchronizeTransform(),s.SynchronizeTransform()}i=r.m_xf.R;var m=this.m_localAnchor1.x-r.m_sweep.localCenter.x,_=this.m_localAnchor1.y-r.m_sweep.localCenter.y;u=i.col1.x*m+i.col2.x*_,_=i.col1.y*m+i.col2.y*_,m=u,i=s.m_xf.R;var y=this.m_localAnchor2.x-s.m_sweep.localCenter.x,x=this.m_localAnchor2.y-s.m_sweep.localCenter.y;u=i.col1.x*y+i.col2.x*x,x=i.col1.y*y+i.col2.y*x,y=u;var v=s.m_sweep.c.x+y-r.m_sweep.c.x-m,g=s.m_sweep.c.y+x-r.m_sweep.c.y-_,b=v*v+g*g,w=Math.sqrt(b);l=w;var S=r.m_invMass,D=s.m_invMass,T=r.m_invI,A=s.m_invI,B=10*t.b2_linearSlop;if(b>B*B){var M=S+D,E=1/M;h=E*-v,c=E*-g;var P=.5;r.m_sweep.c.x-=P*S*h,r.m_sweep.c.y-=P*S*c,s.m_sweep.c.x+=P*D*h,s.m_sweep.c.y+=P*D*c,v=s.m_sweep.c.x+y-r.m_sweep.c.x-m,g=s.m_sweep.c.y+x-r.m_sweep.c.y-_}return this.K1.col1.x=S+D,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=S+D,this.K2.col1.x=T*_*_,this.K2.col2.x=-T*m*_,this.K2.col1.y=-T*m*_,this.K2.col2.y=T*m*m,this.K3.col1.x=A*x*x,this.K3.col2.x=-A*y*x,this.K3.col1.y=-A*y*x,this.K3.col2.y=A*y*y,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(C.tImpulse,-v,-g),h=C.tImpulse.x,c=C.tImpulse.y,r.m_sweep.c.x-=r.m_invMass*h,r.m_sweep.c.y-=r.m_invMass*c,r.m_sweep.a-=r.m_invI*(m*c-_*h),s.m_sweep.c.x+=s.m_invMass*h,s.m_sweep.c.y+=s.m_invMass*c,s.m_sweep.a+=s.m_invI*(y*c-x*h),r.SynchronizeTransform(),s.SynchronizeTransform(),l<=t.b2_linearSlop&&a<=t.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new o}),Box2D.inherit(D,Box2D.Dynamics.Joints.b2JointDef),D.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,D.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},D.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},D.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA=this.bodyA.GetLocalPoint(i),this.localAnchorB=this.bodyB.GetLocalPoint(i),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(T,Box2D.Dynamics.Joints.b2Joint),T.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,T.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new o,this.m_localAnchorB=new o,this.m_impulse=new r,this.m_mass=new i},T.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},T.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},T.prototype.GetReactionForce=function(t){return void 0===t&&(t=0),new o(t*this.m_impulse.x,t*this.m_impulse.y)},T.prototype.GetReactionTorque=function(t){return void 0===t&&(t=0),t*this.m_impulse.z},T.prototype.b2WeldJoint=function(t){this.__super.b2Joint.call(this,t),this.m_localAnchorA.SetV(t.localAnchorA),this.m_localAnchorB.SetV(t.localAnchorB),this.m_referenceAngle=t.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new i},T.prototype.InitVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB;e=n.m_xf.R;var r=this.m_localAnchorA.x-n.m_sweep.localCenter.x,s=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*r+e.col2.x*s,s=e.col1.y*r+e.col2.y*s,r=i,e=o.m_xf.R;var a=this.m_localAnchorB.x-o.m_sweep.localCenter.x,l=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*a+e.col2.x*l,l=e.col1.y*a+e.col2.y*l,a=i;var u=n.m_invMass,h=o.m_invMass,c=n.m_invI,p=o.m_invI;this.m_mass.col1.x=u+h+s*s*c+l*l*p,this.m_mass.col2.x=-s*r*c-l*a*p,this.m_mass.col3.x=-s*c-l*p,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=u+h+r*r*c+a*a*p,this.m_mass.col3.y=r*c+a*p,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=c+p,t.warmStarting?(this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,this.m_impulse.z*=t.dtRatio,n.m_linearVelocity.x-=u*this.m_impulse.x,n.m_linearVelocity.y-=u*this.m_impulse.y,n.m_angularVelocity-=c*(r*this.m_impulse.y-s*this.m_impulse.x+this.m_impulse.z),o.m_linearVelocity.x+=h*this.m_impulse.x,o.m_linearVelocity.y+=h*this.m_impulse.y,o.m_angularVelocity+=p*(a*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},T.prototype.SolveVelocityConstraints=function(t){var e,i=0,n=this.m_bodyA,o=this.m_bodyB,s=n.m_linearVelocity,a=n.m_angularVelocity,l=o.m_linearVelocity,u=o.m_angularVelocity,h=n.m_invMass,c=o.m_invMass,p=n.m_invI,d=o.m_invI;e=n.m_xf.R;var f=this.m_localAnchorA.x-n.m_sweep.localCenter.x,m=this.m_localAnchorA.y-n.m_sweep.localCenter.y;i=e.col1.x*f+e.col2.x*m,m=e.col1.y*f+e.col2.y*m,f=i,e=o.m_xf.R;var _=this.m_localAnchorB.x-o.m_sweep.localCenter.x,y=this.m_localAnchorB.y-o.m_sweep.localCenter.y;i=e.col1.x*_+e.col2.x*y,y=e.col1.y*_+e.col2.y*y,_=i;var x=l.x-u*y-s.x+a*m,v=l.y+u*_-s.y-a*f,g=u-a,b=new r;this.m_mass.Solve33(b,-x,-v,-g),this.m_impulse.Add(b),s.x-=h*b.x,s.y-=h*b.y,a-=p*(f*b.y-m*b.x+b.z),l.x+=c*b.x,l.y+=c*b.y,u+=d*(_*b.y-y*b.x+b.z),n.m_angularVelocity=a,o.m_angularVelocity=u},T.prototype.SolvePositionConstraints=function(e){void 0===e&&(e=0);var i,o=0,s=this.m_bodyA,a=this.m_bodyB;i=s.m_xf.R;var l=this.m_localAnchorA.x-s.m_sweep.localCenter.x,u=this.m_localAnchorA.y-s.m_sweep.localCenter.y;o=i.col1.x*l+i.col2.x*u,u=i.col1.y*l+i.col2.y*u,l=o,i=a.m_xf.R;var h=this.m_localAnchorB.x-a.m_sweep.localCenter.x,c=this.m_localAnchorB.y-a.m_sweep.localCenter.y;o=i.col1.x*h+i.col2.x*c,c=i.col1.y*h+i.col2.y*c,h=o;var p=s.m_invMass,d=a.m_invMass,f=s.m_invI,m=a.m_invI,_=a.m_sweep.c.x+h-s.m_sweep.c.x-l,y=a.m_sweep.c.y+c-s.m_sweep.c.y-u,x=a.m_sweep.a-s.m_sweep.a-this.m_referenceAngle,v=10*t.b2_linearSlop,g=Math.sqrt(_*_+y*y),b=n.Abs(x);g>v&&(f*=1,m*=1),this.m_mass.col1.x=p+d+u*u*f+c*c*m,this.m_mass.col2.x=-u*l*f-c*h*m,this.m_mass.col3.x=-u*f-c*m,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=p+d+l*l*f+h*h*m,this.m_mass.col3.y=l*f+h*m,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=f+m;var w=new r;return this.m_mass.Solve33(w,-_,-y,-x),s.m_sweep.c.x-=p*w.x,s.m_sweep.c.y-=p*w.y,s.m_sweep.a-=f*(l*w.y-u*w.x+w.z),a.m_sweep.c.x+=d*w.x,a.m_sweep.c.y+=d*w.y,a.m_sweep.a+=m*(h*w.y-c*w.x+w.z),s.SynchronizeTransform(),a.SynchronizeTransform(),g<=t.b2_linearSlop&&b<=t.b2_angularSlop},Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef),A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,A.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new o,this.localAnchorB=new o},A.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=d.e_weldJoint,this.referenceAngle=0},A.prototype.Initialize=function(t,e,i){this.bodyA=t,this.bodyB=e,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(i)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(i)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var t=Box2D.Dynamics.b2DebugDraw;t.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var t=this;this.m_sprite={graphics:{clear:function(){t.m_ctx.clearRect(0,0,t.m_ctx.canvas.width,t.m_ctx.canvas.height)}}}},t.prototype._color=function(t,e){return"rgba("+((16711680&t)>>16)+","+((65280&t)>>8)+","+(255&t)+","+e+")"},t.prototype.b2DebugDraw=function(){this.m_drawFlags=0},t.prototype.SetFlags=function(t){void 0===t&&(t=0),this.m_drawFlags=t},t.prototype.GetFlags=function(){return this.m_drawFlags},t.prototype.AppendFlags=function(t){void 0===t&&(t=0),this.m_drawFlags|=t},t.prototype.ClearFlags=function(t){void 0===t&&(t=0),this.m_drawFlags&=~t},t.prototype.SetSprite=function(t){this.m_ctx=t},t.prototype.GetSprite=function(){return this.m_ctx},t.prototype.SetDrawScale=function(t){void 0===t&&(t=0),this.m_drawScale=t},t.prototype.GetDrawScale=function(){return this.m_drawScale},t.prototype.SetLineThickness=function(t){void 0===t&&(t=0),this.m_lineThickness=t,this.m_ctx.strokeWidth=t},t.prototype.GetLineThickness=function(){return this.m_lineThickness},t.prototype.SetAlpha=function(t){void 0===t&&(t=0),this.m_alpha=t},t.prototype.GetAlpha=function(){return this.m_alpha},t.prototype.SetFillAlpha=function(t){void 0===t&&(t=0),this.m_fillAlpha=t},t.prototype.GetFillAlpha=function(){return this.m_fillAlpha},t.prototype.SetXFormScale=function(t){void 0===t&&(t=0),this.m_xformScale=t},t.prototype.GetXFormScale=function(){return this.m_xformScale},t.prototype.DrawPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.stroke()}},t.prototype.DrawSolidPolygon=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.fillStyle=this._color(i.color,this.m_fillAlpha),n.moveTo(t[0].x*o,t[0].y*o);for(var r=1;r<e;r++)n.lineTo(t[r].x*o,t[r].y*o);n.lineTo(t[0].x*o,t[0].y*o),n.closePath(),n.fill(),n.stroke()}},t.prototype.DrawCircle=function(t,e,i){if(e){var n=this.m_ctx,o=this.m_drawScale;n.beginPath(),n.strokeStyle=this._color(i.color,this.m_alpha),n.arc(t.x*o,t.y*o,e*o,0,2*Math.PI,!0),n.closePath(),n.stroke()}},t.prototype.DrawSolidCircle=function(t,e,i,n){if(e){var o=this.m_ctx,r=this.m_drawScale,s=t.x*r,a=t.y*r;o.moveTo(0,0),o.beginPath(),o.strokeStyle=this._color(n.color,this.m_alpha),o.fillStyle=this._color(n.color,this.m_fillAlpha),o.arc(s,a,e*r,0,2*Math.PI,!0),o.moveTo(s,a),o.lineTo((t.x+i.x*e)*r,(t.y+i.y*e)*r),o.closePath(),o.fill(),o.stroke()}},t.prototype.DrawSegment=function(t,e,i){var n=this.m_ctx,o=this.m_drawScale;n.strokeStyle=this._color(i.color,this.m_alpha),n.beginPath(),n.moveTo(t.x*o,t.y*o),n.lineTo(e.x*o,e.y*o),n.closePath(),n.stroke()},t.prototype.DrawTransform=function(t){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),
e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs,"undefined"!=typeof window&&(window.Box2D=Box2D||{}),function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.mobileAutoEnable=!0,t._setup(),t},volume:function(t){var i=this||e;if(t=parseFloat(t),i.ctx||u(),"undefined"!=typeof t&&t>=0&&t<=1){if(i._volume=t,i._muted)return i;i.usingWebAudio&&(i.masterGain.gain.value=t);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),r=0;r<o.length;r++){var s=i._howls[n]._soundById(o[r]);s&&s._node&&(s._node.volume=s._volume*t)}return i}return i._volume},mute:function(t){var i=this||e;i.ctx||u(),i._muted=t,i.usingWebAudio&&(i.masterGain.gain.value=t?0:i._volume);for(var n=0;n<i._howls.length;n++)if(!i._howls[n]._webAudio)for(var o=i._howls[n]._getSoundIds(),r=0;r<o.length;r++){var s=i._howls[n]._soundById(o[r]);s&&s._node&&(s._node.muted=!!t||s._muted)}return i},unload:function(){for(var t=this||e,i=t._howls.length-1;i>=0;i--)t._howls[i].unload();return t.usingWebAudio&&t.ctx&&"undefined"!=typeof t.ctx.close&&(t.ctx.close(),t.ctx=null,u()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx?t.ctx.state||"running":"running",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{var i=new Audio;"undefined"==typeof i.oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{var i=new Audio;i.muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!i||"function"!=typeof i.canPlayType)return t;var n=i.canPlayType("audio/mpeg;").replace(/^no$/,""),o=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33;return t._codecs={mp3:!(r||!n&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_enableMobileAudio:function(){var t=this||e,i=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(t._navigator&&t._navigator.userAgent),n=!!("ontouchend"in window||t._navigator&&t._navigator.maxTouchPoints>0||t._navigator&&t._navigator.msMaxTouchPoints>0);if(!t._mobileEnabled&&t.ctx&&(i||n)){t._mobileEnabled=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var o=function(){var e=t.ctx.createBufferSource();e.buffer=t._scratchBuffer,e.connect(t.ctx.destination),"undefined"==typeof e.start?e.noteOn(0):e.start(0),e.onended=function(){e.disconnect(0),t._mobileEnabled=!0,t.mobileAutoEnable=!1,document.removeEventListener("touchend",o,!0)}};return document.addEventListener("touchend",o,!0),t}},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&"undefined"!=typeof t.ctx.suspend&&e.usingWebAudio){for(var i=0;i<t._howls.length;i++)if(t._howls[i]._webAudio)for(var n=0;n<t._howls[i]._sounds.length;n++)if(!t._howls[i]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){t.autoSuspend&&(t._suspendTimer=null,t.state="suspending",t.ctx.suspend().then(function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())}))},3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&"undefined"!=typeof t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.state="resuming",t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,i=function(t){var e=this;return t.src&&0!==t.src.length?void e.init(t):void console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(t){var i=this;return e.ctx||u(),i._autoplay=t.autoplay||!1,i._format="string"!=typeof t.format?t.format:[t.format],i._html5=t.html5||!1,i._muted=t.mute||!1,i._loop=t.loop||!1,i._pool=t.pool||5,i._preload="boolean"!=typeof t.preload||t.preload,i._rate=t.rate||1,i._sprite=t.sprite||{},i._src="string"!=typeof t.src?t.src:[t.src],i._volume=void 0!==t.volume?t.volume:1,i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._onend=t.onend?[{fn:t.onend}]:[],i._onfade=t.onfade?[{fn:t.onfade}]:[],i._onload=t.onload?[{fn:t.onload}]:[],i._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],i._onpause=t.onpause?[{fn:t.onpause}]:[],i._onplay=t.onplay?[{fn:t.onplay}]:[],i._onstop=t.onstop?[{fn:t.onstop}]:[],i._onmute=t.onmute?[{fn:t.onmute}]:[],i._onvolume=t.onvolume?[{fn:t.onvolume}]:[],i._onrate=t.onrate?[{fn:t.onrate}]:[],i._onseek=t.onseek?[{fn:t.onseek}]:[],i._onresume=[],i._webAudio=e.usingWebAudio&&!i._html5,"undefined"!=typeof e.ctx&&e.ctx&&e.mobileAutoEnable&&e._enableMobileAudio(),e._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i.load(),i},load:function(){var t=this,i=null;if(e.noAudio)return void t._emit("loaderror",null,"No audio support.");"string"==typeof t._src&&(t._src=[t._src]);for(var o=0;o<t._src.length;o++){var s,a;if(t._format&&t._format[o])s=t._format[o];else{if(a=t._src[o],"string"!=typeof a){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(a),s||(s=/\.([^.]+)$/.exec(a.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(e.codecs(s)){i=t._src[o];break}}return i?(t._src=i,t._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new n(t),t._webAudio&&r(t),t):void t._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(t,i){var n=this,o=null;if("number"==typeof t)o=t,t=null;else{if("string"==typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if("undefined"==typeof t){t="__default";for(var r=0,s=0;s<n._sounds.length;s++)n._sounds[s]._paused&&!n._sounds[s]._ended&&(r++,o=n._sounds[s]._id);1===r?t=null:o=null}}var a=o?n._soundById(o):n._inactiveSound();if(!a)return null;if(o&&!t&&(t=a._sprite||"__default"),"loaded"!==n._state&&!n._sprite[t])return n._queue.push({event:"play",action:function(){n.play(n._soundById(a._id)?a._id:void 0)}}),a._id;if(o&&!a._paused)return i||setTimeout(function(){n._emit("play",a._id)},0),a._id;n._webAudio&&e._autoResume();var l=Math.max(0,a._seek>0?a._seek:n._sprite[t][0]/1e3),u=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-l),h=1e3*u/Math.abs(a._rate);a._paused=!1,a._ended=!1,a._sprite=t,a._seek=l,a._start=n._sprite[t][0]/1e3,a._stop=(n._sprite[t][0]+n._sprite[t][1])/1e3,a._loop=!(!a._loop&&!n._sprite[t][2]);var c=a._node;if(n._webAudio){var p=function(){n._refreshBuffer(a);var t=a._muted||n._muted?0:a._volume;c.gain.setValueAtTime(t,e.ctx.currentTime),a._playStart=e.ctx.currentTime,"undefined"==typeof c.bufferSource.start?a._loop?c.bufferSource.noteGrainOn(0,l,86400):c.bufferSource.noteGrainOn(0,l,u):a._loop?c.bufferSource.start(0,l,86400):c.bufferSource.start(0,l,u),h!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h)),i||setTimeout(function(){n._emit("play",a._id)},0)},d="running"===e.state;"loaded"===n._state&&d?p():(n.once(d?"load":"resume",p,d?a._id:null),n._clearTimer(a._id))}else{var f=function(){c.currentTime=l,c.muted=a._muted||n._muted||e._muted||c.muted,c.volume=a._volume*e.volume(),c.playbackRate=a._rate,setTimeout(function(){c.play(),h!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),h)),i||n._emit("play",a._id)},0)},m="loaded"===n._state&&(window&&window.ejecta||!c.readyState&&e._navigator.isCocoonJS);if(4===c.readyState||m)f();else{var _=function(){f(),c.removeEventListener(e._canPlayEvent,_,!1)};c.addEventListener(e._canPlayEvent,_,!1),n._clearTimer(a._id)}}return a._id},pause:function(t){var e=this;if("loaded"!==e._state)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var i=e._getSoundIds(t),n=0;n<i.length;n++){e._clearTimer(i[n]);var o=e._soundById(i[n]);if(o&&!o._paused&&(o._seek=e.seek(i[n]),o._rateSeek=0,o._paused=!0,e._stopFade(i[n]),o._node))if(e._webAudio){if(!o._node.bufferSource)return e;"undefined"==typeof o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),e._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||e._emit("pause",o?o._id:null)}return e},stop:function(t,e){var i=this;if("loaded"!==i._state)return i._queue.push({event:"stop",action:function(){i.stop(t)}}),i;for(var n=i._getSoundIds(t),o=0;o<n.length;o++){i._clearTimer(n[o]);var r=i._soundById(n[o]);if(r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,i._stopFade(n[o]),r._node))if(i._webAudio){if(!r._node.bufferSource)return e||i._emit("stop",r._id),i;"undefined"==typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),i._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause());r&&!e&&i._emit("stop",r._id)}return i},mute:function(t,i){var n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action:function(){n.mute(t,i)}}),n;if("undefined"==typeof i){if("boolean"!=typeof t)return n._muted;n._muted=t}for(var o=n._getSoundIds(i),r=0;r<o.length;r++){var s=n._soundById(o[r]);s&&(s._muted=t,n._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,e.ctx.currentTime):s._node&&(s._node.muted=!!e._muted||t),n._emit("mute",s._id))}return n},volume:function(){var t,i,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&"undefined"==typeof o[1]){var r=n._getSoundIds(),s=r.indexOf(o[0]);s>=0?i=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),i=parseInt(o[1],10));var a;if(!("undefined"!=typeof t&&t>=0&&t<=1))return a=i?n._soundById(i):n._sounds[0],a?a._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;"undefined"==typeof i&&(n._volume=t),i=n._getSoundIds(i);for(var l=0;l<i.length;l++)a=n._soundById(i[l]),a&&(a._volume=t,o[2]||n._stopFade(i[l]),n._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(t,e.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=t*e.volume()),n._emit("volume",a._id));return n},fade:function(t,i,n,o){var r=this,s=Math.abs(t-i),a=t>i?"out":"in",l=s/.01,u=l>0?n/l:n;if(u<4&&(l=Math.ceil(l/(4/u)),u=4),"loaded"!==r._state)return r._queue.push({event:"fade",action:function(){r.fade(t,i,n,o)}}),r;r.volume(t,o);for(var h=r._getSoundIds(o),c=0;c<h.length;c++){var p=r._soundById(h[c]);if(p){if(o||r._stopFade(h[c]),r._webAudio&&!p._muted){var d=e.ctx.currentTime,f=d+n/1e3;p._volume=t,p._node.gain.setValueAtTime(t,d),p._node.gain.linearRampToValueAtTime(i,f)}var m=t;p._interval=setInterval(function(t,e){l>0&&(m+="in"===a?.01:-.01),m=Math.max(0,m),m=Math.min(1,m),m=Math.round(100*m)/100,r._webAudio?("undefined"==typeof o&&(r._volume=m),e._volume=m):r.volume(m,t,!0),m===i&&(clearInterval(e._interval),e._interval=null,r.volume(m,t),r._emit("fade",t))}.bind(r,h[c],p),u)}}return r},_stopFade:function(t){var i=this,n=i._soundById(t);return n&&n._interval&&(i._webAudio&&n._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(n._interval),n._interval=null,i._emit("fade",t)),i},loop:function(){var t,e,i,n=this,o=arguments;if(0===o.length)return n._loop;if(1===o.length){if("boolean"!=typeof o[0])return i=n._soundById(parseInt(o[0],10)),!!i&&i._loop;t=o[0],n._loop=t}else 2===o.length&&(t=o[0],e=parseInt(o[1],10));for(var r=n._getSoundIds(e),s=0;s<r.length;s++)i=n._soundById(r[s]),i&&(i._loop=t,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=t,t&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var t,i,n=this,o=arguments;if(0===o.length)i=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),s=r.indexOf(o[0]);s>=0?i=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),i=parseInt(o[1],10));var a;if("number"!=typeof t)return a=n._soundById(i),a?a._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;"undefined"==typeof i&&(n._rate=t),i=n._getSoundIds(i);for(var l=0;l<i.length;l++)if(a=n._soundById(i[l])){a._rateSeek=n.seek(i[l]),a._playStart=n._webAudio?e.ctx.currentTime:a._playStart,a._rate=t,n._webAudio&&a._node&&a._node.bufferSource?a._node.bufferSource.playbackRate.value=t:a._node&&(a._node.playbackRate=t);var u=n.seek(i[l]),h=(n._sprite[a._sprite][0]+n._sprite[a._sprite][1])/1e3-u,c=1e3*h/Math.abs(a._rate);!n._endTimers[i[l]]&&a._paused||(n._clearTimer(i[l]),n._endTimers[i[l]]=setTimeout(n._ended.bind(n,a),c)),n._emit("rate",a._id)}return n},seek:function(){var t,i,n=this,o=arguments;if(0===o.length)i=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),s=r.indexOf(o[0]);s>=0?i=parseInt(o[0],10):(i=n._sounds[0]._id,t=parseFloat(o[0]))}else 2===o.length&&(t=parseFloat(o[0]),i=parseInt(o[1],10));if("undefined"==typeof i)return n;if("loaded"!==n._state)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var a=n._soundById(i);if(a){if(!("number"==typeof t&&t>=0)){if(n._webAudio){var l=n.playing(i)?e.ctx.currentTime-a._playStart:0,u=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(u+l*Math.abs(a._rate))}return a._node.currentTime}var h=n.playing(i);h&&n.pause(i,!0),a._seek=t,a._ended=!1,n._clearTimer(i),h&&n.play(i,!0),!n._webAudio&&a._node&&(a._node.currentTime=t),n._emit("seek",i)}return n},playing:function(t){var e=this;if("number"==typeof t){var i=e._soundById(t);return!!i&&!i._paused}for(var n=0;n<e._sounds.length;n++)if(!e._sounds[n]._paused)return!0;return!1},duration:function(t){var e=this,i=e._duration,n=e._soundById(t);return n&&(i=e._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var t=this,i=t._sounds,n=0;n<i.length;n++){i[n]._paused||(t.stop(i[n]._id),t._emit("end",i[n]._id)),t._webAudio||(i[n]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",i[n]._node.removeEventListener("error",i[n]._errorFn,!1),i[n]._node.removeEventListener(e._canPlayEvent,i[n]._loadFn,!1)),delete i[n]._node,t._clearTimer(i[n]._id);var r=e._howls.indexOf(t);r>=0&&e._howls.splice(r,1)}var s=!0;for(n=0;n<e._howls.length;n++)if(e._howls[n]._src===t._src){s=!1;break}return o&&s&&delete o[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,i,n){var o=this,r=o["_on"+t];return"function"==typeof e&&r.push(n?{id:i,fn:e,once:n}:{id:i,fn:e}),o},off:function(t,e,i){var n=this,o=n["_on"+t],r=0;if(e){for(r=0;r<o.length;r++)if(e===o[r].fn&&i===o[r].id){o.splice(r,1);break}}else if(t)n["_on"+t]=[];else{var s=Object.keys(n);for(r=0;r<s.length;r++)0===s[r].indexOf("_on")&&Array.isArray(n[s[r]])&&(n[s[r]]=[])}return n},once:function(t,e,i){var n=this;return n.on(t,e,i,1),n},_emit:function(t,e,i){for(var n=this,o=n["_on"+t],r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,i)}.bind(n,o[r].fn),0),o[r].once&&n.off(t,o[r].fn,o[r].id));return n},_loadQueue:function(){var t=this;if(t._queue.length>0){var e=t._queue[0];t.once(e.event,function(){t._queue.shift(),t._loadQueue()}),e.action()}return t},_ended:function(t){var i=this,n=t._sprite,o=!(!t._loop&&!i._sprite[n][2]);if(i._emit("end",t._id),!i._webAudio&&o&&i.stop(t._id,!0).play(t._id),i._webAudio&&o){i._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);i._endTimers[t._id]=setTimeout(i._ended.bind(i,t),r)}return i._webAudio&&!o&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,i._clearTimer(t._id),i._cleanBuffer(t._node),e._autoSuspend()),i._webAudio||o||i.stop(t._id),i},_clearTimer:function(t){var e=this;return e._endTimers[t]&&(clearTimeout(e._endTimers[t]),delete e._endTimers[t]),e},_soundById:function(t){for(var e=this,i=0;i<e._sounds.length;i++)if(t===e._sounds[i]._id)return e._sounds[i];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new n(t)},_drain:function(){var t=this,e=t._pool,i=0,n=0;if(!(t._sounds.length<e)){for(n=0;n<t._sounds.length;n++)t._sounds[n]._ended&&i++;for(n=t._sounds.length-1;n>=0;n--){if(i<=e)return;t._sounds[n]._ended&&(t._webAudio&&t._sounds[n]._node&&t._sounds[n]._node.disconnect(0),t._sounds.splice(n,1),i--)}}},_getSoundIds:function(t){var e=this;if("undefined"==typeof t){for(var i=[],n=0;n<e._sounds.length;n++)i.push(e._sounds[n]._id);return i}return[t]},_refreshBuffer:function(t){var i=this;return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=o[i._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop),t._node.bufferSource.playbackRate.value=t._rate,i},_cleanBuffer:function(t){var e=this;if(e._scratchBuffer){t.bufferSource.onended=null,t.bufferSource.disconnect(0);try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}}return t.bufferSource=null,e}};var n=function(t){this._parent=t,this.init()};n.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._muted=e._muted,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=Math.round(Date.now()*Math.random()),e._sounds.push(t),t.create(),t},create:function(){var t=this,i=t._parent,n=e._muted||t._muted||t._parent._muted?0:t._volume;return i._webAudio?(t._node="undefined"==typeof e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(n,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):(t._node=new Audio,t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._node.src=i._src,t._node.preload="auto",t._node.volume=n*e.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._muted=e._muted,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=Math.round(Date.now()*Math.random()),t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorListener,!1)},_loadListener:function(){var t=this,i=t._parent;i._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)}};var o={},r=function(t){var e=t._src;if(o[e])return t._duration=o[e].duration,void l(t);if(/^data:[^;]+;base64,/.test(e)){for(var i=atob(e.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);a(n.buffer,t)}else{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=function(){var e=(u.status+"")[0];return"0"!==e&&"2"!==e&&"3"!==e?void t._emit("loaderror",null,"Failed loading audio file with status: "+u.status+"."):void a(u.response,t)},u.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete o[e],t.load())},s(u)}},s=function(t){try{t.send()}catch(e){t.onerror()}},a=function(t,i){e.ctx.decodeAudioData(t,function(t){t&&i._sounds.length>0&&(o[i._src]=t,l(i,t))},function(){i._emit("loaderror",null,"Decoding audio data failed.")})},l=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},u=function(){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),i=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=i?parseInt(i[1],10):null;if(t&&n&&n<9){var o=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());(e._navigator&&e._navigator.standalone&&!o||e._navigator&&!e._navigator.standalone&&!o)&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain="undefined"==typeof e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.value=1,e.masterGain.connect(e.ctx.destination)),e._setup()};"function"==typeof define&&define.amd&&define([],function(){return{Howler:e,Howl:i}}),"undefined"!=typeof exports&&(exports.Howler=e,exports.Howl=i),"undefined"!=typeof window?(window.HowlerGlobal=t,window.Howler=e,window.Howl=i,window.Sound=n):"undefined"!=typeof global&&(global.HowlerGlobal=t,global.Howler=e,global.Howl=i,global.Sound=n)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var i=e._howls.length-1;i>=0;i--)e._howls[i].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,i){var n=this;return n.ctx&&n.ctx.listener?(e="number"!=typeof e?n._pos[1]:e,i="number"!=typeof i?n._pos[2]:i,"number"!=typeof t?n._pos:(n._pos=[t,e,i],n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(t,e,i,n,o,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return e="number"!=typeof e?a[1]:e,i="number"!=typeof i?a[2]:i,n="number"!=typeof n?a[3]:n,o="number"!=typeof o?a[4]:o,r="number"!=typeof r?a[5]:r,"number"!=typeof t?a:(s._orientation=[t,e,i,n,o,r],s.ctx.listener.setOrientation(t,e,i,n,o,r),s)},Howl.prototype.init=function(t){return function(e){var i=this;return i._orientation=e.orientation||[1,0,0],i._stereo=e.stereo||null,i._pos=e.pos||null,i._pannerAttr={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:0,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:"inverse",maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:1e4,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:"HRTF",refDistance:"undefined"!=typeof e.refDistance?e.refDistance:1,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:1},i._onstereo=e.onstereo?[{fn:e.onstereo}]:[],i._onpos=e.onpos?[{fn:e.onpos}]:[],i._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var o="undefined"==typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"==typeof i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var r=n._getSoundIds(i),s=0;s<r.length;s++){var a=n._soundById(r[s]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,o),"spatial"===o?a._panner.setPosition(e,0,0):a._panner.pan.value=e),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,i,n,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(e,i,n,o)}}),r;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,"undefined"==typeof o){if("number"!=typeof e)return r._pos;r._pos=[e,i,n]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,i,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),l._panner.setPosition(e,i,n)),r._emit("pos",l._id)}}return r},Howl.prototype.orientation=function(e,i,n,o){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(e,i,n,o)}}),r;if(i="number"!=typeof i?r._orientation[1]:i,n="number"!=typeof n?r._orientation[2]:n,"undefined"==typeof o){if("number"!=typeof e)return r._orientation;r._orientation=[e,i,n]}for(var s=r._getSoundIds(o),a=0;a<s.length;a++){var l=r._soundById(s[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,i,n],l._node&&(l._panner||(l._pos||(l._pos=r._pos||[0,0,-.5]),t(l,"spatial")),l._panner.setOrientation(e,i,n)),r._emit("orientation",l._id)}}return r},Howl.prototype.pannerAttr=function(){var e,i,n,o=this,r=arguments;if(!o._webAudio)return o;if(0===r.length)return o._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return n=o._soundById(parseInt(r[0],10)),n?n._pannerAttr:o._pannerAttr;e=r[0],"undefined"==typeof i&&(o._pannerAttr={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:o._coneOuterAngle,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:o._coneOuterGain,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:o._distanceModel,maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:o._maxDistance,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:o._panningModel,refDistance:"undefined"!=typeof e.refDistance?e.refDistance:o._refDistance,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:o._rolloffFactor})}else 2===r.length&&(e=r[0],i=parseInt(r[1],10));for(var s=o._getSoundIds(i),a=0;a<s.length;a++)if(n=o._soundById(s[a])){var l=n._pannerAttr;l={coneInnerAngle:"undefined"!=typeof e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:"undefined"!=typeof e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:"undefined"!=typeof e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:"undefined"!=typeof e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:"undefined"!=typeof e.maxDistance?e.maxDistance:l.maxDistance,panningModel:"undefined"!=typeof e.panningModel?e.panningModel:l.panningModel,refDistance:"undefined"!=typeof e.refDistance?e.refDistance:l.refDistance,rolloffFactor:"undefined"!=typeof e.rolloffFactor?e.rolloffFactor:l.rolloffFactor};var u=n._panner;u?(u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.panningModel=l.panningModel,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor):(n._pos||(n._pos=o._pos||[0,0,-.5]),t(n,"spatial"))}return o},Sound.prototype.init=function(t){return function(){var e=this,i=e._parent;e._orientation=i._orientation,e._stereo=i._stereo,e._pos=i._pos,e._pannerAttr=i._pannerAttr,t.call(this),e._stereo?i.stereo(e._stereo):e._pos&&i.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,i=e._parent;return e._orientation=i._orientation,e._pos=i._pos,e._pannerAttr=i._pannerAttr,t.call(this)}}(Sound.prototype.reset);var t=function(t,e){e=e||"spatial","spatial"===e?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.panningModel=t._pannerAttr.panningModel,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.value=t._stereo),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id)}}();var Stats=function(){function t(t,e,i){return t=document.createElement(t),t.id=e,t.style.cssText=i,t}function e(e,i,n){var o=t("div",e,"padding:0 0 3px 3px;text-align:left;background:"+n),r=t("div",e+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+i);for(r.innerHTML=e.toUpperCase(),o.appendChild(r),e=t("div",e+"Graph","width:74px;height:30px;background:"+i),o.appendChild(e),i=0;74>i;i++)e.appendChild(t("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+n));return o}function i(t){for(var e=u.children,i=0;i<e.length;i++)e[i].style.display=i===t?"block":"none";l=t}function n(t,e){t.appendChild(t.firstChild).style.height=Math.min(30,30-30*e)+"px"}var o=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,r=o(),s=r,a=0,l=0,u=t("div","stats","width:80px;opacity:0.9;cursor:pointer");u.addEventListener("mousedown",function(t){t.preventDefault(),i(++l%u.children.length)},!1);var h=0,c=1/0,p=0,d=e("fps","#0ff","#002"),f=d.children[0],m=d.children[1];u.appendChild(d);var _=0,y=1/0,x=0,d=e("ms","#0f0","#020"),v=d.children[0],g=d.children[1];if(u.appendChild(d),self.performance&&self.performance.memory){var b=0,w=1/0,S=0,d=e("mb","#f08","#201"),C=d.children[0],D=d.children[1];u.appendChild(d)}return i(l),{REVISION:14,domElement:u,setMode:i,begin:function(){r=o()},end:function(){var t=o();if(_=t-r,y=Math.min(y,_),x=Math.max(x,_),v.textContent=(0|_)+" MS ("+(0|y)+"-"+(0|x)+")",n(g,_/200),a++,t>s+1e3&&(h=Math.round(1e3*a/(t-s)),c=Math.min(c,h),p=Math.max(p,h),f.textContent=h+" FPS ("+c+"-"+p+")",n(m,h/100),s=t,a=0,void 0!==b)){var e=performance.memory.usedJSHeapSize,i=performance.memory.jsHeapSizeLimit;b=Math.round(9.54e-7*e),w=Math.min(w,b),S=Math.max(S,b),C.textContent=b+" MB ("+w+"-"+S+")",n(D,e/i)}return t},update:function(){r=this.end()}}};"object"==typeof module&&(module.exports=Stats),"undefined"!=typeof window&&(window.Stats=Stats||{});var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Lightning;!function(t){var e=function(){function t(){}return t.rngInt=function(t,e){return Math.floor(Math.random()*(e-t)+t)},t.rng=function(t){return void 0===t&&(t=!1),t?Math.random():-Math.random()},t.rngFloat=function(t,e){return Math.random()*(e-t)+t},t.rndPos=function(){return{x:0,y:0}},t.distanceBetween=function(){return{
x:0,y:0}},t.hextoRGB=function(){return{x:0,y:0}},t.rgbToHex=function(){return{x:0,y:0}},t}();t.Maths=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(){}return t}();t.Depreciated=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function e(){}return e.prototype.generateTexture=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=[];if(t.length>1)for(var n=0,o=t;n<o.length;n++){var r=o[n];i.push(this._renderer.generateTexture(r))}else i=this._renderer.generateTexture(t[0]);return i},e.prototype.goFullscreen=function(){document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen&&document.documentElement.msRequestFullscreen()},e.prototype.texture=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=[];if(e.length>1)for(var o=0,r=e;o<r.length;o++){var s=r[o];n.push(t.Texture.from(s))}else n=t.Texture.from(e[0]);return n},Object.defineProperty(e.prototype,"backgroundColor",{set:function(t){this._renderer.backgroundColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"world",{get:function(){return this._world},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._renderer.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._renderer.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return{x:.5*this.width,y:.5*this.height}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){return this._renderer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tweens",{get:function(){return this._tweens},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"signals",{get:function(){return this._signals},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"states",{get:function(){return this._stateManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fps",{get:function(){return this._ticker.FPS},set:function(t){this._ticker.FPS=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return this._ticker.minFPS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elapsedTime",{get:function(){return this._ticker.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deltaTime",{get:function(){return this._ticker.deltaTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastTime",{get:function(){return this._ticker.lastTime},enumerable:!0,configurable:!0}),e}();t.EngineHelper=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i.loader=new PIXI.loaders.Loader,i.loader.onError.add(i.preloadError,i),i.loader.onLoad.add(i.preloadSingle,i),i.loader.onComplete.add(i.preloadComplete,i),i}return __extends(e,t),e.prototype.init=function(t){this.preload()},e.prototype.preload=function(){Object.keys(this.loader.resources).length<1&&this.create()},e.prototype.create=function(){},e.prototype.update=function(t){void 0===t&&(t=null)},e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++){var o=n[i];this.addChild(o)}return!0},e.prototype.preloadError=function(t){console.log(t)},e.prototype.preloadSingle=function(t,e){var i=e.name;i=i.replace(/^.*[\\\/]/,"");e.progressChunk},e.prototype.preloadComplete=function(t){this.create()},e}(PIXI.Container);t.State=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(t){this.game=t,this._states=[],this._activeStates=[]}return t.prototype.update=function(t){for(var e=0,i=this._activeStates;e<i.length;e++){var n=i[e];n.update(t)}},t.prototype.init=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.init(e),this.addToActive(t),!0},t.prototype.start=function(t,e){void 0===e&&(e=!0);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=this.findState(t);this.game.world.addChild(o.state),o.worldIndex=this.game.world.getChildIndex(o.state),e&&this.init(o.state,i)},t.prototype.pause=function(t){var e=this.findState(t).state;return this._activeStates.splice(this.findActiveIndex(e)),!0},t.prototype.unpause=function(t){var e=this.findState(t).state;return this.addToActive(e),!0},t.prototype.reset=function(){},t.prototype.disable=function(t){var e=this.findState(t),i=e.state;return e.worldIndex=this.game.world.getChildIndex(e.state),i.interactive=!1,i.interactiveChildren=!1,i.visible=!1,i.renderable=!1,this.game.world.removeChild(i),this._activeStates.splice(this.findActiveIndex(i)),!0},t.prototype.enable=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=null);var n=this.findState(t),o=n.state;return o.visible=!0,o.renderable=!0,o.interactive=!0,o.interactiveChildren=!0,e===!0?this.game.world.addChildAt(o,n.worldIndex):null!==i?this.game.world.addChildAt(o,i):this.game.world.addChild(o),!0},t.prototype.destroy=function(t){var e=this.findState(t).state;return e.visible=!1,e.renderable=!1,e.interactive=!1,e.interactiveChildren=!1,this.game.world.removeChild(e),this._activeStates.splice(this.findActiveIndex(e)),e=null,!0},t.prototype.add=function(t,e){var i={};return i.key=t,i.state=e,i.active=!1,i.worldIndex=null,i.fps=60,this._states.push(i),!0},t.prototype.addToActive=function(t){for(var e=!1,i=0,n=this._activeStates;i<n.length;i++){var o=n[i];o===t&&(e=!0)}return!e&&(this._activeStates.push(t),!0)},t.prototype.freeze=function(){},t.prototype.findState=function(t){for(var e=0,i=this._states;e<i.length;e++){var n=i[e];if(n.key===t)return n}return null},t.prototype.findActiveIndex=function(t){for(var e=0,i=0,n=this._activeStates;i<n.length;i++){var o=n[i];if(o===t)return e;e++}return null},t}();t.StateManager=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(t){this.game=t,this._active=!1}return t.prototype.update=function(){this._active},t.prototype.startPhysics=function(){this._physicsWorld=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(0,10),!0)},t.prototype.collideOnWorldBounds=function(){this._physicsWorldBounds=new Box2D.Dynamics.b2BodyDef;var t=new Box2D.Dynamics.b2FixtureDef;t.shape=new Box2D.Collision.Shapes.b2PolygonShape,t.density=1,this._physicsWorldBounds=new Box2D.Dynamics.b2BodyDef,this._physicsWorldBounds.type=Box2D.Dynamics.b2Body.b2_staticBody,t.shape.SetAsBox(10,1),this._physicsWorldBounds.position.Set(9,this.game.height/100+1),this.physics.CreateBody(this._physicsWorldBounds).CreateFixture(t),t.shape.SetAsBox(1,100),this._physicsWorldBounds.position.Set(-1,0),this.physics.CreateBody(this._physicsWorldBounds).CreateFixture(t),this._physicsWorldBounds.position.Set(this.game.height/100,0),this.physics.CreateBody(this._physicsWorldBounds).CreateFixture(t),this._physicsWorldBounds.type=Box2D.Dynamics.b2Body.b2_dynamicBody;Box2D.Dynamics.b2Body},Object.defineProperty(t.prototype,"physics",{get:function(){return this._physicsWorld},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"physicsWorldBounds",{get:function(){return this._physicsWorldBounds},enumerable:!0,configurable:!0}),t}();t.PhysicsManager=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(t){this.game=t,this.window=window.parent||window}return t.prototype.onKeyDown=function(t){console.log(t)},t.prototype.addKey=function(t,e){var i={};i.code=t,i.isDown=!1,i.isUp=!0,i.press=void 0,i.release=void 0,i.downHandler=function(t){t.keyCode===i.code&&(i.isUp&&i.press&&i.press(),i.isDown=!0,i.isUp=!1),t.preventDefault()},i.upHandler=function(t){t.keyCode===i.code&&(i.isDown&&i.release&&i.release(),i.isDown=!1,i.isUp=!0),t.preventDefault()}},t}();t.Input=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(PIXI.DisplayObject);t.DisplayObject=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(PIXI.Texture);t.Texture=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length-1;i++)this.addChild(t[i])},e}(PIXI.Graphics);t.Graphics=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e){return void 0===e&&(e=null),t.call(this,e)||this}return __extends(e,t),e.prototype.enableBody=function(t){},e.prototype.setAnchor=function(t,e){void 0===e&&(e=t),this.anchor=new PIXI.Point(t,e)},e.prototype.setScale=function(t,e){void 0===e&&(e=t),this.scale=new PIXI.Point(t,e)},Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(t){this._body=t},enumerable:!0,configurable:!0}),e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length-1;i++)this.addChild(t[i])},e.prototype.enableDrag=function(t){var e=this;void 0===t&&(t=!1),this._respectPosition=t,this.interactive===!1&&(this.interactive=!0),this.on("mousedown",function(t){e.startDrag(t)}),this.on("touchstart",function(t){e.startDrag(t)}),this.on("mouseup",function(t){e.stopDrag(t)}),this.on("touchend",function(t){e.stopDrag(t)})},e.prototype.startDrag=function(t){if(this._respectPosition){var e=t.data.global.x*window.devicePixelRatio-this.position.x,i=t.data.global.y*window.devicePixelRatio-this.position.y;this._respectPositionValues={x:e,y:i}}else this._respectPositionValues={x:0,y:0};this.on("mousemove",this.onDrag),this.on("touchmove",this.onDrag)},e.prototype.stopDrag=function(t){this.removeListener("mousemove",this.onDrag),this.removeListener("touchmove",this.onDrag)},e.prototype.onDrag=function(t){this.position=new PIXI.Point(t.data.global.x*window.devicePixelRatio-this._respectPositionValues.x,t.data.global.y*window.devicePixelRatio-this._respectPositionValues.y)},e}(PIXI.Sprite);t.Sprite=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length-1;i++)this.addChild(t[i])},e}(PIXI.Container);t.Group=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.game=e,i}return __extends(e,t),e}(t.Group);t.HUD=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.calcFont=function(t,e,i){var n=(t.width/e).toString()+"px "+i;return n},e}(PIXI.extras.BitmapText);t.BitmapText=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e;!function(t){function e(t){var e=new PIXI.Graphics;return e.beginFill(16777215,1),e.drawRect(0,0,t,t),e.endFill(),e}function i(t,e){var i=new PIXI.Graphics;return i.beginFill(16777215,1),i.drawRect(0,0,t,e),i.endFill(),i}function n(t,e){var i=new PIXI.Graphics;return i.beginFill(16777215,1),i.drawRect(0,0,t,e),i.endFill(),i}function o(t,e,i){t*=2,e*=2,i*=2;var n=new PIXI.Graphics;n.beginFill(16777215,1),n.drawRect(0,0,t,e),n.endFill();var o=new PIXI.Graphics;o.beginFill(13816530,1),o.moveTo(0,0),o.lineTo(i,-i),o.lineTo(t+i,-i),o.lineTo(t,0),o.lineTo(0,0),o.endFill(),n.addChild(o);var r=new PIXI.Graphics;return r.beginFill(11250603,1),r.moveTo(t,0),r.lineTo(t+i,-i),r.lineTo(t+i,e-i),r.lineTo(t,e),r.lineTo(t,0),r.endFill(),n.addChild(r),n}function r(t){var e=new PIXI.Graphics;return e.beginFill(16777215,1),e.arc(75,75,t,0,2*Math.PI,!1),e.endFill(),e}function s(t,e){void 0===e&&(e=t);var i=new PIXI.Graphics;return i.beginFill(16777215,1),i.moveTo(.5*t,0),i.lineTo(e,t),i.lineTo(0,t),i.lineTo(.5*t,0),i.endFill(),i}t.Square=e,t.Rect=i,t.Star=n,t.Rect3D=o,t.Circle=r,t.Triangle=s}(e=t.Geometry||(t.Geometry={}))}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e,i,n){var o=t.call(this)||this;return o.game=e,o.interactive=!0,o.alpha=0,o.beginFill(16777215,1),o.drawRect(0,0,i,n),o.endFill(),o}return __extends(e,t),e.prototype.setRect=function(t,e){},e.prototype.setCircle=function(t){},e.prototype.onClick=function(t){this.on("click",t)},e.prototype.down=function(t){this.on("mousedown",t),this.on("touchend",t),void 0!==this.pointertap&&this.on("pointertap",t),void 0!==this.pointerdown&&this.on("pointerdown",t)},e.prototype.up=function(t){this.on("mouseup",t),this.on("touchend",t),void 0!==this.pointerup&&this.on("pointerup",t)},e.prototype.upOutside=function(t){this.on("mouseupoutside",t),this.on("touchendoutside",t),void 0!==this.pointerupoutside&&this.on("pointerupoutside",t)},e.prototype.over=function(t){this.on("mouseover",t),void 0!==this.pointerover&&this.on("pointerover",t)},e.prototype.out=function(t){this.on("mouseout",t),void 0!==this.pointerout&&this.on("pointerout",t)},e.prototype.move=function(t){this.on("mousemove",t),void 0!==this.pointermove&&this.on("pointermove",t)},e.prototype.rightClick=function(t){this.on("rightclick",t)},e.prototype.rightDown=function(t){this.on("rightdown",t)},e.prototype.rightUp=function(t){this.on("rightup",t)},e.prototype.rightUpOutside=function(t){this.on("rightupoutside",t)},e.prototype.onTap=function(t){this.on("tap",t)},e}(t.Graphics);t.HitArea=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=null);var n=e.call(this,i)||this;return n._primitive=null,n.game=t,n.initalise(),n}return __extends(i,e),i.prototype.initalise=function(){this.interactive=!0,this._hitArea=new t.HitArea(this.game,this.texture.width,this.texture.height),this.addChild(this._hitArea)},i.prototype.setAnchor=function(t,e){void 0===e&&(e=t),this.anchor=new PIXI.Point(t,e),this._hitArea.x-=this.width*t,this._hitArea.y-=this.height*e},Object.defineProperty(i.prototype,"hit",{get:function(){return this._hitArea},enumerable:!0,configurable:!0}),i}(t.Sprite);t.Button=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e)||this;return n._velX=0,n._velY=0,n._gX=0,n._gY=0,n._alphaIncrement=null,n._rotationIncrement=null,n._scaleIncrement=null,n._createdAt=null,n._lifeSpan=null,n._deadTime=null,n._emitter=i,n.setAnchor(.5),n}return __extends(e,t),e.prototype.update=function(){this._deadTime<=Date.now()&&(this._emitter.returnToPool(this),this.alpha=1,this.scale=new PIXI.Point(1,1),this.rotation=0,this._deadTime=null,this._createdAt=null,this._lifeSpan=null),this._velX+=this._gX,this._velY+=this._gY,this.x+=this._velX,this.y+=this._velY,this._alphaIncrement&&(this.alpha+=this._alphaIncrement),this._rotationIncrement&&(this.rotation+=this._rotationIncrement),this._scaleIncrement&&this.setScale(this.scale.x+this._scaleIncrement.x,this.scale.y+this._scaleIncrement.y)},Object.defineProperty(e.prototype,"velocity",{set:function(t){this._velX=t.x,this._velY=t.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gravity",{set:function(t){this._gX=t.x,this._gY=t.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lifeSpan",{set:function(t){this._lifeSpan=t,this._deadTime=this._lifeSpan+Date.now()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alphaIncrement",{set:function(t){this._alphaIncrement=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotationIncrement",{set:function(t){this._rotationIncrement=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleIncrement",{set:function(t){this._scaleIncrement={x:t.x,y:t.y}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{set:function(t){this._createdAt=t},enumerable:!0,configurable:!0}),e}(t.Sprite);t.Particle=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(e){function i(t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=e.call(this)||this;return o._emit=!1,o._nextEmit=null,o._interval=100,o._lastStart=null,o._time=null,o._textures=[],o._deadPool=[],o._gravity={x:0,y:.2},o._spread={xFrom:-2,xTo:2,yFrom:-2,yTo:2},o._lifeSpanRange={from:3e3,to:3e3},o._particleStrength=1,o._particleScaleRange={xFrom:.7,xTo:1,yFrom:.7,yTo:1},o._particleAlphaRange={from:1,to:1},o._particleRotationRange={from:0,to:1.9},o._particleVelocityRange={xFrom:-1,xTo:1,yFrom:-4,yTo:-6},o._particleRotationIncrement={from:0,to:0},o._particleScaleIncrement={xFrom:0,xTo:0,yFrom:0,yTo:0},o._particleAlphaIncrement={from:0,to:0},o.state=t,o.x=i,o.y=n,o}return __extends(i,e),i.prototype.update=function(){for(var t=0,e=this.children;t<e.length;t++){var i=e[t];i.update()}return null!==this._time&&Date.now()>this._lastStart+this._time?void this.stop():void(this._emit&&this._nextEmit<Date.now()&&(this._nextEmit=Date.now()+this._interval,this.fireEmitter()))},i.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t;i<n.length;i++){var o=n[i];this._textures.push(o)}},i.prototype.start=function(t){void 0===t&&(t=null),0===t?this.fireEmitter():(this._emit=!0,this._time=t,this._lastStart=Date.now())},i.prototype.fireEmitter=function(){if(1===this._particleStrength)this.createParticle();else for(var t=0;t<this._particleStrength;t++)this.createParticle()},i.prototype.createParticle=function(){var e=this._textures[Math.floor(Math.random()*this._textures.length)],i=null;i=this._deadPool.length>0?this._deadPool.splice(0,1)[0]:new t.Particle(e,this),i.gravity=this._gravity;var n=t.Maths.rngInt(this._spread.xFrom,this._spread.xTo),o=t.Maths.rngInt(this._spread.yFrom,this._spread.yTo);i.x=n,i.y=o;var r=t.Maths.rngFloat(this._particleVelocityRange.xFrom,this._particleVelocityRange.xTo),s=t.Maths.rngFloat(this._particleVelocityRange.yFrom,this._particleVelocityRange.yTo);i.velocity={x:r,y:s};var a=t.Maths.rngInt(this._lifeSpanRange.to,this._lifeSpanRange.from);if(i.lifeSpan=a,this._particleAlphaRange){var l=t.Maths.rngFloat(this._particleAlphaRange.from,this._particleAlphaRange.to);i.alpha=l}if(this._particleScaleRange){var u=t.Maths.rngFloat(this._particleScaleRange.xFrom,this._particleScaleRange.xTo);i.setScale(u,u)}if(this._particleRotationRange){var h=t.Maths.rngFloat(this._particleRotationRange.from,this._particleRotationRange.to);i.rotation=h}if(this._particleRotationIncrement){var c=t.Maths.rngFloat(this._particleRotationIncrement.from,this._particleRotationIncrement.to);i.rotationIncrement=c}if(this._particleAlphaIncrement){var p=t.Maths.rngFloat(this._particleAlphaIncrement.from,this._particleAlphaIncrement.to);i.alphaIncrement=p}if(this._particleScaleIncrement){var d=t.Maths.rngFloat(this._particleScaleIncrement.xFrom,this._particleScaleIncrement.xTo);i.scaleIncrement={x:d,y:d}}i.createdAt=Date.now(),this.addChild(i)},i.prototype.stop=function(){this._emit=!1},i.prototype.returnToPool=function(t){var e=this.removeChild(t);this._deadPool.push(e)},i.prototype.startDrag=function(t){if(this._respectPosition){var e=t.data.global.x*window.devicePixelRatio-this.position.x,i=t.data.global.y*window.devicePixelRatio-this.position.y;this._respectPositionValues={x:e,y:i}}else this._respectPositionValues={x:0,y:0};this.on("mousemove",this.onDrag),this.on("touchmove",this.onDrag)},i.prototype.enableDrag=function(t){var e=this;void 0===t&&(t=!1),this._respectPosition=t,this.interactive===!1&&(this.interactive=!0),this.on("mousedown",function(t){e.startDrag(t)}),this.on("touchstart",function(t){e.startDrag(t)}),this.on("mouseup",function(t){e.stopDrag(t)}),this.on("touchend",function(t){e.stopDrag(t)})},i.prototype.stopDrag=function(t){this.removeListener("mousemove",this.onDrag),this.removeListener("touchmove",this.onDrag)},i.prototype.onDrag=function(t){this.position=new PIXI.Point(t.data.global.x*window.devicePixelRatio-this._respectPositionValues.x,t.data.global.y*window.devicePixelRatio-this._respectPositionValues.y)},i.prototype.setSpread=function(t,e,i,n){this._spread={xFrom:t,xTo:e,yFrom:i,yTo:n}},i.prototype.setGravity=function(t,e){void 0===e&&(e=t),this._gravity={x:t,y:e}},i.prototype.setLifeSpan=function(t,e){void 0===e&&(e=t),this._lifeSpanRange={from:t,to:e}},i.prototype.setInterval=function(t){this._interval=t},i.prototype.setVelocityRange=function(t,e,i,n){void 0===i&&(i=t),void 0===n&&(n=e),this._particleVelocityRange={xFrom:t,xTo:e,yFrom:i,yTo:n}},i.prototype.setRotationIncrement=function(t,e){void 0===e&&(e=t),this._particleRotationIncrement={from:t,to:e}},i.prototype.setScaleIncrement=function(t,e,i,n){void 0===i&&(i=t),void 0===n&&(n=e),this._particleScaleIncrement={xFrom:t,xTo:e,yFrom:i,yTo:n}},i.prototype.setAlphaIncrement=function(t,e){void 0===e&&(e=t),this._particleAlphaIncrement={from:t,to:e}},i.prototype.setScaleRange=function(t,e,i,n){void 0===i&&(i=t),void 0===n&&(n=e),this._particleScaleRange={xFrom:t,xTo:e,yFrom:i,yTo:n}},i.prototype.setAlphaRange=function(t,e){void 0===e&&(e=t),this._particleAlphaRange={from:t,to:e}},i.prototype.setRotationRange=function(t,e){void 0===e&&(e=t),this._particleRotationRange={from:t,to:e}},i.prototype.setStrength=function(t){this._particleStrength=t},Object.defineProperty(i.prototype,"alive",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pool",{get:function(){return this._deadPool.length},enumerable:!0,configurable:!0}),i}(t.Group);t.ParticleEmitter=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(t){function e(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=t.call(this)||this;return o._scrollSpeed=1,o._incMultiplier=.3,o._watch=null,o._watchX=!1,o._watchY=!1,o._watchOffset={x:0,y:0},o._lastWatch={x:0,y:0},o._watchIncMultiplier={x:.8,y:.8},o._watchDampner={x:50,y:50},o._referenceOffset={x:0,y:0},o.game=e,o._width=i|o.game.width,o._height=n|o.game.height,o._tiles=[],o}return __extends(e,t),e.prototype.add=function(t,e,i){void 0===i&&(i=!1);var n=0,o=0;i?o=this._incMultiplier*(this._tiles.length+1):n=this._incMultiplier*(this._tiles.length+1);var r=new PIXI.extras.TilingSprite(e,this._width,this._height);this.addChild(r);var s={key:t,object:r,updateX:n,updateY:o,updateRelative:0,index:this._tiles.length+1};this._tiles.push(s)},e.prototype.update=function(){var t,e=0;if(this._watchX){var i=this._watch.x-this._referenceOffset.x;t=(i-this._lastWatch.x)/this._watchDampner.x,this._lastWatch.x=i}if(this._watchY){var n=this._watch.y-this._referenceOffset.y;e=(n-this._lastWatch.y)/this._watchDampner.y,this._lastWatch.y=n}for(var o=0,r=this._tiles;o<r.length;o++){var s=r[o];s.object.tilePosition.x+=s.updateX*this._scrollSpeed,s.object.tilePosition.y+=s.updateY*this._scrollSpeed,s.object.tilePosition.x+=t*s.index*this._watchIncMultiplier.x,s.object.tilePosition.y-=e*s.index*this._watchIncMultiplier.y}},e.prototype.getTile=function(t){for(var e=0,i=this._tiles;e<i.length;e++){var n=i[e];if(n.key===t)return n}console.info("no tile with key",t,"found")},e.prototype.setWatch=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0),this._watch=t,this._watchX=e,this._watchY=i},e.prototype.setWatchOffset=function(t,e){void 0===e&&(e=t),this._watchOffset={x:t,y:e}},e.prototype.setWatchXY=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),this._watchX=t,this._watchY=e},e.prototype.setReferenceOffset=function(t,e){void 0===e&&(e=t),this._referenceOffset={x:t,y:e}},e.prototype.setWatchDampner=function(t,e){void 0===e&&(e=t),this._watchDampner.x=t,this._watchDampner.y=e},e.prototype.setUpdate=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=this.getTile(t);n.updateX=e,n.updateY=i},e.prototype.setScrollSpeed=function(t){this._scrollSpeed=t},e.prototype.setIncrementMultiplier=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!1),this._scrollSpeed=t,e)for(var n=0,o=this._tiles;n<o.length;n++){var r=o[n];if(i){var s=0,a=this._incMultiplier*(this._tiles.length+1);r.updateX=s,r.updateY=a}else{var s=this._incMultiplier*(this._tiles.length+1),a=0;r.updateX=s,r.updateY=a}}},e.prototype.setWatchIncerementMultiplier=function(t,e){void 0===e&&(e=t),this._watchIncMultiplier.x=t,this._watchIncMultiplier.y=e},Object.defineProperty(e.prototype,"scrollSpeed",{get:function(){return this._scrollSpeed},enumerable:!0,configurable:!0}),e}(t.Group);t.Parallax=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(){}return t.prototype.none=function(t,e,i,n,o){return n*e/o+i},t.prototype.easeInQuad=function(t,e,i,n){return i*(t/=n)*t+e},t.prototype.easeOutQuad=function(t,e,i,n,o){return-n*(e/=o)*(e-2)+i},t.prototype.easeInOutQuad=function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e+i:-n/2*(--e*(e-2)-1)+i},t.prototype.easeInCubic=function(t,e,i,n,o){return n*(e/=o)*e*e+i},t.prototype.easeOutCubic=function(t,e,i,n,o){return n*((e=e/o-1)*e*e+1)+i},t.prototype.easeInOutCubic=function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},t.prototype.easeInQuart=function(t,e,i,n,o){return n*(e/=o)*e*e*e+i},t.prototype.easeOutQuart=function(t,e,i,n,o){return-n*((e=e/o-1)*e*e*e-1)+i},t.prototype.easeInOutQuart=function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e*e*e+i:-n/2*((e-=2)*e*e*e-2)+i},t.prototype.easeInQuint=function(t,e,i,n,o){return n*(e/=o)*e*e*e*e+i},t.prototype.easeOutQuint=function(t,e,i,n,o){return n*((e=e/o-1)*e*e*e*e+1)+i},t.prototype.easeInOutQuint=function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e*e*e*e+i:n/2*((e-=2)*e*e*e*e+2)+i},t.prototype.easeInSine=function(t,e,i,n,o){return-n*Math.cos(e/o*(Math.PI/2))+n+i},t.prototype.easeOutSine=function(t,e,i,n,o){return n*Math.sin(e/o*(Math.PI/2))+i},t.prototype.easeInOutSine=function(t,e,i,n,o){return-n/2*(Math.cos(Math.PI*e/o)-1)+i},t.prototype.easeInExpo=function(t,e,i,n,o){return 0==e?i:n*Math.pow(2,10*(e/o-1))+i},t.prototype.easeOutExpo=function(t,e,i,n,o){return e==o?i+n:n*(-Math.pow(2,-10*e/o)+1)+i},t.prototype.easeInOutExpo=function(t,e,i,n,o){return 0==e?i:e==o?i+n:(e/=o/2)<1?n/2*Math.pow(2,10*(e-1))+i:n/2*(-Math.pow(2,-10*--e)+2)+i},t.prototype.easeInCirc=function(t,e,i,n,o){return-n*(Math.sqrt(1-(e/=o)*e)-1)+i},t.prototype.easeOutCirc=function(t,e,i,n,o){return n*Math.sqrt(1-(e=e/o-1)*e)+i},t.prototype.easeInOutCirc=function(t,e,i,n,o){return(e/=o/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+i:n/2*(Math.sqrt(1-(e-=2)*e)+1)+i},t.prototype.easeInElastic=function(t,e,i,n,o){var r=1.70158,s=0,a=n;if(0==e)return i;if(1==(e/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return-(a*Math.pow(2,10*(e-=1))*Math.sin((e*o-r)*(2*Math.PI)/s))+i},t.prototype.easeOutElastic=function(t,e,i,n,o){var r=1.70158,s=0,a=n;if(0==e)return i;if(1==(e/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*e)*Math.sin((e*o-r)*(2*Math.PI)/s)+n+i},t.prototype.easeInOutElastic=function(t,e,i,n,o){var r=1.70158,s=0,a=n;if(0==e)return i;if(2==(e/=o/2))return i+n;if(s||(s=o*(.3*1.5)),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return e<1?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*o-r)*(2*Math.PI)/s))+i:a*Math.pow(2,-10*(e-=1))*Math.sin((e*o-r)*(2*Math.PI)/s)*.5+n+i},t.prototype.easeInBack=function(t,e,i,n,o,r){return void 0==r&&(r=1.70158),n*(e/=o)*e*((r+1)*e-r)+i},t.prototype.easeOutBack=function(t,e,i,n,o,r){return void 0==r&&(r=1.70158),n*((e=e/o-1)*e*((r+1)*e+r)+1)+i},t.prototype.easeInOutBack=function(t,e,i,n,o,r){return void 0==r&&(r=1.70158),(e/=o/2)<1?n/2*(e*e*(((r*=1.525)+1)*e-r))+i:n/2*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)+i},t.prototype.easeOutBounce=function(t,e,i,n,o){return(e/=o)<1/2.75?n*(7.5625*e*e)+i:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+i:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+i:n*(7.5625*(e-=2.625/2.75)*e+.984375)+i},t}();t.Easing=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(t){this.tween=t,this._events=new Array}return t.prototype.add=function(t,e){void 0===e&&(e=null);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o={};o.funct=t,o.frame=null,o.functContext=e,o.functParams=i,o.once=!1,this._events.push(o)},t.prototype.addOnce=function(t,e){void 0===e&&(e=null);for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o={};o.funct=t,o.functContext=e,o.functParams=i,o.frame=null,o.once=!0,this._events.push(o)},t.prototype.addAtFrame=function(t,e,i){void 0===i&&(i=null);for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var r={};r.funct=t,r.functContext=i,r.functParams=n,r.frame=e,r.once=!1,this._events.push(r)},t.prototype.addOnceAtFrame=function(t,e,i){void 0===i&&(i=null);for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var r={};r.funct=t,r.functContext=i,r.functParams=n,r.frame=e,r.once=!0,this._events.push(r)},t.prototype.trigger=function(){for(var t=0;t<this._events.length;t++){var e=this._events[t];e.funct.apply(e.functContext,e.functParams),e.once&&this._events.splice(t,1)}},t.prototype.remove=function(t){var e=this.findPosition(t);e!==-1&&this._events.splice(e,1)},t.prototype.exists=function(t){for(var e=0,i=this._events;e<i.length;e++){var n=i[e];if(n.frame===t)return n}return!1},t.prototype.removeAll=function(){this._events=new Array},t.prototype.find=function(t){for(var e=0,i=this._events;e<i.length;e++){var n=i[e];if(n.name===t)return n}return!1},t.prototype.findPosition=function(t){for(var e in this._events)if(this._events[e].name===t)return parseInt(e);return-1},t}();t.Events=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function t(t,e){this._frameId=t,this._properties=new Array,this._relative=e}return t.prototype.addProperty=function(t,e){var i={prop:t,val:e};this._properties.push(i)},Object.defineProperty(t.prototype,"frameId",{get:function(){return this._frameId},set:function(t){this._frameId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},set:function(t){this._properties=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relative",{get:function(){return this._relative},set:function(t){this._relative=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"complex",{get:function(){return this._complex},set:function(t){this._complex=t},enumerable:!0,configurable:!0}),t}();t.Frame=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function e(e){this._playFlag=!1,this._maxFrames=0,this._currentFrame=0,this._autoDestroy=!1,this._isPaused=!1,this._loop=!1,this._loopsRemaining=0,this._deleteFlag=!1,this.tweenManager=e,this._frames=new Array,this._onStartCallbacks=new t.Events(this),this._onStopCallbacks=new t.Events(this),this._onLoopCallbacks=new t.Events(this),this._onPauseCallbacks=new t.Events(this),this._onTickCallbacks=new t.Events(this),this._onCompleteCallbacks=new t.Events(this),this._onDestroyCallbacks=new t.Events(this),this._onFrameCallbacks=new t.Events(this)}return e.prototype.createFrame=function(t,e,i){null==t&&(t=this._frames.length);for(var n=0;n<e.length;n++)this.insertFrameValues(t,e[n],i)},e.prototype.insertFrameValues=function(e,i,n){if(this._frames[e]){var o=this._frames[e];o.addProperty(i.prop,i.val)}else{var o=new t.Frame(e,n);o.addProperty(i.prop,i.val),this._frames.push(o)}},e.prototype.extendFrame=function(e,i,n){var o=new t.Frame(e,n);this._frames.push(o);for(var r=0,s=i;r<s.length;r++){var a=s[r];o.properties.push(a)}},e.prototype.applyUpdate=function(t){for(var e=this._frames[this._currentFrame],i=0;i<e.properties.length;i++){var n=e.properties[i].prop,o=e.properties[i].val;t[n]=o}var r=this._onFrameCallbacks.exists(this._currentFrame);r&&r.funct(),this._currentFrame++,this._currentFrame==this._frames.length&&this.end(),
this.onTickTrigger()},e.prototype.end=function(){0==this._loop?this._autoDestroy?(this.onCompleteTrigger(),this.destroy()):(this.onCompleteTrigger(),this._isPaused=!0,this.reset()):this._loopsRemaining>0?this.loop():this._autoDestroy?(this.onCompleteTrigger(),this.destroy()):(this.onCompleteTrigger(),this._isPaused=!0,this.reset())},e.prototype.onStartTrigger=function(){this._onStartCallbacks.trigger()},e.prototype.onDestroyTrigger=function(){this._onDestroyCallbacks.trigger()},e.prototype.onFrameTrigger=function(){this._onFrameCallbacks.trigger()},e.prototype.onTickTrigger=function(){this._onTickCallbacks.trigger()},e.prototype.onCompleteTrigger=function(){this._onCompleteCallbacks.trigger()},e.prototype.reset=function(){this._currentFrame=0},e.prototype.start=function(t,e,i,n){var o=this.tweenManager.startDirect(t,this,e,i,n);return o},e.prototype.loop=function(){this._onLoopCallbacks.trigger(),this._loopsRemaining--,this._currentFrame=0},e.prototype.stop=function(){this._onStopCallbacks.trigger(),this._isPaused=!0,this._currentFrame=0},e.prototype.complete=function(){this.end()},e.prototype.chain=function(t){},e.prototype.destroy=function(){this._isPaused=!0,this._deleteFlag=!0},e.prototype.pause=function(){this._onPauseCallbacks.trigger(),this._isPaused=!0},e.prototype.removeFrame=function(t,e){void 0===e&&(e=1),this._frames.splice(t,e)},Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._currentFrame>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasFinished",{get:function(){return this._currentFrame===this._maxFrames&&0===this._loopsRemaining},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._currentFrame},set:function(t){this._currentFrame=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxFrames",{get:function(){return this._frames.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoDestroy",{get:function(){return this._autoDestroy},set:function(t){this._autoDestroy=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return this._isPaused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"looping",{get:function(){return this._loop},set:function(t){this._loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loopsRemaining",{get:function(){return this._loopsRemaining},set:function(t){this._loopsRemaining=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deleteFlag",{get:function(){return this._deleteFlag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playFlag",{get:function(){return this._playFlag},set:function(t){this._playFlag=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{set:function(t){this._currentFrame=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return{onStart:this._onStartCallbacks,onStop:this._onStopCallbacks,onLoop:this._onLoopCallbacks,onComplete:this._onCompleteCallbacks,onPause:this._onPauseCallbacks,onTick:this._onTickCallbacks,onDestroy:this._onDestroyCallbacks,onFrame:this._onFrameCallbacks}},enumerable:!0,configurable:!0}),e}();t.Tween=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(){function e(e){this.game=e,this._tweens=[],this._running=[],this._easing=new t.Easing}return e.prototype.newTween=function(e){return this._tweens[e]?(console.error('Tween with the name "'+e+'" already exists'),!1):(this._tweens[e]=new t.Tween(this),this._tweens[e])},e.prototype.create=function(e,i){if(null==e){var n=new t.Tween(this);return this.calculateFrames(n,i),n}var n=this.newTween(e);return this.calculateFrames(n,i),n},e.prototype.createEmpty=function(e){if(null==e){var i=new t.Tween(this);return i}var i=this.newTween(e);return i},e.prototype.calculateFrames=function(t,e){for(var i=0,n=e;i<n.length;i++)for(var o=n[i],r=o.time/1e3*60,s=0;s<=r;s++){var a=o.easing(null,s,o.from,o.to-o.from,r);t.createFrame(s,[{prop:o.prop,val:a}],!1)}},e.prototype.addFrame=function(t,e,i){this.getTween(t)},e.prototype.extend=function(e,i,n,o){var r=null;if(r=null!==e?this.newTween(e):new t.Tween(this),r instanceof t.Tween!=0){for(var s=0,a=0;a<i.length;a++){var l=null;if(l="string"==typeof i[a]?this.getTween(i[a]):i[a],!l)return!1;for(var u=0;u<l.frames.length;u++){var h=l.frames[u];r.extendFrame(s,h.properties,h.relative)}}return r}},e.prototype.start=function(e,i,n,o,r){var s=this.getTween(i);if(s instanceof t.Tween!=0){var a=Object.create(s);n&&(a.loop=!0,a.loopsRemaining=o),a.autoDestroy=r;var l={tween:a,obj:e};return l.tween.onStartTrigger(),this._running.push(l),l}},e.prototype.startDirect=function(t,e,i,n,o){var r=Object.create(e);i&&(r.loop=!0,r.loopsRemaining=n),r.autoDestroy=o;var s={tween:r,obj:t};return s.tween.onStartTrigger(),this._running.push(s),s},e.prototype.clone=function(e){var i=this.getTween(e);if(i instanceof t.Tween!=0){var n=this.cloneObj(i);return n}},e.prototype.cloneObj=function(t){if(!t||"object"!=typeof t)return t;var e=this.cloneEmptyObject(t);return this.copyObjectProps(t,e),e},e.prototype.copyObjectProps=function(t,e){for(var i in t)if(t.hasOwnProperty(i))if(t[i]instanceof Array){e[i]=[];for(var n=0;n<t[i].length;n++)"object"==typeof t[i][n]&&null!==t[i][n]?(e[i][n]=this.cloneEmptyObject(t[i][n]),this.copyObjectProps(t[i][n],e[i][n])):e[i][n]=t[i][n]}else this.isPlainObject(t[i])?(e[i]={},this.copyObjectProps(t[i],e[i])):e[i]=t[i]},e.prototype.cloneEmptyObject=function(t){return t.constructor?new t.constructor:{}},e.prototype.isPlainObject=function(t){return!(!t||!t.constructor)&&t.constructor===Object},e.prototype.update=function(){for(var t in this._running){var e=this._running[t].tween,i=this._running[t].obj;e.isPaused?e.deleteFlag?(e.onDestroyTrigger(),this._running.splice(parseInt(t),1)):e.complete():e.applyUpdate(i)}},e.prototype.remove=function(e,i){void 0===i&&(i=!1);var n=this.getTween(e);n instanceof t.Tween!=0&&(n=null)},e.prototype.getTween=function(t){var e=!1,i=null;for(var n in this._tweens)t===n&&(e=!0,i=n);for(var n in this._running)t===n&&(e=!0,i=n);return e?this._tweens[i]:(console.error('No tween with the name "'+t+'" found!'),!1)},e.prototype.find=function(t){var e=this.getTween(t);return e||!1},Object.defineProperty(e.prototype,"easing",{get:function(){return this._easing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),e}();t.TweenManager=e}(Lightning||(Lightning={}));var Lightning;!function(t){var e;!function(t){var e=function(){function e(){this._bindings=[],this._prevParams=null,this.memorize=!1,this._shouldPropagate=!0,this.active=!0}return e.prototype.validateListener=function(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))},e.prototype._registerListener=function(e,i,n,o){var r,s=this._indexOfListener(e,n);if(s!==-1){if(r=this._bindings[s],r.isOnce()!==i)throw new Error("You cannot add"+(i?"":"Once")+"() then add"+(i?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t.SignalBinding(this,e,i,n,o),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},e.prototype._addBinding=function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t.priority<=this._bindings[e].priority);this._bindings.splice(e+1,0,t)},e.prototype._indexOfListener=function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i.getListener()===t&&i.context===e)return n;return-1},e.prototype.has=function(t,e){return void 0===e&&(e=null),this._indexOfListener(t,e)!==-1},e.prototype.add=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"add"),this._registerListener(t,!1,e,i)},e.prototype.addOnce=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=0),this.validateListener(t,"addOnce"),this._registerListener(t,!0,e,i)},e.prototype.remove=function(t,e){void 0===e&&(e=null),this.validateListener(t,"remove");var i=this._indexOfListener(t,e);return i!==-1&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},e.prototype.removeAll=function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},e.prototype.getNumListeners=function(){return this._bindings.length},e.prototype.halt=function(){this._shouldPropagate=!1},e.prototype.dispatch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.active){var i,n=this._bindings.length;if(this.memorize&&(this._prevParams=t),n){i=this._bindings.slice(0),this._shouldPropagate=!0;do n--;while(i[n]&&this._shouldPropagate&&i[n].execute(t)!==!1)}}},e.prototype.forget=function(){this._prevParams=null},e.prototype.dispose=function(){this.removeAll(),delete this._bindings,delete this._prevParams},e.prototype.toString=function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"},e}();e.VERSION="1.0.0",t.Signal=e}(e=t.Signals||(t.Signals={}))}(Lightning||(Lightning={}));var Lightning;!function(t){var e;!function(t){var e=function(){function t(t,e,i,n,o){void 0===o&&(o=0),this.active=!0,this.params=null,this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this.priority=o||0}return t.prototype.execute=function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},t.prototype.detach=function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},t.prototype.isBound=function(){return!!this._signal&&!!this._listener},t.prototype.isOnce=function(){return this._isOnce},t.prototype.getListener=function(){return this._listener},t.prototype.getSignal=function(){return this._signal},t.prototype._destroy=function(){delete this._signal,delete this._listener,delete this.context},t.prototype.toString=function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"},t}();t.SignalBinding=e}(e=t.Signals||(t.Signals={}))}(Lightning||(Lightning={}));var Lightning;!function(t){var e;!function(t){var e=function(){function e(t){this.game=t,this._signals={}}return e.prototype.create=function(e){var i=this._signals[e]=new t.Signal;return i||null},e.prototype.add=function(t,e,i){return void 0===i&&(i=null),this.signal(t).add(e,i),!0},e.prototype.addOnce=function(t,e,i){return this.signal(t).addOnce(e,i),!0},e.prototype.destroy=function(t){var e=this.signal(t);return e=null,!0},e.prototype.active=function(t,e){try{this.signal(t).active=e}catch(t){return!1}},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];try{return this.signal(t).dispatch(e),!0}catch(t){return!1}},e.prototype.signal=function(t){return this.signal(t)||null},e.prototype.has=function(t){return void 0!==this._signals[t]},e}();t.SignalManager=e}(e=t.Signals||(t.Signals={}))}(Lightning||(Lightning={}));var Lightning;!function(t){var e=function(e){function i(i,n,o){void 0===o&&(o="app");var r=e.call(this)||this;if(r._hud=null,r._tweens=new t.TweenManager(r),r._signals=new t.Signals.SignalManager(r),!o){var s=document.createElement("canvas");s.id="app",document.getElementById("app-container").appendChild(s)}r._renderer=PIXI.autoDetectRenderer(i,n,{resolution:window.devicePixelRatio}),r._renderer.autoResize=!0,r._world=new PIXI.Container,r._world.scale=new PIXI.Point(1/window.devicePixelRatio,1/window.devicePixelRatio),r._world.interactive=!0;new t.Input(r);document.getElementById("app-container").appendChild(r._renderer.view);window.devicePixelRatio;return r._renderer.resize(i,n),r._physicsManager=new t.PhysicsManager(r),r._stateManager=new t.StateManager(r),r._ticker=PIXI.ticker.shared,r._ticker.autoStart=!0,r._ticker.add(r.update,r),r}return __extends(i,e),i.prototype.update=function(t){this._physicsManager.update(),this._tweens.update(),this._stateManager.update(t),this._renderer.render(this._world)},i.prototype.start=function(){return this._ticker.start(),!0},i.prototype.stop=function(){return this._ticker.stop(),!0},i}(t.EngineHelper);t.Engine=e}(Lightning||(Lightning={}));